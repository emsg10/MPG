webpackJsonp([0],[function(e,t,i){"use strict";var r=i(1);!function(){(new r.Loader).initialize()}()},function(e,t,i){"use strict";var r=i(2),n=i(3),s=i(347),a=i(417),o=i(346),h=function(){function e(){var e=this;this.loadHelper=o.LoadHelper.getInstance(),this.asset=new s.Asset,this.assetsLoader=new r.AssetsLoader,n.Observable.forkJoin(this.assetsLoader.getShader("vertexShader.c"),this.assetsLoader.getShader("fragmentShader.c"),this.assetsLoader.getShader("simpleParticleVertexShader.c"),this.assetsLoader.getShader("simpleParticleFragmentShader.c"),this.assetsLoader.getShader("dynamicVertexShader.c"),this.assetsLoader.getShader("dynamicFragmentShader.c"),this.assetsLoader.getShader("colorVertexShader.c"),this.assetsLoader.getShader("colorFragmentShader.c"),this.assetsLoader.getTexture("tiles.png"),this.assetsLoader.getTexture("particleSprites.png"),this.assetsLoader.getTexture("genericParticle.png"),this.assetsLoader.getTileTextures("tile"),this.assetsLoader.getUiTextures("ui"),this.assetsLoader.getLevel("0")).subscribe(function(t){e.asset.vertexShader=t[0],e.asset.fragmentShader=t[1],e.asset.simpleParticleVertexShader=t[2],e.asset.simpleParticleFragmentShader=t[3],e.asset.dynamicVertexShader=t[4],e.asset.dynamicFragmentShader=t[5],e.asset.colorVertexShader=t[6],e.asset.colorFragmentShader=t[7],e.asset.texture=t[8],e.asset.particleTexture=t[9],e.asset.genericParticleTexture=t[10],e.asset.tileAssets=t[11],e.asset.tileAssets=e.addToTileAssets(e.asset.tileAssets,t[12]),e.level=t[13],e.canvas=document.getElementById("gameCanvas"),e.game=new a.Game(e.asset,e.canvas,e.level)})}return e.prototype.addToTileAssets=function(e,t){return t.forEach(function(t,i){e.set(i,t)}),e},e.prototype.initialize=function(){},e}();t.Loader=h},function(e,t,i){"use strict";var r=i(3),n=i(346),s=i(391),a=i(392),o=function(){function e(){this.shaderUrl="src/assets/shader/",this.textureUrl="src/assets/texture/",this.levelUrl="src/assets/maps/",this.constants=s.Constants.getInstance()}return e.prototype.getShader=function(e){return this.httpGet(this.shaderUrl+e).catch(this.handleError)},e.prototype.getTexture=function(e){var t=this;return r.Observable.create(function(i){var r=new Image;r.src=t.textureUrl+e,r.onload=function(){i.next(r),i.complete()}})},e.prototype.getLevel=function(e){return this.httpGet(this.levelUrl+e+".json").map(this.extractLevel).catch(this.handleError)},e.prototype.httpGet=function(e){return r.Observable.create(function(t){var i=new XMLHttpRequest;i.onreadystatechange=function(){4==i.readyState&&200==i.status&&(t.next(i.responseText),t.complete())},i.onerror=function(){t.error(i.responseText)},i.open("GET",e,!0),i.send(null)})},e.prototype.getTileTextures=function(e){return this.getTextures(e,this.constants.tileResources)},e.prototype.getUiTextures=function(e){return this.getTextures(e,this.constants.uiResources)},e.prototype.getTextures=function(e,t){var i=this;return r.Observable.create(function(r){for(var n=new Map,s=0,o=function(o){var h=new Image;h.src=i.textureUrl+o.name,h.onload=function(){s++;var i=+o.name.split(e)[0];n.set(i,new a.TileAsset(i,h,o.size)),s>=t.length&&(r.next(n),r.complete())}},h=0,c=t;h<c.length;h++){var l=c[h];o(l)}})},e.prototype.extractLevel=function(e){var t=n.LoadHelper.getInstance(),i=JSON.parse(e);try{t.validateLevelData(i)}catch(e){console.log("Invalid level: "+e)}return i},e.prototype.handleError=function(e){var t;return t=e.message?e.message:e.toString(),console.error(t),r.Observable.throw(t)},e}();t.AssetsLoader=o},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";var r=i(347),n=i(401),s=i(416),a=function(){function e(){}return e.prototype.constrcuctor=function(){if(e.instance)throw new Error("Static class cant be instanced!");e.instance=this},e.getInstance=function(){return e.instance},e.prototype.levelDataToLevel=function(e,t,i,a){var o=new r.Level;if(o.name=e.name,o.end=new r.Rectangle(e.end[0],e.end[1],256,128),o.player=[e.player[0],e.player[1]],o.gameSize=[e.gameSize[0],e.gameSize[1]],o.camera=[e.camera[0],e.camera[1]],o.tiles=e.tiles.map(function(e){return new r.Tile(e.area.x,e.area.y,e.area.width,e.area.height,e.key)}),o.decorativeTiles=e.decorativeTiles.map(function(e){return new r.Tile(e.area.x,e.area.y,e.area.width,e.area.height,e.key)}),e.background){var h=e.background;o.decorativeTiles.unshift(new r.Tile(h.area.x,h.area.y,h.area.width,h.area.height,h.key))}return o.dynamicTiles=e.dynamicTiles.map(function(e){var t;return t=e.vertical?e.inverse?new r.Vector(0,-e.velocity):new r.Vector(0,e.velocity):e.inverse?new r.Vector(-e.velocity,0):new r.Vector(e.velocity,0),new r.DynamicTile(new r.Tile(e.tile.x,e.tile.y,e.tile.width,e.tile.height,e.key),t,e.vertical,e.distance)}),o.dynamicTiles.sort(function(e,t){return e.tile.key-t.tile.key}),o.enemies=e.enemies.map(function(e){var o;return 50==e.key?o=new n.Swordman(new r.Vector(e.area.x,e.area.y),e.area.width,e.area.height,t,i):51==e.key?o=new n.Archer(new r.Vector(e.area.x,e.area.y),e.area.width,e.area.height,t,i):52==e.key?o=new n.Shadow(new r.Vector(e.area.x,e.area.y),85,85,t,i):53==e.key?o=new n.MasterSorcerer(new r.Vector(e.area.x,e.area.y),128,96,t,i,a):54==e.key?o=new n.Apprentice(new r.Vector(e.area.x,e.area.y),e.area.width,e.area.height,t,i,a):55==e.key?o=new n.Screamer(new r.Vector(e.area.x,e.area.y),64,96,t,i,a):56==e.key&&(o=new s.ShapeShifter(new r.Vector(e.area.x,e.area.y),96,96,t,i,a)),o}),o},e.prototype.validateLevelData=function(e){var t=this.checkDoubleNumberTouple(e,"camera")&&this.checkPropertyExists(e,"dynamicTiles")&&this.checkPropertyExists(e,"enemies")&&this.checkPropertyExists(e,"tiles")&&this.checkPropertyExists(e,"decorativeTiles")&&this.checkPropertyExists(e,"background")&&this.checkDoubleNumberTouple(e,"player")&&this.checkDoubleNumberTouple(e,"gameSize")&&this.checkDoubleNumberTouple(e,"end");return t},e.prototype.checkDoubleNumberTouple=function(e,t){var i=this.checkPropertyExists(e,t)&&2==e[t].length&&this.isNumber(e[t][0])&&this.isNumber(e[t][1]);return i},e.prototype.isNumber=function(e){return!isNaN(+e)},e.prototype.checkPropertyExists=function(e,t){var i=void 0!==e[t];return i},e.instance=new e,e}();t.LoadHelper=a},function(e,t,i){"use strict";var r=i(348);t.ShaderType=r.ShaderType;var n=i(349);t.Tile=n.Tile;var s=i(350);t.Vector=s.Vector;var a=i(351);t.Rectangle=a.Rectangle;var o=i(352);t.Sprite=o.Sprite;var h=i(353);t.Level=h.Level;var c=i(354);t.Asset=c.Asset;var l=i(355);t.Projectile=l.Projectile;var u=i(356);t.Animation=u.Animation;var p=i(371);t.FrameAnimation=p.FrameAnimation;var d=i(372);t.SpellType=d.SpellType;var g=i(373);t.Spell=g.Spell;var f=i(374);t.PhysicalProjectile=f.PhysicalProjectile;var x=i(377);t.Meele=x.Meele;var y=i(378);t.DebugElement=y.DebugElement;var m=i(379);t.TextureType=m.TextureType;var v=i(380);t.StickyAnimation=v.StickyAnimation;var w=i(381);t.RotationAnimation=w.RotationAnimation;var R=i(382);t.StaticRotationAnimation=R.StaticRotationAnimation;var T=i(383);t.CollisionProjectile=T.CollisionProjectile;var A=i(384);t.ProjectileType=A.ProjectileType;var C=i(385);t.Cast=C.Cast;var S=i(386);t.InstantCast=S.InstantCast;var P=i(387);t.ChannelCast=P.ChannelCast;var b=i(388);t.SpellCast=b.SpellCast;var E=i(389);t.ParticleProjectile=E.ParticleProjectile;var H=i(390);t.DynamicTile=H.DynamicTile;var k=i(398);t.DynamicTileData=k.DynamicTileData;var B=i(399);t.RenderableData=B.RenderableData;var D=i(400);t.Progress=D.Progress},function(e,t){"use strict";!function(e){e[e.Vertex=1]="Vertex",e[e.Fragment=2]="Fragment"}(t.ShaderType||(t.ShaderType={}));t.ShaderType},function(e,t){"use strict";var i=function(){function e(e,t,i,r,n){this.x=e,this.y=t,this.width=i,this.height=r,this.key=n}return e}();t.Tile=i},function(e,t){"use strict";var i=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.add=function(e){return e&&(this.x+=e.x,this.y+=e.y),this},e.prototype.copy=function(t){return new e(t.x,t.y)},e.prototype.normalize=function(){var e=this.magnitude();this.x=this.x/e,this.y=this.y/e},e.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.multiply=function(e){this.x=this.x*e,this.y=this.y*e},e.prototype.invert=function(){return this.x=-this.x,this.y=-this.y,this},e}();t.Vector=i},function(e,t){"use strict";var i=function(){function e(e,t,i,r){this.x=e,this.y=t,this.width=i,this.height=r}return e}();t.Rectangle=i},function(e,t){"use strict";var i=function(){function e(e){this.position=e}return e}();t.Sprite=i},function(e,t){"use strict";var i=function(){function e(){this.tiles=[],this.decorativeTiles=[],this.dynamicTiles=[],this.enemies=[]}return e}();t.Level=i},function(e,t){"use strict";var i=function(){function e(){}return e}();t.Asset=i},function(e,t,i){"use strict";var r=i(347),n=function(){function e(e,t,i,n,s){this.projectileType=r.ProjectileType.None,this.damage=0,this.velocity=e,this.area=t,this.animation=i,s?this.collisionArea=s:this.collisionArea=new r.Rectangle(this.area.x+this.area.width/2-this.area.width*n/2,this.area.y+this.area.height/2-this.area.height*n/2,this.area.width*n,this.area.height*n)}return e.prototype.update=function(e,t,i){this.area.x+=e,this.area.y+=t,this.collisionArea.x+=e,this.collisionArea.y+=t,this.animation.areaToRender.x=this.area.x,this.animation.areaToRender.y=this.area.y},e.prototype.updateForces=function(e){},e}();t.Projectile=n},function(e,t,i){"use strict";var r=i(357),n=function(){function e(e){this.timeToChange=100,this.inverse=!1,this.delay=0,this.frameIndex=0,this.lastChange=0,this.textureCoords=[];for(var t=0,i=e;t<i.length;t++){var n=i[t];this.textureCoords.push(r.RenderHelper.getInstance().getTextureCoordinates([],n))}}return e.prototype.next=function(e){this.lastChange+=e,this.lastChange>=this.timeToChange&&(this.lastChange=0,this.delay>0&&this.delay--,this.frameIndex++,this.repetitions&&this.repetitions--,this.frameIndex>=this.textureCoords.length&&(this.frameIndex=0))},e.prototype.getCurrentFrame=function(){return this.textureCoords[this.frameIndex]},e.prototype.reset=function(){this.frameIndex=0,this.lastChange=0},e}();t.Animation=n},function(e,t,i){"use strict";var r=i(358);t.Renderer=r.Renderer;var n=i(359);t.RenderCall=n.RenderCall;var s=i(360);t.ColorRenderCall=s.ColorRenderCall;var a=i(361);t.ColorRenderer=a.ColorRenderer;var o=i(362);t.RenderHelper=o.RenderHelper;var h=i(365);t.DynamicRenderCall=h.DynamicRenderCall;var c=i(363);t.TextureMapper=c.TextureMapper;var l=i(366);t.ParticleRenderer=l.ParticleRenderer;var u=i(364);t.Matrix3=u.Matrix3},function(e,t,i){"use strict";var r=i(347),n=function(){function e(e){this.context=e,this.gl=this.context.gl,this.shaderProgram=this.context.shaderProgram,this.gl.useProgram(this.shaderProgram),this.gl.bindAttribLocation(this.shaderProgram,0,"a_position"),this.gl.bindAttribLocation(this.shaderProgram,1,"a_texture_coord"),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"a_position"),this.textureCoordAttribute=this.gl.getAttribLocation(this.shaderProgram,"a_texture_coord"),this.resolutionLocation=this.gl.getUniformLocation(this.shaderProgram,"u_resolution"),this.cameraLocation=this.gl.getUniformLocation(this.shaderProgram,"u_camera"),this.resolution=new r.Vector(this.context.gl.canvas.width,this.context.gl.canvas.height),this.vertexBuffer=this.gl.createBuffer(),this.textureCoordBuffer=this.gl.createBuffer(),this.indeciesBuffer=this.gl.createBuffer()}return e.prototype.render=function(e,t){var i=this;this.gl.useProgram(this.shaderProgram),e.forEach(function(e,r){i.gl.enableVertexAttribArray(i.positionLocation),i.gl.enableVertexAttribArray(i.textureCoordAttribute),i.gl.bindBuffer(i.gl.ARRAY_BUFFER,i.vertexBuffer),i.gl.bufferData(i.gl.ARRAY_BUFFER,new Float32Array(e.vertecies),i.gl.STATIC_DRAW),i.gl.bindBuffer(i.gl.ARRAY_BUFFER,i.textureCoordBuffer),i.gl.bufferData(i.gl.ARRAY_BUFFER,new Float32Array(e.textureCoords),i.gl.STATIC_DRAW),i.gl.bindBuffer(i.gl.ELEMENT_ARRAY_BUFFER,i.indeciesBuffer),i.gl.bufferData(i.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(e.indecies),i.gl.STATIC_DRAW),i.gl.bindBuffer(i.gl.ARRAY_BUFFER,i.vertexBuffer),i.gl.vertexAttribPointer(i.positionLocation,2,i.gl.FLOAT,!1,0,0),i.gl.bindBuffer(i.gl.ARRAY_BUFFER,i.textureCoordBuffer),i.gl.vertexAttribPointer(i.textureCoordAttribute,2,i.gl.FLOAT,!1,0,0),i.gl.uniform2f(i.resolutionLocation,i.resolution.x,i.resolution.y),i.gl.uniform2f(i.cameraLocation,t[0],t[1]),i.gl.activeTexture(i.gl.TEXTURE0),r!=-1?i.gl.bindTexture(i.gl.TEXTURE_2D,i.context.tileTextures.get(r)):i.gl.bindTexture(i.gl.TEXTURE_2D,i.context.glTexture),i.gl.bindBuffer(i.gl.ELEMENT_ARRAY_BUFFER,i.indeciesBuffer),i.gl.drawElements(i.gl.TRIANGLES,e.indecies.length,i.gl.UNSIGNED_SHORT,0),i.gl.disableVertexAttribArray(i.positionLocation),i.gl.disableVertexAttribArray(i.textureCoordAttribute)})},e}();t.Renderer=n},function(e,t){"use strict";var i=function(){function e(){this.vertecies=[],this.indecies=[],this.textureCoords=[]}return e}();t.RenderCall=i},function(e,t){"use strict";var i=function(){function e(){this.vertecies=[],this.indecies=[],this.textureCoords=[],this.color=[]}return e}();t.ColorRenderCall=i},function(e,t,i){"use strict";var r=i(347),n=function(){function e(e){this.context=e,this.gl=this.context.gl,this.shaderProgram=this.context.colorShaderProgram,this.gl.useProgram(this.shaderProgram),this.gl.bindAttribLocation(this.shaderProgram,0,"a_position"),this.gl.bindAttribLocation(this.shaderProgram,1,"a_color"),this.gl.bindAttribLocation(this.shaderProgram,2,"a_texture_coord"),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"a_position"),this.colorAttributeLocation=this.gl.getAttribLocation(this.shaderProgram,"a_color"),this.textureCoordAttribute=this.gl.getAttribLocation(this.shaderProgram,"a_texture_coord"),this.resolutionLocation=this.gl.getUniformLocation(this.shaderProgram,"u_resolution"),this.cameraLocation=this.gl.getUniformLocation(this.shaderProgram,"u_camera"),this.resolution=new r.Vector(this.context.gl.canvas.width,this.context.gl.canvas.height),this.colorBuffer=this.gl.createBuffer(),this.vertexBuffer=this.gl.createBuffer(),this.textureCoordBuffer=this.gl.createBuffer(),this.indeciesBuffer=this.gl.createBuffer()}return e.prototype.render=function(e,t){this.gl.useProgram(this.shaderProgram);for(var i=0,r=e;i<r.length;i++){var n=r[i];this.gl.enableVertexAttribArray(this.positionLocation),this.gl.enableVertexAttribArray(this.textureCoordAttribute),this.gl.enableVertexAttribArray(this.colorAttributeLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(n.vertecies),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.textureCoordBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(n.textureCoords),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(n.color),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indeciesBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(n.indecies),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.textureCoordBuffer),this.gl.vertexAttribPointer(this.textureCoordAttribute,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorBuffer),this.gl.vertexAttribPointer(this.colorAttributeLocation,4,this.gl.FLOAT,!1,0,0),this.gl.uniform2f(this.resolutionLocation,this.resolution.x,this.resolution.y),this.gl.uniform2f(this.cameraLocation,t[0],t[1]),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.context.glTexture),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indeciesBuffer),this.gl.drawElements(this.gl.TRIANGLES,n.indecies.length,this.gl.UNSIGNED_SHORT,0),this.gl.disableVertexAttribArray(this.positionLocation),this.gl.disableVertexAttribArray(this.textureCoordAttribute),this.gl.disableVertexAttribArray(this.colorAttributeLocation)}},e}();t.ColorRenderer=n},function(e,t,i){"use strict";var r=i(363),n=i(347),s=i(364),a=function(){function e(){this.textureMapper=r.TextureMapper.getInstance(),this.canvasWidth=1200,this.canvasHeight=800,this.projectionMatrix=s.Matrix3.createProjectionMatrix(this.canvasWidth,this.canvasHeight)}return e.prototype.constrcuctor=function(){if(e.instance)throw new Error("Static class cant be instanced!");e.instance=this},e.getInstance=function(){return e.instance},e.prototype.getRelativeValue=function(e,t){var i=new n.Vector(0,0);return i.x=e/(this.canvasWidth/2)-1,i.y=-t/(this.canvasHeight/2)+1,i},e.prototype.getVertecies=function(e,t,i,r,n){var s=e,a=e+i,o=t,h=t+r,c=[s,o,a,h,a,o,s,o,a,h,s,h];return n.push.apply(n,c),n},e.prototype.getInverseVertecies=function(e,t,i,r,n){var s=e+i,a=e,o=t,h=t+r,c=[s,o,a,h,a,o,s,o,a,h,s,h];return n.push.apply(n,c),n},e.prototype.getColor=function(e,t){var i=[];return i=t?t:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],e.push.apply(e,i),e},e.prototype.getMatrices=function(e,t,i,r,n,a){var o=e+i/2,h=t+r/2,c=s.Matrix3.createTranslationMatrix(-o,-h),l=s.Matrix3.createRotationMatrix(n),u=s.Matrix3.createTranslationMatrix(o,h),p=s.Matrix3.multiply(c,l);return p=s.Matrix3.multiply(p,u),p=s.Matrix3.multiply(p,this.projectionMatrix),p=this.getIndeciesAttribute(p),a.push.apply(a,p),a},e.prototype.getIndeciesAttribute=function(e){for(var t=e.slice(0,e.length),i=0;i<5;i++)e.push.apply(e,t);return e},e.prototype.getIndecies=function(e){var t=[e.length,e.length+1,e.length+2,e.length+3,e.length+4,e.length+5];return e.push.apply(e,t),e},e.prototype.addTextureCoordinates=function(e,t){return e.push.apply(e,t),e},e.prototype.getTextureCoordinates=function(t,i){var r=this.textureMapper.mapTexture(i),n=this.getCoords(r,e.textureSize);return t.push.apply(t,n),t},e.prototype.getTiledTextureCoordinates=function(e,t,i){var r=0,n=e.width/i[0],s=0,a=e.height/i[1],o=[r,s,n,a,n,s,r,s,n,a,r,a];return t.push.apply(t,o),t},e.prototype.getMainTextureCoords=function(t){return this.getCoords(t,e.textureSize)},e.prototype.getCoords=function(e,t){var i=e.x/t,r=e.y/t,n=(e.x+e.width)/t,s=(e.y+e.height)/t,a=[i,r,n,s,n,r,i,r,n,s,i,s];return a},e.instance=new e,e.textureSize=2048,e}();t.RenderHelper=a},function(e,t,i){"use strict";var r=i(347),n=function(){function e(){this.texture0=new r.Rectangle(0,0,0,0),this.texture1=new r.Rectangle(0,0,51.2,51.2),this.texture2=new r.Rectangle(51.2,0,51.2,51.2),this.texture3=new r.Rectangle(102.4,0,51.2,51.2),this.texture4=new r.Rectangle(153.6,0,51.2,51.2),this.texture5=new r.Rectangle(204.8,0,51.2,51.2),this.texture6=new r.Rectangle(0,51.2,51.2,51.2),this.texture7=new r.Rectangle(51.2,51.2,51.2,51.2),this.texture8=new r.Rectangle(102.4,51.2,51.2,51.2),this.texture9=new r.Rectangle(153.6,51.2,51.2,51.2),this.texture10=new r.Rectangle(204.8,51.2,51.2,51.2),this.texture11=new r.Rectangle(0,102.4,51.2,51.2),this.texture12=new r.Rectangle(51.2,102.4,51.2,51.2),this.texture13=new r.Rectangle(102.4,102.4,51.2,51.2),this.texture14=new r.Rectangle(153.6,102.4,51.2,51.2),this.texture15=new r.Rectangle(204.8,102.4,51.2,50),this.texture16=new r.Rectangle(0,153.6,51.2,51.2),this.texture17=new r.Rectangle(51.2,153.6,51.2,51.2),this.texture18=new r.Rectangle(102.4,153.6,51.2,51.2),this.texture19=new r.Rectangle(153.6,153.6,50,50),this.texture20=new r.Rectangle(204.8,153.6,51.2,51.2),this.texture21=new r.Rectangle(0,204.8,51.2,51.2),this.texture22=new r.Rectangle(51.2,204.8,51.2,51.2),this.texture23=new r.Rectangle(102.4,204.8,50,51.2),this.texture24=new r.Rectangle(153.6,204.8,51.2,51.2),this.texture25=new r.Rectangle(234,220,20,36),this.texture26=new r.Rectangle(128,320,86,128),this.texture50=new r.Rectangle(0,368,128,16),this.texture51=new r.Rectangle(32,1280,290,32),this.texture52=new r.Rectangle(32,1440,64,8),this.texture53=new r.Rectangle(33,1448,8,8),this.texture54=new r.Rectangle(33,1456,8,8),this.texture55=new r.Rectangle(384,1024,128,128),this.texture56=new r.Rectangle(512,1024,128,128),this.texture57=new r.Rectangle(640,1024,128,128),this.texture58=new r.Rectangle(768,1024,128,128),this.texture59=new r.Rectangle(896,1024,128,128),this.texture60=new r.Rectangle(1760,1248,32,64),this.texture61=new r.Rectangle(1792,1248,32,64),this.texture62=new r.Rectangle(1824,1248,32,64),this.texture63=new r.Rectangle(1856,1248,32,64),this.texture100=new r.Rectangle(258,2,55,50),this.texture101=new r.Rectangle(311,2,64,55),this.texture102=new r.Rectangle(375,2,72,64),this.texture103=new r.Rectangle(257,64,75,64),this.texture104=new r.Rectangle(336,64,78,72),this.texture105=new r.Rectangle(416,64,82,75),this.texture106=new r.Rectangle(256,192,128,128),this.texture107=new r.Rectangle(384,192,128,128),this.texture108=new r.Rectangle(512,192,128,128),this.texture109=new r.Rectangle(256,320,128,128),this.texture110=new r.Rectangle(384,320,128,128),this.texture111=new r.Rectangle(512,320,128,128),this.texture112=new r.Rectangle(512,0,128,128),this.texture113=new r.Rectangle(640,0,128,128),this.texture114=new r.Rectangle(768,0,128,128),this.texture115=new r.Rectangle(896,0,128,128),this.texture116=new r.Rectangle(704,128,128,128),this.texture117=new r.Rectangle(832,128,128,128),this.texture118=new r.Rectangle(1870,340,85,85),this.texture119=new r.Rectangle(1955,340,85,85),this.texture120=new r.Rectangle(1700,425,85,85),this.texture121=new r.Rectangle(1785,425,85,85),this.texture122=new r.Rectangle(1870,425,85,85),this.texture123=new r.Rectangle(1955,425,85,85),this.texture124=new r.Rectangle(1700,510,85,85),this.texture125=new r.Rectangle(1785,510,85,85),this.texture126=new r.Rectangle(1870,510,85,85),this.texture127=new r.Rectangle(1955,510,85,85),this.texture128=new r.Rectangle(1700,595,85,85),this.texture129=new r.Rectangle(1785,595,85,85),this.texture130=new r.Rectangle(1870,595,85,85),this.texture131=new r.Rectangle(1955,595,85,85),this.texture132=new r.Rectangle(1700,680,85,85),this.texture133=new r.Rectangle(1785,680,85,85),this.texture134=new r.Rectangle(1870,680,85,85),this.texture135=new r.Rectangle(1955,680,85,85),this.texture136=new r.Rectangle(1700,765,85,85),this.texture137=new r.Rectangle(1785,765,85,85),this.texture138=new r.Rectangle(1870,765,85,85),this.texture139=new r.Rectangle(1408,448,64,64),this.texture140=new r.Rectangle(1472,448,64,64),this.texture141=new r.Rectangle(1536,448,64,64),this.texture142=new r.Rectangle(1600,448,64,64),this.texture143=new r.Rectangle(1408,512,64,64),this.texture144=new r.Rectangle(1472,512,64,64),this.texture145=new r.Rectangle(1536,512,64,64),this.texture146=new r.Rectangle(1600,512,64,64),this.texture147=new r.Rectangle(0,896,128,128),this.texture148=new r.Rectangle(128,896,128,128),this.texture149=new r.Rectangle(256,896,128,128),this.texture150=new r.Rectangle(0,1024,128,128),this.texture151=new r.Rectangle(128,1024,128,128),this.texture152=new r.Rectangle(256,1024,128,128),this.texture153=new r.Rectangle(1408,576,64,64),this.texture154=new r.Rectangle(1472,576,64,64),this.texture155=new r.Rectangle(1536,576,64,64),this.texture156=new r.Rectangle(32,608,32,64),this.texture157=new r.Rectangle(96,608,32,64),this.texture158=new r.Rectangle(160,608,32,64),this.texture159=new r.Rectangle(224,608,32,64),this.texture160=new r.Rectangle(1056,1248,32,64),this.texture161=new r.Rectangle(1088,1248,32,64),this.texture162=new r.Rectangle(992,1248,32,64),this.texture163=new r.Rectangle(1024,1248,32,64),this.texture165=new r.Rectangle(1152,1248,32,64),this.texture166=new r.Rectangle(1184,1248,32,64),this.texture167=new r.Rectangle(1216,1248,32,64),this.texture168=new r.Rectangle(1280,1248,32,64),this.texture169=new r.Rectangle(1312,1248,32,64),this.texture170=new r.Rectangle(1344,1248,32,64),this.texture171=new r.Rectangle(1376,1248,32,64),this.texture172=new r.Rectangle(1408,1248,32,64),this.texture173=new r.Rectangle(1472,1248,32,64),this.texture174=new r.Rectangle(1504,1248,32,64),this.texture175=new r.Rectangle(1536,1248,32,64),this.texture176=new r.Rectangle(1568,1248,32,64),this.texture177=new r.Rectangle(1600,1248,32,64),this.texture178=new r.Rectangle(1632,1248,32,64),this.texture179=new r.Rectangle(1248,32,164,27),this.texture180=new r.Rectangle(1248,96,32,32),this.texture181=new r.Rectangle(1248,64,164,27),this.texture182=new r.Rectangle(1248,0,164,27),this.texture183=new r.Rectangle(1440,0,164,27),this.texture184=new r.Rectangle(1440,32,164,27),this.texture185=new r.Rectangle(1440,64,164,27),this.texture186=new r.Rectangle(1440,96,164,27),this.texture187=new r.Rectangle(1088,96,128,64),this.texture188=new r.Rectangle(1088,192,128,64),this.texture189=new r.Rectangle(1088,256,128,64),this.texture190=new r.Rectangle(1088,320,128,64),this.texture191=new r.Rectangle(1088,384,128,64),this.texture192=new r.Rectangle(1088,448,128,64),this.texture193=new r.Rectangle(1088,512,128,64),this.texture194=new r.Rectangle(1088,576,128,64),this.texture195=new r.Rectangle(1088,640,128,64),this.texture196=new r.Rectangle(1088,704,128,64),this.texture197=new r.Rectangle(1088,768,128,64),this.texture198=new r.Rectangle(1632,0,270,64),this.texture199=new r.Rectangle(64,1664,128,128),this.texture200=new r.Rectangle(28,293,28,26),this.texture201=new r.Rectangle(56,293,28,26),this.texture202=new r.Rectangle(84,293,28,26),this.texture203=new r.Rectangle(0,290,28,29),this.texture204=new r.Rectangle(112,290,28,29),this.texture205=new r.Rectangle(140,290,28,29),this.texture206=new r.Rectangle(168,290,28,29),this.texture207=new r.Rectangle(196,290,28,29),this.texture208=new r.Rectangle(224,290,28,29),this.texture209=new r.Rectangle(0,480,28,29),this.texture210=new r.Rectangle(28,480,28,29),this.texture211=new r.Rectangle(56,480,28,29),this.texture212=new r.Rectangle(84,480,28,29),this.texture214=new r.Rectangle(0,448,28,29),this.texture215=new r.Rectangle(28,448,28,29),this.texture216=new r.Rectangle(56,448,28,29),this.texture217=new r.Rectangle(84,448,28,29),this.texture218=new r.Rectangle(112,448,28,29),this.texture219=new r.Rectangle(140,448,28,29),this.texture220=new r.Rectangle(0,416,28,29),this.texture221=new r.Rectangle(28,416,28,29),this.texture222=new r.Rectangle(56,416,28,29),this.texture223=new r.Rectangle(84,416,28,29),this.texture224=new r.Rectangle(0,384,28,29),this.texture225=new r.Rectangle(28,384,28,29),this.texture226=new r.Rectangle(56,384,28,29),this.texture227=new r.Rectangle(112,480,28,29),this.texture228=new r.Rectangle(140,480,28,29),this.texture229=new r.Rectangle(168,480,28,29),this.texture230=new r.Rectangle(196,480,28,29),this.texture231=new r.Rectangle(224,480,28,29),this.texture232=new r.Rectangle(252,480,28,29),this.texture233=new r.Rectangle(32,1152,32,32),this.texture234=new r.Rectangle(64,1152,32,32),this.texture235=new r.Rectangle(96,1152,32,32),this.texture236=new r.Rectangle(128,1152,32,32),this.texture237=new r.Rectangle(160,1152,32,32),this.texture238=new r.Rectangle(192,1152,32,32),this.texture239=new r.Rectangle(224,1152,32,32),this.texture240=new r.Rectangle(256,1152,32,32),this.texture241=new r.Rectangle(288,1152,32,32),this.texture242=new r.Rectangle(320,1152,32,32),this.texture243=new r.Rectangle(32,1216,32,32),this.texture244=new r.Rectangle(64,1216,32,32),this.texture245=new r.Rectangle(96,1216,32,32),this.texture246=new r.Rectangle(128,1216,32,32),this.texture247=new r.Rectangle(160,1216,32,32),this.texture248=new r.Rectangle(192,1216,32,32),this.texture249=new r.Rectangle(0,320,28,32),this.texture250=new r.Rectangle(224,1216,32,32),this.texture251=new r.Rectangle(256,1216,32,32),this.texture252=new r.Rectangle(288,1216,32,32),this.texture253=new r.Rectangle(320,1216,32,32),this.texture254=new r.Rectangle(352,1216,32,32),this.texture255=new r.Rectangle(384,1216,32,32),this.texture256=new r.Rectangle(416,1216,32,32),this.texture257=new r.Rectangle(448,1216,32,32),this.texture262=new r.Rectangle(32,1344,32,32),this.texture263=new r.Rectangle(64,1344,32,32),this.texture264=new r.Rectangle(96,1344,32,32);this.texture265=new r.Rectangle(160,1344,32,32);this.texture266=new r.Rectangle(192,1344,32,32),this.texture267=new r.Rectangle(224,1344,32,32),this.texture268=new r.Rectangle(32,1401,24,7),this.texture269=new r.Rectangle(64,1401,15,7),this.texture270=new r.Rectangle(288,1344,32,32),this.texture271=new r.Rectangle(320,1344,32,32),this.texture272=new r.Rectangle(352,1344,32,32),this.texture273=new r.Rectangle(384,1344,32,32),this.texture274=new r.Rectangle(416,1344,32,32),this.texture275=new r.Rectangle(448,1344,32,32),this.texture276=new r.Rectangle(288,1376,32,32),this.texture277=new r.Rectangle(320,1376,32,32),this.texture278=new r.Rectangle(352,1376,32,32),this.texture279=new r.Rectangle(384,1376,32,32),this.texture280=new r.Rectangle(416,1376,32,32),this.texture281=new r.Rectangle(448,1376,32,32),this.texture282=new r.Rectangle(512,1344,32,32),this.texture283=new r.Rectangle(544,1344,32,32),this.texture284=new r.Rectangle(576,1344,32,32),this.texture285=new r.Rectangle(608,1344,32,32),this.texture286=new r.Rectangle(640,1344,32,32),this.texture287=new r.Rectangle(672,1344,32,32),this.texture288=new r.Rectangle(704,1344,32,32),this.texture289=new r.Rectangle(736,1344,32,32),this.texture290=new r.Rectangle(800,1344,32,32),this.texture291=new r.Rectangle(832,1344,32,32),this.texture292=new r.Rectangle(864,1344,32,32),this.texture293=new r.Rectangle(896,1344,32,32),this.texture294=new r.Rectangle(480,1376,28,32),this.texture295=new r.Rectangle(512,1376,28,32),this.texture296=new r.Rectangle(544,1376,28,32),this.texture297=new r.Rectangle(480,1440,20,20),this.texture298=new r.Rectangle(512,1440,20,20),this.texture299=new r.Rectangle(544,1440,20,20),this.texture300=new r.Rectangle(32,1664,128,128),this.texture301=new r.Rectangle(1344,1184,64,64),this.texture302=new r.Rectangle(1408,1184,64,64),this.texture303=new r.Rectangle(1472,1184,64,64),this.texture304=new r.Rectangle(1536,1184,64,64),this.texture305=new r.Rectangle(1600,1184,64,64),this.texture306=new r.Rectangle(1664,1184,64,64),this.texture500=new r.Rectangle(0,1536,96,64),this.texture550=new r.Rectangle(1088,0,128,64),this.texture551=new r.Rectangle(1632,96,111,12),this.texture552=new r.Rectangle(1632,128,111,12),this.texture553=new r.Rectangle(1440,128,164,27),this.texture554=new r.Rectangle(1248,128,164,27),this.texture555=new r.Rectangle(1440,160,164,27),this.texture556=new r.Rectangle(1440,192,164,27),this.texture557=new r.Rectangle(1440,224,164,27),this.texture558=new r.Rectangle(1440,256,164,27),this.texture560=new r.Rectangle(1344,704,64,96),this.texture561=new r.Rectangle(1408,704,64,96),this.texture562=new r.Rectangle(1472,704,64,96),this.texture563=new r.Rectangle(1536,704,64,96),this.texture564=new r.Rectangle(1600,704,64,96),this.texture565=new r.Rectangle(1344,800,64,96),this.texture566=new r.Rectangle(1408,800,64,96),this.texture567=new r.Rectangle(1472,800,64,96),this.texture568=new r.Rectangle(1536,800,64,96),this.texture569=new r.Rectangle(1600,800,64,96),this.texture570=new r.Rectangle(1344,896,64,96),this.texture571=new r.Rectangle(1408,896,64,96),this.texture572=new r.Rectangle(1472,896,64,96),this.texture573=new r.Rectangle(1536,896,64,96),this.texture574=new r.Rectangle(1600,896,64,96),this.texture575=new r.Rectangle(1344,992,64,96),this.texture576=new r.Rectangle(1408,992,64,96),this.texture577=new r.Rectangle(1472,992,64,96),this.texture578=new r.Rectangle(1536,992,64,96),this.texture579=new r.Rectangle(1600,992,64,96),this.texture580=new r.Rectangle(1408,1440,128,96),this.texture581=new r.Rectangle(1536,1440,128,96),this.texture582=new r.Rectangle(1664,1440,128,96),this.texture583=new r.Rectangle(1792,1440,128,96),this.texture584=new r.Rectangle(1408,1568,128,96),this.texture585=new r.Rectangle(1536,1568,128,96),
this.texture586=new r.Rectangle(1664,1568,128,96),this.texture587=new r.Rectangle(1792,1568,128,96),this.texture588=new r.Rectangle(1408,1696,128,96),this.texture589=new r.Rectangle(1536,1696,128,96),this.texture590=new r.Rectangle(1664,1696,128,96),this.texture591=new r.Rectangle(1792,1696,128,96),this.texture592=new r.Rectangle(1408,1824,128,96),this.texture593=new r.Rectangle(1536,1824,128,96),this.texture594=new r.Rectangle(1664,1824,128,96),this.texture595=new r.Rectangle(1792,1824,128,96),this.texture596=new r.Rectangle(1408,1952,128,96),this.texture597=new r.Rectangle(1664,1952,128,96),this.texture598=new r.Rectangle(1792,1952,128,96),this.texture600=new r.Rectangle(544,0,96,96),this.texture601=new r.Rectangle(640,0,96,96),this.texture602=new r.Rectangle(736,0,96,96),this.texture603=new r.Rectangle(832,0,96,96),this.texture604=new r.Rectangle(544,96,96,96),this.texture605=new r.Rectangle(640,96,96,96),this.texture606=new r.Rectangle(736,96,96,96),this.texture607=new r.Rectangle(832,96,96,96)}return e.prototype.constrcuctor=function(){if(e.instance)throw new Error("Static class cant be instanced!");e.instance=this},e.getInstance=function(){return e.instance},e.prototype.mapTexture=function(e){switch(e){case 0:return this.texture0;case 1:return this.texture1;case 2:return this.texture2;case 3:return this.texture3;case 4:return this.texture4;case 5:return this.texture5;case 6:return this.texture6;case 7:return this.texture7;case 8:return this.texture8;case 9:return this.texture9;case 10:return this.texture10;case 11:return this.texture11;case 12:return this.texture12;case 13:return this.texture13;case 14:return this.texture14;case 15:return this.texture15;case 16:return this.texture16;case 17:return this.texture17;case 18:return this.texture18;case 19:return this.texture19;case 20:return this.texture20;case 21:return this.texture21;case 22:return this.texture22;case 23:return this.texture23;case 24:return this.texture24;case 25:return this.texture25;case 26:return this.texture26;case 50:return this.texture50;case 51:return this.texture51;case 52:return this.texture52;case 53:return this.texture53;case 54:return this.texture54;case 55:return this.texture55;case 56:return this.texture56;case 57:return this.texture57;case 58:return this.texture58;case 59:return this.texture59;case 60:return this.texture60;case 61:return this.texture61;case 62:return this.texture62;case 63:return this.texture63;case 100:return this.texture100;case 101:return this.texture101;case 102:return this.texture102;case 103:return this.texture103;case 104:return this.texture104;case 105:return this.texture105;case 106:return this.texture106;case 107:return this.texture107;case 108:return this.texture108;case 109:return this.texture109;case 110:return this.texture110;case 111:return this.texture111;case 112:return this.texture112;case 113:return this.texture113;case 114:return this.texture114;case 115:return this.texture115;case 116:return this.texture116;case 117:return this.texture117;case 118:return this.texture118;case 119:return this.texture119;case 120:return this.texture120;case 121:return this.texture121;case 122:return this.texture122;case 123:return this.texture123;case 124:return this.texture124;case 125:return this.texture125;case 126:return this.texture126;case 127:return this.texture127;case 128:return this.texture128;case 129:return this.texture129;case 130:return this.texture130;case 131:return this.texture131;case 132:return this.texture132;case 133:return this.texture133;case 134:return this.texture134;case 135:return this.texture135;case 136:return this.texture136;case 137:return this.texture137;case 138:return this.texture138;case 139:return this.texture139;case 140:return this.texture140;case 141:return this.texture141;case 142:return this.texture142;case 143:return this.texture143;case 144:return this.texture144;case 145:return this.texture145;case 146:return this.texture146;case 147:return this.texture147;case 148:return this.texture148;case 149:return this.texture149;case 150:return this.texture150;case 151:return this.texture151;case 152:return this.texture152;case 153:return this.texture153;case 154:return this.texture154;case 155:return this.texture155;case 156:return this.texture156;case 157:return this.texture157;case 158:return this.texture158;case 159:return this.texture159;case 160:return this.texture160;case 161:return this.texture161;case 162:return this.texture162;case 163:return this.texture163;case 165:return this.texture165;case 166:return this.texture166;case 167:return this.texture167;case 168:return this.texture168;case 169:return this.texture169;case 170:return this.texture170;case 171:return this.texture171;case 172:return this.texture172;case 173:return this.texture173;case 174:return this.texture174;case 175:return this.texture175;case 176:return this.texture176;case 177:return this.texture177;case 178:return this.texture178;case 179:return this.texture179;case 180:return this.texture180;case 181:return this.texture181;case 182:return this.texture182;case 183:return this.texture183;case 184:return this.texture184;case 185:return this.texture185;case 186:return this.texture186;case 187:return this.texture187;case 188:return this.texture188;case 189:return this.texture189;case 190:return this.texture190;case 191:return this.texture191;case 192:return this.texture192;case 193:return this.texture193;case 194:return this.texture194;case 195:return this.texture195;case 196:return this.texture196;case 197:return this.texture197;case 198:return this.texture198;case 199:return this.texture199;case 200:return this.texture200;case 201:return this.texture201;case 202:return this.texture202;case 203:return this.texture203;case 204:return this.texture204;case 205:return this.texture205;case 206:return this.texture206;case 207:return this.texture207;case 208:return this.texture208;case 209:return this.texture209;case 210:return this.texture210;case 211:return this.texture211;case 212:return this.texture212;case 214:return this.texture214;case 215:return this.texture215;case 216:return this.texture216;case 217:return this.texture217;case 218:return this.texture218;case 219:return this.texture219;case 220:return this.texture220;case 221:return this.texture221;case 222:return this.texture222;case 223:return this.texture223;case 224:return this.texture224;case 225:return this.texture225;case 226:return this.texture226;case 227:return this.texture227;case 228:return this.texture228;case 229:return this.texture229;case 230:return this.texture230;case 231:return this.texture231;case 232:return this.texture232;case 233:return this.texture233;case 234:return this.texture234;case 235:return this.texture235;case 236:return this.texture236;case 237:return this.texture237;case 238:return this.texture238;case 239:return this.texture239;case 240:return this.texture240;case 241:return this.texture241;case 242:return this.texture242;case 243:return this.texture243;case 244:return this.texture244;case 245:return this.texture245;case 246:return this.texture246;case 247:return this.texture247;case 248:return this.texture248;case 249:return this.texture249;case 250:return this.texture250;case 251:return this.texture251;case 252:return this.texture252;case 253:return this.texture253;case 254:return this.texture254;case 255:return this.texture255;case 256:return this.texture256;case 257:return this.texture257;case 262:return this.texture262;case 263:return this.texture263;case 264:return this.texture264;case 265:return this.texture265;case 266:return this.texture266;case 267:return this.texture267;case 268:return this.texture268;case 269:return this.texture269;case 270:return this.texture270;case 271:return this.texture271;case 272:return this.texture272;case 273:return this.texture273;case 274:return this.texture274;case 275:return this.texture275;case 276:return this.texture276;case 277:return this.texture277;case 278:return this.texture278;case 279:return this.texture279;case 280:return this.texture280;case 281:return this.texture281;case 282:return this.texture282;case 283:return this.texture283;case 284:return this.texture284;case 285:return this.texture285;case 286:return this.texture286;case 287:return this.texture287;case 288:return this.texture288;case 289:return this.texture289;case 290:return this.texture290;case 291:return this.texture291;case 292:return this.texture292;case 293:return this.texture293;case 294:return this.texture294;case 295:return this.texture295;case 296:return this.texture296;case 297:return this.texture297;case 298:return this.texture298;case 299:return this.texture299;case 300:return this.texture300;case 301:return this.texture301;case 302:return this.texture302;case 303:return this.texture303;case 304:return this.texture304;case 305:return this.texture305;case 306:return this.texture306;case 500:return this.texture500;case 550:return this.texture550;case 551:return this.texture551;case 552:return this.texture552;case 553:return this.texture553;case 554:return this.texture554;case 555:return this.texture555;case 556:return this.texture556;case 557:return this.texture557;case 558:return this.texture558;case 560:return this.texture560;case 561:return this.texture561;case 562:return this.texture562;case 563:return this.texture563;case 564:return this.texture564;case 565:return this.texture565;case 566:return this.texture566;case 567:return this.texture567;case 568:return this.texture568;case 569:return this.texture569;case 570:return this.texture570;case 571:return this.texture571;case 572:return this.texture572;case 573:return this.texture573;case 574:return this.texture574;case 575:return this.texture575;case 576:return this.texture576;case 577:return this.texture577;case 578:return this.texture578;case 579:return this.texture579;case 580:return this.texture580;case 581:return this.texture581;case 582:return this.texture582;case 583:return this.texture583;case 584:return this.texture584;case 585:return this.texture585;case 586:return this.texture586;case 587:return this.texture587;case 588:return this.texture588;case 589:return this.texture589;case 590:return this.texture590;case 591:return this.texture591;case 592:return this.texture592;case 593:return this.texture593;case 594:return this.texture594;case 595:return this.texture595;case 596:return this.texture596;case 597:return this.texture597;case 598:return this.texture598;case 600:return this.texture600;case 601:return this.texture601;case 602:return this.texture602;case 603:return this.texture603;case 604:return this.texture604;case 605:return this.texture605;case 606:return this.texture606;case 607:return this.texture607}},e.instance=new e,e}();t.TextureMapper=n},function(e,t){"use strict";var i=function(){function e(){}return e.prototype.createIdentityMatrix=function(){return[1,0,0,0,1,0,0,0,1]},e.createProjectionMatrix=function(e,t){return[2/e,0,0,0,-2/t,0,-1,1,1]},e.createTranslationMatrix=function(e,t){return[1,0,0,0,1,0,e,t,1]},e.createRotationMatrix=function(e){var t=Math.cos(e),i=Math.sin(e);return[t,-i,0,i,t,0,0,0,1]},e.createScaleMatrix=function(e,t){return[e,0,0,0,t,0,0,0,1]},e.multiply=function(e,t){var i=e[0],r=e[1],n=e[2],s=e[3],a=e[4],o=e[5],h=e[6],c=e[7],l=e[8],u=t[0],p=t[1],d=t[2],g=t[3],f=t[4],x=t[5],y=t[6],m=t[7],v=t[8];return[i*u+r*g+n*y,i*p+r*f+n*m,i*d+r*x+n*v,s*u+a*g+o*y,s*p+a*f+o*m,s*d+a*x+o*v,h*u+c*g+l*y,h*p+c*f+l*m,h*d+c*x+l*v]},e.positionConvertion=function(e,t,i){return e=e*i[0]+t*i[3]+1*i[6],t=e*i[1]+t*i[4]+1*i[7],[e,t]},e}();t.Matrix3=i},function(e,t){"use strict";var i=function(){function e(){this.vertecies=[],this.indecies=[],this.textureCoords=[],this.matrices=[]}return e}();t.DynamicRenderCall=i},function(e,t,i){"use strict";var r=i(367),n=i(347),s=function(){function e(e,t){this.collisionDetection=r.CollisionDetection.getInstance(),this.context=e,this.particleHandler=t,this.gl=this.context.gl,this.gl.useProgram(this.shaderProgram),this.gl.bindAttribLocation(this.shaderProgram,0,"a_relativeTime"),this.gl.bindAttribLocation(this.shaderProgram,1,"a_lifetime"),this.gl.bindAttribLocation(this.shaderProgram,2,"a_startPosition"),this.gl.bindAttribLocation(this.shaderProgram,3,"a_endPosition"),this.relativeTimeAttribute=this.gl.getAttribLocation(this.shaderProgram,"a_relativeTime"),this.lifeTimeAttribute=this.gl.getAttribLocation(this.shaderProgram,"a_lifetime"),this.startPositionLocation=this.gl.getAttribLocation(this.shaderProgram,"a_startPosition"),this.endPositionLocation=this.gl.getAttribLocation(this.shaderProgram,"a_endPosition"),this.particleTexture=this.gl.getUniformLocation(this.shaderProgram,"u_particleTexture"),this.colorLocation=this.gl.getUniformLocation(this.shaderProgram,"u_color"),this.pointEndPositionsBuffer=this.gl.createBuffer(),this.pointStartPositionsBuffer=this.gl.createBuffer(),this.pointLifetimesBuffer=this.gl.createBuffer(),this.pointRelativeTimeBuffer=this.gl.createBuffer()}return e.prototype.render=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];r.length>0&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.pointRelativeTimeBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(r.relativeTime),this.gl.STATIC_DRAW),this.pointRelativeTimeBuffer.itemSize=1,this.pointRelativeTimeBuffer.numItems=r.length,this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.pointLifetimesBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(r.lifetimes),this.gl.STATIC_DRAW),this.pointLifetimesBuffer.itemSize=1,this.pointLifetimesBuffer.numItems=r.length,this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.pointStartPositionsBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(r.startPositions),this.gl.STATIC_DRAW),this.pointStartPositionsBuffer.itemSize=3,this.pointStartPositionsBuffer.numItems=r.length,this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.pointEndPositionsBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(r.endPositions),this.gl.STATIC_DRAW),this.pointEndPositionsBuffer.itemSize=3,this.pointEndPositionsBuffer.numItems=r.length,this.gl.enableVertexAttribArray(this.lifeTimeAttribute),this.gl.enableVertexAttribArray(this.relativeTimeAttribute),this.gl.enableVertexAttribArray(this.startPositionLocation),this.gl.enableVertexAttribArray(this.endPositionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.pointRelativeTimeBuffer),this.gl.vertexAttribPointer(this.relativeTimeAttribute,this.pointRelativeTimeBuffer.itemSize,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.pointLifetimesBuffer),this.gl.vertexAttribPointer(this.lifeTimeAttribute,this.pointLifetimesBuffer.itemSize,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.pointStartPositionsBuffer),this.gl.vertexAttribPointer(this.startPositionLocation,this.pointStartPositionsBuffer.itemSize,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.pointEndPositionsBuffer),this.gl.vertexAttribPointer(this.endPositionLocation,this.pointEndPositionsBuffer.itemSize,this.gl.FLOAT,!1,0,0),this.gl.activeTexture(this.gl.TEXTURE0),r.type==n.SpellType.frostBlast?this.gl.bindTexture(this.gl.TEXTURE_2D,this.context.frostParticelTexture):this.gl.bindTexture(this.gl.TEXTURE_2D,this.context.genericParticleTexture),this.gl.uniform1i(this.particleTexture,0),this.gl.uniform4f(this.colorLocation,r.color[0],r.color[1],r.color[2],r.color[3]),this.gl.drawArrays(this.gl.POINTS,0,this.pointLifetimesBuffer.numItems),this.gl.disableVertexAttribArray(this.lifeTimeAttribute),this.gl.disableVertexAttribArray(this.relativeTimeAttribute),this.gl.disableVertexAttribArray(this.startPositionLocation),this.gl.disableVertexAttribArray(this.endPositionLocation))}},e}();t.ParticleRenderer=s},function(e,t,i){"use strict";var r=i(347),n=i(368),s=function(){function e(){if(e.instance)throw new Error("Static class cant be instanced!");e.instance=this}return e.getInstance=function(){return e.instance},e.prototype.createGrid=function(e,t){this.gameSize=e,this.grid=new n.Grid(25,this.gameSize);for(var i=0,r=t;i<r.length;i++){var s=r[i];this.grid.insert(s)}},e.prototype.collisionDetection=function(e,t,i,r,n){var s=this.checkCollision(e,t,i,r,n);return s},e.prototype.fastCheckEnviroment=function(e,t){for(var i=!0,r=this.grid.get(e),n=0,s=r;n<s.length;n++){var a=s[n];this.aabbCheck(e,a)&&(i=!1)}return i},e.prototype.checkProjectileCollisionX=function(e,t,i,r,s){var a,o=this.getSweptBroadphaseBoxX(t.collisionArea,i);a=r?this.grid.get(o):e;for(var h=new n.CollisionData,c=0,l=a;c<l.length;c++){var u=l[c];this.aabbCheck(o,u)&&(h=this.aabbCollisionX(t.collisionArea,u,i,h))}if(s)for(var p=0,d=a;p<d.length;p++){var u=d[p];this.aabbCheck(t.collisionArea,u)&&(h.wallCollision=!0)}return h},e.prototype.checkProjectileCollisionY=function(e,t,i,r){var s,a=this.getSweptBroadphaseBoxY(t.collisionArea,i);s=r?this.grid.get(a):e;for(var o=new n.CollisionData,h=0,c=s;h<c.length;h++){var l=c[h];this.aabbCheck(a,l)&&(o=this.aabbCollisionY(t.collisionArea,l,i,o))}return o},e.prototype.checkCollision=function(e,t,i,s,a){for(var o=e,h=new n.CollisionData,c=new n.CollisionData,l=i.getCollisionArea(),u=this.getSweptBroadphaseBoxY(l,s),p=this.grid.get(u),d=0,g=t;d<g.length;d++){var f=g[d],x=new r.Vector(s.x-f.velocity.x*a,s.y-f.velocity.y*a);c=this.checkDynamicTileY(f,l,i,x,c,a)}for(var y=0,m=p;y<m.length;y++){var v=m[y];this.aabbCheck(u,v)&&(h=this.aabbCollisionY(l,v,s,h))}c.groundCollision&&(h=c,s.y=c.velocityY),i.position.y+=s.y*h.collisionTimeY,l=i.getCollisionArea(),u=this.getSweptBroadphaseBoxX(l,s);for(var w=0,R=t;w<R.length;w++){var f=R[w],x=new r.Vector(s.x-f.velocity.x*a,s.y-f.velocity.y*a);c=this.checkDynamicTileX(f,l,i,x,c,a)}for(var T=0,A=o;T<A.length;T++){var v=A[T];this.aabbCheck(u,v)&&(h=this.aabbCollisionX(i.getCollisionArea(),v,s,h))}return c.wallCollision&&(h.wallCollision=c.wallCollision,h.collisionTimeX=c.collisionTimeX,s.x=c.velocityX),i.position.x+=s.x*h.collisionTimeX,h.remainingTime=1-h.collisionTimeY,h},e.prototype.getClosestX=function(e,t,i){for(var r=i?0:this.gameSize.x,n=this.grid.get(e),s=0,a=n;s<a.length;s++){var o=a[s];if(this.aabbCheck(e,o))if(i){var h=o.x+o.width;h>r&&(r=h)}else{var h=o.x;h<r&&(r=h)}}return r},e.prototype.checkCoutOfBounds=function(e,t){var i=new r.Rectangle(0,0,t[0],t[1]);this.aabbCheck(e.getCollisionArea(),i)||(e.dead=!0)},e.prototype.aabbCheck=function(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.height+e.y>t.y},e.prototype.aabbCheckS=function(e,t){for(var i=0,r=t;i<r.length;i++){var n=r[i];if(e.x<n.x+n.width&&e.x+e.width>n.x&&e.y<n.y+n.height&&e.height+e.y>n.y)return!0}return!1},e.prototype.checkDynamicTileY=function(e,t,i,r,n,s){var a=this.getSweptBroadphaseBoxY(t,r);return this.aabbCheck(a,e.tile)&&(n=this.aabbCollisionY(t,e.tile,r,n),n.groundCollision&&(n.lift=e)),n},e.prototype.checkDynamicTileX=function(e,t,i,r,n,s){var a=this.getSweptBroadphaseBoxX(t,r);return this.aabbCheck(a,e.tile)&&(n=this.aabbCollisionX(t,e.tile,r,n)),n},e.prototype.getSweptBroadphaseBoxX=function(e,t){var i=e.x+t.x,n=e.y,s=e.width+Math.abs(t.x),a=e.height;return new r.Rectangle(i,n,s,a)},e.prototype.getSweptBroadphaseBoxY=function(e,t){var i=e.x,n=e.y+t.y,s=e.width,a=e.height+Math.abs(t.y);return new r.Rectangle(i,n,s,a)},e.prototype.aabbCollisionY=function(e,t,i,r){var n,s;i.y>0?(n=t.y-(e.y+e.height),s=t.y+t.height-e.y):(n=t.y+t.height-e.y,s=t.y-(e.y+e.height));var a,o;0==i.y?(a=-Number.MAX_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER):(a=n/i.y,o=s/i.y);var h=a,c=o;return h>c||a<0||a>1?r:(i.y<0?r.normalY=1:r.normalY=-1,r.collisionTimeY>h&&(r.collisionTimeY=h,r.velocityY=i.y),i.y>20&&(r.fallDeath=!0),r.groundCollision=!0,r)},e.prototype.aabbCollisionX=function(e,t,i,r){var n,s;i.x>0?(n=t.x-(e.x+e.width),s=t.x+t.width-e.x):(n=t.x+t.width-e.x,s=t.x-(e.x+e.width));var a,o;0==i.x?(a=-Number.MAX_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER):(a=n/i.x,o=s/i.x);var h=a,c=o;return h>c||a<0||a>1?r:(n<0?r.normalX=1:r.normalX=-1,r.collisionTimeX>h&&(r.collisionTimeX=h,r.velocityX=i.x),r.wallCollision=!0,r)},e.instance=new e,e}();t.CollisionDetection=s},function(e,t,i){"use strict";var r=i(369);t.CollisionData=r.CollisionData;var n=i(367);t.CollisionDetection=n.CollisionDetection;var s=i(370);t.Grid=s.Grid},function(e,t){"use strict";var i=function(){function e(){this.normalX=0,this.normalY=0,this.collisionTimeY=1,this.collisionTimeX=1,this.remainingTime=0,this.wallCollision=!1,this.groundCollision=!1,this.lift=null,this.fallDeath=!1}return e}();t.CollisionData=i},function(e,t){"use strict";var i=function(){function e(e,t){this.grid=[],this.gridSize=e,this.maxX=t.x/this.gridSize,this.maxY=t.y/this.gridSize;for(var i=0;i<this.maxX;i++){this.grid[i]=[];for(var r=0;r<this.maxY;r++)this.grid[i][r]=[]}}return e.prototype.insert=function(e){for(var t=this.getGridCoordinates(e),i=0;i<t[2];i++)for(var r=0;r<t[3];r++)this.grid[t[0]+i][t[1]+r].push(e)},e.prototype.get=function(e){for(var t=[],i=this.getGridCoordinates(e),r=0;r<i[2];r++)for(var n=0;n<i[3];n++)t.push.apply(t,this.grid[i[0]+r][i[1]+n]);return t},e.prototype.getGridCoordinates=function(e){var t=Math.floor(e.x/this.gridSize),i=Math.floor(e.y/this.gridSize),r=Math.ceil(e.width/this.gridSize)+1,n=Math.ceil(e.height/this.gridSize)+1;return t<0&&(t=0),i<0&&(i=0),t+r>this.maxX&&(r=this.maxX-t),i+n>this.maxY&&(n=this.maxY-i),[t,i,r,n]},e}();t.Grid=i},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(347),s=function(e){function t(t,i,r,n,s,a){e.call(this,a),this.offsetY=20,this.offsetX=10,this.particleFunction=s,this.growthX=t,this.growthY=i,this.offsetX=r,this.offsetY=n,this.lastFrameIndex=this.frameIndex}return r(t,e),t.prototype.next=function(t){this.lastFrameIndex!=this.frameIndex&&(this.lastFrameIndex=this.frameIndex,this.offsetX+=this.growthX,this.offsetY+=this.growthY),this.particleFunction(new n.Vector(this.areaToRender.x+this.offsetX,this.areaToRender.y-this.offsetY)),e.prototype.next.call(this,t)},t}(n.Animation);t.FrameAnimation=s},function(e,t){"use strict";!function(e){e[e.fireball=1]="fireball",e[e.electricbolt=2]="electricbolt",e[e.frostBlast=3]="frostBlast",e[e.fireBlast=4]="fireBlast",e[e.shield=5]="shield",e[e.channelmagic=6]="channelmagic"}(t.SpellType||(t.SpellType={}));t.SpellType},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(347),s=function(e){function t(t,i,r,n,s,a){e.call(this,t,i,r,n),this.distance=s,this.type=a}return r(t,e),t.prototype.update=function(t,i,r){e.prototype.update.call(this,t,i,r),this.distance-=Math.abs(t)},t}(n.Projectile);t.Spell=s},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(347),s=i(375),a=i(376),o=function(e){function t(t,i,r,n,o,h){e.call(this,t,i,r,n,o),this.gravityStrength=.0025,this.gravity=new s.Gravity(this.gravityStrength),this.dragStrength=5e-4,this.drag=new a.Drag(this.dragStrength),this.angle=h}return r(t,e),t.prototype.update=function(t,i,r){e.prototype.update.call(this,t,i,r)},t.prototype.updateForces=function(e){this.gravity.apply(this.velocity,e),this.drag.apply(this.velocity,e)},t.prototype.onGroundCollision=function(){this.animation instanceof n.StaticRotationAnimation&&(this.animation.inverse?this.animation.angle=0:this.animation.angle=2*Math.PI),this.extendedOnGroundCollision&&this.extendedOnGroundCollision()},t}(n.Projectile);t.PhysicalProjectile=o},function(e,t){"use strict";var i=function(){function e(e){this.strength=0,this.strength=e}return e.prototype.apply=function(e,t){e.y+=this.strength*t},e}();t.Gravity=i},function(e,t){"use strict";var i=function(){function e(e){this.strength=0,this.strength=e}return e.prototype.apply=function(e,t){var i=t*this.strength;e.x>0?(e.x-=i,e.x<i&&(e.x=0)):e.x<0&&(e.x+=i,e.x>i&&(e.x=0))},e}();t.Drag=i},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(347),s=function(e){function t(t,i,r,n){e.call(this,t,i,r,n)}return r(t,e),t.prototype.update=function(t,i,r){e.prototype.update.call(this,t,i,r)},t}(n.Projectile);t.Meele=s},function(e,t){"use strict";var i=function(){function e(e,t){this.area=e,this.inverse=t}return e}();t.DebugElement=i},function(e,t){"use strict";!function(e){e[e.tileTexture=1]="tileTexture",e[e.particleTexture=2]="particleTexture",e[e.frostTexture=3]="frostTexture"}(t.TextureType||(t.TextureType={}));t.TextureType},function(e,t){"use strict";var i=function(){function e(e,t){this.animation=e,this.offset=t}return e}();t.StickyAnimation=i},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(347),s=function(e){function t(t,i){e.call(this,i),this.vec=t}return r(t,e),t.prototype.next=function(t){this.angle=Math.atan2(this.vec.x,this.vec.y),this.inverse?this.angle=this.angle+.5*Math.PI:this.angle=this.angle+1.5*Math.PI,e.prototype.next.call(this,t)},t}(n.Animation);t.RotationAnimation=s},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(347),s=function(e){function t(t,i,r){e.call(this,r),this.vec=t,this.inverse=i,this.angle=Math.atan2(this.vec.x,this.vec.y),this.inverse?this.angle=this.angle+.5*Math.PI:this.angle=this.angle+1.5*Math.PI}return r(t,e),t.prototype.next=function(t){e.prototype.next.call(this,t)},t}(n.Animation);t.StaticRotationAnimation=s},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(347),s=function(e){function t(t,i,r,n,s){e.call(this,t,i,n,1),this.damage=s,this.distance=r}return r(t,e),t.prototype.update=function(t,i,r){e.prototype.update.call(this,t,i,r),this.distance-=Math.abs(t)},t}(n.Projectile);t.CollisionProjectile=s},function(e,t){"use strict";!function(e){e[e.None=0]="None",e[e.Arrow=1]="Arrow",e[e.Sword=2]="Sword",e[e.NecroBall=3]="NecroBall"}(t.ProjectileType||(t.ProjectileType={}));t.ProjectileType},function(e,t){"use strict";var i=function(){function e(){this.done=!1}return e.prototype.update=function(e){},e.prototype.cancel=function(){},e.prototype.reset=function(){this.done=!1},e}();t.Cast=i},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(347),s=function(e){function t(t,i){e.call(this),this.currentAnimation=t,this.onCast=i}return r(t,e),t.prototype.update=function(e){this.currentAnimation=this.onCast(this.currentAnimation),this.currentAnimation.next(e),this.currentAnimation.repetitions<=0&&(this.done=!0)},t.prototype.reset=function(){this.currentAnimation.reset(),this.currentAnimation.repetitions=1,e.prototype.reset.call(this)},t}(n.Cast);t.InstantCast=s},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(347),s=function(e){function t(t,i,r,n,s,a,o){e.call(this),this.channeling=!1,this.onChannel=r,this.onCancel=n,this.currentAnimation=t,this.lowerCurrentAnimation=i,this.defaultValue=s,this.maxValue=a,this.growth=o,this.currentValue=this.defaultValue}return r(t,e),t.prototype.update=function(e){this.channeling&&(this.delay=150),this.delay>0?(this.currentAnimation.next(e),this.currentValue>=this.maxValue?this.currentValue=this.maxValue:this.currentValue+=e*this.growth,this.onChannel()):this.done=!0,this.delay-=e,this.channeling=!1},t.prototype.resetValue=function(){this.currentValue=this.defaultValue},t.prototype.cancel=function(){this.onCancel()},t.prototype.reset=function(){},t}(n.Cast);t.ChannelCast=s},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(347),s=function(e){function t(t,i,r){e.call(this),this.size=20,this.currentAnimation=t,this.onCast=r,this.mainRepetion=i,this.hasCast=!1}return r(t,e),t.prototype.update=function(e){this.currentAnimation.repetitions!=this.mainRepetion||this.hasCast||(this.currentAnimation=this.onCast(this.currentAnimation,this.size),this.hasCast=!0),this.currentAnimation.next(e),this.currentAnimation.repetitions<=0&&(this.done=!0)},t.prototype.reset=function(){this.hasCast=!1,this.currentAnimation.repetitions=4,this.currentAnimation.reset(),e.prototype.reset.call(this)},t}(n.Cast);t.SpellCast=s},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(347),s=function(e){function t(t,i,r,n,s,a,o,h,c){e.call(this,t,i,r,n,c),this.onUpdate=h,this.distance=s,this.inverse=a,this.offset=o}return r(t,e),t.prototype.update=function(t,i,r){e.prototype.update.call(this,t,i,r),this.onUpdate(this.area,this.inverse,this.offset),this.distance-=Math.abs(t)},t}(n.Projectile);t.ParticleProjectile=s},function(e,t,i){"use strict";var r=i(357),n=i(391),s=i(347),a=function(){function e(e,t,i,a){this.inverse=!1,this.distance=0,this.renderHelper=r.RenderHelper.getInstance(),this.constants=n.Constants.getInstance(),this.tile=e,this.velocity=t,this.verticalAxis=i,this.maxDistance=a,this.velocity.y>0?this.initialDown=!0:this.initialDown=!1,this.velocity.x>0?this.initialRight=!0:this.initialRight=!1,this.textureCoordinates=this.renderHelper.getTiledTextureCoordinates(this.tile,[],this.constants.tileSize),this.initialPosition=new s.Vector(e.x,e.y)}return e.prototype.update=function(e,t){this.verticalAxis?this.calculateVerticalMovement(e,t):this.calculateHorizontalMovement(e,t)},e.prototype.calculateVerticalMovement=function(e,t){this.distance+=Math.abs(t),this.distance>=this.maxDistance?(this.distance=this.maxDistance,this.inverse?this.tile.y=this.initialPosition.y:this.initialDown?this.tile.y=this.initialPosition.y+this.maxDistance:this.tile.y=this.initialPosition.y-this.maxDistance,this.turn()):this.tile.y+=t},e.prototype.calculateHorizontalMovement=function(e,t){this.distance+=Math.abs(t),this.distance>=this.maxDistance?(this.distance=this.maxDistance,this.inverse?this.tile.x=this.initialPosition.x:this.initialRight?this.tile.x=this.initialPosition.x+this.maxDistance:this.tile.x=this.initialPosition.x-this.maxDistance,this.turn()):this.tile.x+=t},e.prototype.turn=function(){this.distance=0,this.inverse=!this.inverse,this.velocity.invert()},e}();t.DynamicTile=a},function(e,t,i){"use strict";var r=i(392),n=function(){function e(){this.tileResources=[new r.TextureResource("1tile.png",[32,32]),new r.TextureResource("2tile.png",[32,32]),new r.TextureResource("3tile.png",[32,32]),new r.TextureResource("4tile.png",[32,32]),new r.TextureResource("5tile.png",[32,32]),new r.TextureResource("6tile.png",[32,32]),new r.TextureResource("7tile.png",[32,32]),new r.TextureResource("8tile.png",[32,32]),new r.TextureResource("9tile.png",[32,32]),new r.TextureResource("10tile.png",[32,32]),new r.TextureResource("11tile.png",[32,32]),new r.TextureResource("12tile.png",[32,32]),new r.TextureResource("13tile.png",[32,32]),new r.TextureResource("14tile.png",[32,32]),new r.TextureResource("15tile.png",[32,32]),new r.TextureResource("16tile.png",[32,32]),new r.TextureResource("17tile.png",[32,32]),new r.TextureResource("18tile.png",[32,32]),new r.TextureResource("19tile.png",[32,32]),new r.TextureResource("20tile.png",[32,32]),new r.TextureResource("21tile.png",[32,32]),new r.TextureResource("22tile.png",[32,32]),new r.TextureResource("23tile.png",[32,32]),new r.TextureResource("24tile.png",[32,32]),new r.TextureResource("25tile.png",[32,32]),new r.TextureResource("26tile.png",[32,32])],
this.uiResources=[new r.TextureResource("100ui.png",[256,128]),new r.TextureResource("101ui.png",[512,512]),new r.TextureResource("102ui.png",[256,256]),new r.TextureResource("103ui.png",[256,256]),new r.TextureResource("104ui.png",[256,256]),new r.TextureResource("105ui.png",[256,256]),new r.TextureResource("106ui.png",[256,256]),new r.TextureResource("107ui.png",[256,256]),new r.TextureResource("108ui.png",[256,256]),new r.TextureResource("109ui.png",[256,256]),new r.TextureResource("110ui.png",[256,256]),new r.TextureResource("111ui.png",[256,256]),new r.TextureResource("112ui.png",[256,256]),new r.TextureResource("113ui.png",[256,256]),new r.TextureResource("114ui.png",[256,256]),new r.TextureResource("115ui.png",[256,256]),new r.TextureResource("116ui.png",[256,256]),new r.TextureResource("117ui.png",[256,256]),new r.TextureResource("118ui.png",[256,256]),new r.TextureResource("119ui.png",[256,256]),new r.TextureResource("120ui.png",[256,256]),new r.TextureResource("121ui.png",[256,256])],this.tileSize=[32,32]}return e.prototype.constrcuctor=function(){if(e.instance)throw new Error("Static class cant be instanced!");e.instance=this},e.getInstance=function(){return e.instance},e.instance=new e,e}();t.Constants=n},function(e,t,i){"use strict";var r=i(393);t.EnemyData=r.EnemyData;var n=i(394);t.LevelData=n.LevelData;var s=i(395);t.EnemyType=s.EnemyType;var a=i(396);t.TextureResource=a.TextureResource;var o=i(397);t.TileAsset=o.TileAsset},function(e,t){"use strict";var i=function(){function e(){}return e}();t.EnemyData=i},function(e,t){"use strict";var i=function(){function e(){}return e}();t.LevelData=i},function(e,t){"use strict";!function(e){e[e.swordman=1]="swordman"}(t.EnemyType||(t.EnemyType={}));t.EnemyType},function(e,t){"use strict";var i=function(){function e(e,t){this.name=e,this.size=t}return e}();t.TextureResource=i},function(e,t){"use strict";var i=function(){function e(e,t,i){this.key=e,this.image=t,this.size=i}return e}();t.TileAsset=i},function(e,t){"use strict";var i=function(){function e(){}return e}();t.DynamicTileData=i},function(e,t){"use strict";var i=function(){function e(){}return e}();t.RenderableData=i},function(e,t){"use strict";var i=function(){function e(){this.active=!1}return e}();t.Progress=i},function(e,t,i){"use strict";var r=i(402);t.Enemy=r.Enemy;var n=i(405);t.Swordman=n.Swordman;var s=i(407);t.Archer=s.Archer;var a=i(403);t.Character=a.Character;var o=i(409);t.Player=o.Player;var h=i(411);t.Shadow=h.Shadow;var c=i(406);t.State=c.State;var l=i(412);t.Apprentice=l.Apprentice;var u=i(413);t.Screamer=u.Screamer;var p=i(414);t.MasterSorcerer=p.MasterSorcerer;var d=i(415);t.IEnemy=d.IEnemy},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(347),s=i(403),a=i(401),o=i(367),h=i(404),c=function(e){function t(t,i,r){e.call(this,t,i,r),this.color=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],this.burnValue=0,this.direction=!0,this.oldDirection=!0,this.collisionDetection=o.CollisionDetection.getInstance(),this.hitDamage=0,this.hp=100,this.freezeDamage=.08,this.flameDamage=.12,this.maxFreeze=this.hp/this.freezeDamage,this.freezeValue=0,this.burnDamage=.2,this.cinderValue=0,this.burnDurationFactor=3,this.hitAreaOffset=40,this.minDistance=5,this.searchAreaOffset=150,this.trackingTime=0,this.trackingMaxTime=3e3,this.trackingSpeed=0,this.idleSpeed=0,this.hitting=!1,this.currentState=a.State.Idle}return r(t,e),t.prototype.takeDamage=function(e,t){this.hp=this.hp-e,this.hp<=0&&(t==n.SpellType.frostBlast?this.deathType=h.DeathType.freezeDeath:t==n.SpellType.fireBlast?this.deathType=h.DeathType.fireDeath:this.deathType=h.DeathType.swordDeath,this.dead=!0)},t.prototype.burn=function(){this.cinderValue+=this.burnDurationFactor,this.takeDamage(this.flameDamage,n.SpellType.fireBlast),this.cinderValue>300&&(this.burnValue+=this.burnDurationFactor)},t.prototype.setFreezeSpeed=function(){this.actualSpeed=this.maxSpeed*Math.pow(.997,this.freezeValue),this.actualSpeed<.3*this.maxSpeed&&(this.actualSpeed=.3*this.maxSpeed)},t.prototype.freeze=function(){this.freezeValue++,this.actualSpeed>.3*this.maxSpeed&&(this.actualSpeed=.997*this.actualSpeed),this.takeDamage(this.freezeDamage,n.SpellType.frostBlast)},t.prototype.update=function(e,t,i){this.toMove.x=this.velocity.x*e,this.toMove.y=this.velocity.y*e,this.nextToEdge=!1,this.actualSpeed<this.maxSpeed&&(this.actualSpeed=1.005*this.actualSpeed),this.collisionData=this.collisionDetection.collisionDetection(t,[],this,this.toMove,e),this.fall(e);var r=this.getCollisionArea(),s=this.collisionDetection.fastCheckEnviroment(new n.Rectangle(r.x,r.y+r.height,1,30),t),a=this.collisionDetection.fastCheckEnviroment(new n.Rectangle(r.x+r.width,r.y+r.height,1,30),t);s&&a?this.nextToEdge=!0:this.inverse?s&&(this.direction=!1,this.nextToEdge=!0):a&&(this.direction=!0,this.nextToEdge=!0),this.collisionData.groundCollision&&(this.velocity.y=0),this.collisionData.wallCollision&&(1==this.collisionData.normalX?(this.nextToEdge=!0,this.direction=!this.direction):(this.nextToEdge=!0,this.direction=!this.direction),this.velocity.x=0);var o=this.freezeValue/this.maxFreeze;this.updateColor([1+1*o,1+2*o,1+2*o,1]),this.updateBurnDamage()},t.prototype.getCollisionArea=function(){var e=new n.Rectangle(0,0,0,0);return e},t.prototype.idle=function(e,t,i){this.currentAnimation=this.idleAnimation,this.maxSpeed=this.idleSpeed,this.inRange(t,this.searchAreaOffset,i)&&(this.currentState=a.State.IdleToTrackingTransition)},t.prototype.idleToTrackingTransition=function(e){},t.prototype.trackingToInRangeTransition=function(e){},t.prototype.trackingToIdleTransition=function(e){},t.prototype.patrol=function(e){this.oldDirection!=this.direction&&(this.oldDirection=this.direction),this.oldDirection?this.moveLeft(e):this.moveRight(e)},t.prototype.hit=function(e,t,i){this.currentAnimation=this.hitAnimation,this.inRange(t,this.hitAreaOffset,i)||0!=this.hitAnimation.frameIndex||(this.currentState=a.State.Tracking),this.moveToPlayer(e,t,i,10)},t.prototype.npcAction=function(e,t,i){switch(this.currentState){case a.State.Idle:this.idle(e,t,i);break;case a.State.IdleToTrackingTransition:this.idleToTrackingTransition(e);break;case a.State.TrackingToIdleTransition:this.trackingToIdleTransition(e);break;case a.State.Tracking:this.track(t,e,i,10);break;case a.State.TrackingToInRangeTransition:this.trackingToInRangeTransition(e);break;case a.State.InHitRange:this.hit(e,t,i)}},t.prototype.checkStop=function(e,t){(this.nextToEdge||this.inRange(e,this.minDistance,t))&&this.stop()},t.prototype.stop=function(){this.velocity.x=0},t.prototype.track=function(e,t,i,r){this.currentAnimation=this.trackingAnimation,this.maxSpeed=this.trackingSpeed,this.trackingTime-=t,this.trackingTime<=0&&(this.currentState=a.State.TrackingToIdleTransition),this.inRange(e,this.searchAreaOffset,i)&&(this.trackingTime=this.trackingMaxTime),this.inRange(e,this.hitAreaOffset,i)&&(this.currentState=a.State.TrackingToInRangeTransition),this.moveToPlayer(t,e,i,r)},t.prototype.moveToPlayer=function(e,t,i,r){Math.abs(t.position.x-this.position.x)>r&&(t.position.x<this.position.x?(this.moveLeft(e),this.checkStop(t,i)):t.position.x>this.position.x&&(this.moveRight(e),this.checkStop(t,i)))},t.prototype.inRange=function(e,t,i){},t.prototype.rand=function(e,t){return e+Math.random()*(t-e)},t.prototype.getDeltaPosition=function(e,t,i){return new n.Vector(e.middlePosition.x-t-this.position.x,e.middlePosition.y-i-this.position.y)},t.prototype.updateBurnDamage=function(){this.burnValue>0&&(this.takeDamage(this.burnDamage,n.SpellType.fireBlast),this.burnValue--)},t.prototype.updateColor=function(e){for(var t=[],i=0;i<6;i++)t.push.apply(t,e);this.color=t},t}(s.Character);t.Enemy=c},function(e,t,i){"use strict";var r=i(347),n=i(375),s=function(){function e(e,t,i){this.toMove=new r.Vector(0,0),this.dead=!1,this.inverse=!1,this.velocity=new r.Vector(0,0),this.maxSpeed=.3,this.actualSpeed=.3,this.acceleration=.009,this.moving=!1,this.gravityStrength=.0025,this.gravity=new n.Gravity(this.gravityStrength),this.position=e,this.width=t,this.height=i}return e.prototype.moveRight=function(e){this.velocity.x<this.actualSpeed&&(this.velocity.x+=this.acceleration*e),this.velocity.x>this.actualSpeed&&(this.velocity.x=this.actualSpeed),this.inverse=!1,this.moving=!0},e.prototype.moveLeft=function(e){this.velocity.x>-this.actualSpeed&&(this.velocity.x-=this.acceleration*e),this.velocity.x<this.actualSpeed&&(this.velocity.x=-this.actualSpeed),this.inverse=!0,this.moving=!0},e.prototype.fall=function(e){this.gravity.apply(this.velocity,e)},e.prototype.getCollisionArea=function(){var e=new r.Rectangle(this.position.x,this.position.y,this.width,this.height);return e},e}();t.Character=s},function(e,t){"use strict";!function(e){e[e.fallDeath=0]="fallDeath",e[e.swordDeath=1]="swordDeath",e[e.freezeDeath=2]="freezeDeath",e[e.fireDeath=3]="fireDeath"}(t.DeathType||(t.DeathType={}));t.DeathType},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(402),s=i(347),a=i(363),o=i(406),h=function(e){function t(t,i,r,n,o){e.call(this,t,i,r),this.hitCollisionAreas=[],this.textureMapper=a.TextureMapper.getInstance(),this.hitOffset=40,this.hitting=!1,this.trackingSpeed=.2,this.idleSpeed=.1,this.minDistance=5,this.projectileHandler=n,this.animationHandler=o,this.maxSpeed=.1,this.actualSpeed=this.maxSpeed,this.idleAnimation=new s.Animation([228,227,229,227]),this.idleAnimation.timeToChange=150,this.hitAnimation=new s.Animation([231,231,232,230,212]),this.trackingAnimation=new s.Animation([211,209,211,210])}return r(t,e),t.prototype.takeDamage=function(t,i){e.prototype.takeDamage.call(this,t,i)},t.prototype.update=function(t,i,r){this.npcAction(t,r,i),e.prototype.update.call(this,t,i,r),this.currentAnimation==this.hitAnimation?this.currentAnimation.next(t):(0!=this.velocity.x||this.collisionData.wallCollision)&&this.currentAnimation.next(t),this.setHitAnimation(),this.checkHitCollisionAreas(r)},t.prototype.checkHitCollisionAreas=function(e){this.hitAnimation&&(1!=this.hitAnimation.frameIndex||this.hitting||(this.hitting=!0,this.projectileHandler.createCollisionProjectile(this.position,this.width,this.inverse,30,new s.Vector(.5,.6))),0==this.hitAnimation.frameIndex&&(this.hitting=!1))},t.prototype.idle=function(t,i,r){e.prototype.idle.call(this,t,i,r),this.patrol(t)},t.prototype.idleToTrackingTransition=function(e){this.currentState=o.State.Tracking,this.maxSpeed=this.trackingSpeed,this.actualSpeed=this.maxSpeed},t.prototype.trackingToInRangeTransition=function(e){this.currentState=o.State.InHitRange},t.prototype.trackingToIdleTransition=function(e){this.maxSpeed=this.idleSpeed,this.actualSpeed=this.maxSpeed,this.currentState=o.State.Idle},t.prototype.inRange=function(e,t){var i;return i=this.inverse?new s.Rectangle(this.position.x-t,this.position.y,t,this.height):new s.Rectangle(this.position.x,this.position.y,t+this.width,this.height),this.collisionDetection.aabbCheck(i,e.getCollisionArea())},t.prototype.hit=function(t,i,r){e.prototype.hit.call(this,t,i,r),this.meeleAnimation?this.meeleAnimation.repetitions<=0&&this.createHit(i):this.createHit(i)},t.prototype.createHit=function(e){this.inverse?this.meeleAnimation=this.animationHandler.swordscut_a(new s.Vector(this.position.x-this.hitOffset,this.position.y),50,!this.inverse):this.meeleAnimation=this.animationHandler.swordscut_a(new s.Vector(this.position.x+this.hitOffset,this.position.y),50,!this.inverse)},t.prototype.setHitAnimation=function(){this.meeleAnimation&&(this.inverse?(this.meeleAnimation.areaToRender.x=this.position.x-this.hitOffset,this.meeleAnimation.areaToRender.y=this.position.y):(this.meeleAnimation.areaToRender.x=this.position.x+this.hitOffset,this.meeleAnimation.areaToRender.y=this.position.y))},t.prototype.getCollisionArea=function(){var e=new s.Rectangle(this.position.x+10,this.position.y,this.width-20,55);return e},t}(n.Enemy);t.Swordman=h},function(e,t){"use strict";!function(e){e[e.Idle=0]="Idle",e[e.IdleToTrackingTransition=1]="IdleToTrackingTransition",e[e.TrackingToIdleTransition=2]="TrackingToIdleTransition",e[e.Tracking=3]="Tracking",e[e.TrackingToInRangeTransition=4]="TrackingToInRangeTransition",e[e.InHitRange=5]="InHitRange"}(t.State||(t.State={}));t.State},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(402),s=i(347),a=i(363),o=i(408),h=i(401),c=function(e){function t(t,i,r,n,h){e.call(this,t,i,r),this.textureMapper=a.TextureMapper.getInstance(),this.hitAreaOffset=600,this.searchAreaOffset=800,this.hp=50,this.arrowVelocity=.5,this.shoot=!1,this.debugHandler=o.DebugHandler.getInstance(),this.projectileHandler=n,this.animationHandler=h,this.maxSpeed=.1,this.actualSpeed=this.maxSpeed,this.idleAnimation=new s.Animation([267,266,267,265]),this.hitAnimation=new s.Animation([262,264,263,264]),this.trackingAnimation=new s.Animation([267,266,267,265]),this.trackingAnimation.timeToChange=175,this.hitAnimation.timeToChange=300,this.currentAnimation=this.hitAnimation,this.idleAnimation.timeToChange=175}return r(t,e),t.prototype.update=function(t,i,r){this.npcAction(t,r,i),e.prototype.update.call(this,t,i,r),this.currentAnimation.next(t)},t.prototype.getCollisionArea=function(){var e=new s.Rectangle(this.position.x+10,this.position.y-5,this.width-20,55);return e},t.prototype.idle=function(t,i,r){e.prototype.idle.call(this,t,i,r),this.patrol(t)},t.prototype.hit=function(t,i,r){if(e.prototype.hit.call(this,t,i,r),3==this.hitAnimation.frameIndex){if(!this.shoot){this.shoot=!0;var n=this.calculatePath(i,this.inverse),a=new s.Vector(this.position.x,this.position.y+20);this.projectileHandler.createArrow(a,this.inverse,n)}}else this.shoot=!1},t.prototype.idleToTrackingTransition=function(e){this.currentState=h.State.Tracking},t.prototype.trackingToInRangeTransition=function(e){this.currentState=h.State.InHitRange},t.prototype.trackingToIdleTransition=function(e){this.currentState=h.State.Idle},t.prototype.inRange=function(e,t,i){var r=this.getDeltaPosition(e,10,0),n=r.magnitude();return n<this.searchAreaOffset&&!!this.clearShoot(r,i)},t.prototype.clearShoot=function(e,t){for(var i=!0,r=this.getPathBlocks(e),n=0,s=r;n<s.length;n++){var a=s[n];if(!this.collisionDetection.fastCheckEnviroment(a,t)){i=!1;break}}return i},t.prototype.getPathBlocks=function(e){var t=20,i=e.magnitude(),r=e.copy(e),n=new s.Vector(this.position.x,this.position.y+10);r.normalize();for(var a=[],o=0;o<Math.floor(i/t);o++){var h=i-o*t;a.push(new s.Rectangle(n.x+r.x*h,n.y+r.y*h,t,17))}return a},t.prototype.getDeltaVelocity=function(e,t){var i=e.getVelocity(),r=i.x*i.x*800;return t.x<0?i.x>0?-r:r:i.x>0?r:-r},t.prototype.calculatePath=function(e,t){var i=this.getDeltaPosition(e,10,0);i.y=i.y-(i.x*i.x*63e-5+this.getDeltaVelocity(e,i));var r=new s.Vector(i.x,i.y*this.rand(.85,1.15));return r.normalize(),r.multiply(this.arrowVelocity),r},t}(n.Enemy);t.Archer=c},function(e,t,i){"use strict";var r=i(362),n=function(){function e(){if(this.debugRects=[],this.renderHelper=r.RenderHelper.getInstance(),e.instance)throw new Error("Static class cant be instanced!");e.instance=this}return e.getInstance=function(){return e.instance},e.prototype.createRenderCall=function(e){for(var t=0,i=this.debugRects;t<i.length;t++){var r=i[t];e.vertecies=this.renderHelper.getVertecies(r.x,r.y,r.width,r.height,e.vertecies),e.textureCoords=this.renderHelper.getTextureCoordinates(e.textureCoords,1),e.indecies=this.renderHelper.getIndecies(e.indecies)}return e},e.instance=new e,e}();t.DebugHandler=n},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(347),s=i(357),a=i(367),o=i(410),h=i(376),c=i(403),l=i(404),u=i(408),p=function(e){function t(t,i,r,c,l,p,d,g,f,x,y,m,v){e.call(this,t,p,d),this.defaultJumpSpeed=-.7,this.jumpSpeed=this.defaultJumpSpeed,this.damageAnimations=[],this.stunned=!1,this.lift=null,this.liftVelocity=new n.Vector(0,0),this.middlePosition=new n.Vector(0,0),this.collisionDetection=a.CollisionDetection.getInstance(),this.drag=.0015,this.externalDragForce=5e-4,this.dragForce=new h.Drag(this.drag),this.externalDrag=new h.Drag(this.externalDragForce),this.idleTime=3e3,this.idleTimeChange=3e3,this.jumping=!1,this.inJump=!1,this.renderHelper=s.RenderHelper.getInstance(),this.manaRegen=1,this.externalVelocity=new n.Vector(0,0),this.onGroundTimer=0,this.shieldTextureCoords=this.renderHelper.getTextureCoordinates([],199),this.debugHandler=u.DebugHandler.getInstance(),this.context=i,this.projectileHandler=r,this.animationHandler=c,this.particleHandler=l,this.spellHandler=new o.SpellHandler(this.animationHandler,this.projectileHandler,this.particleHandler,this,y,m,v),this.lowerIdleAnimation=new n.Animation([162]),this.upperIdleAnimation=new n.Animation([163]),this.upperRunningAnimation=new n.Animation([170,171,172,170,173,174]),this.upperRunningAnimation.timeToChange=150,this.lowerRunningAnimation=new n.Animation([165,166,167,165,168,169]),this.lowerRunningAnimation.timeToChange=150,this.stunnedAnimation=new n.Animation([60,61,62,63]),this.stunnedAnimation.timeToChange=200,this.lowerJumpAnimation=new n.Animation([160]),this.upperJumpAnimation=new n.Animation([161]),this.lowerStillAnimation=new n.Animation([165]),this.upperStillAnimation=new n.Animation([170]),this.hp=g,this.mana=f,this.maxMana=this.mana,this.lowerAnimation=this.lowerIdleAnimation,this.upperAnimation=this.upperIdleAnimation}return r(t,e),t.prototype.takeDamage=function(e){this.hp-=e,this.hp<=0&&(this.hp=0,this.deathType=l.DeathType.swordDeath)},t.prototype.hardHit=function(e,t){this.stun(),this.velocity.x=0,e?this.externalVelocity.x+=t:this.externalVelocity.x-=t},t.prototype.useMana=function(e){return!(this.mana-e<=0)&&(this.mana-=e,!0)},t.prototype.regenMana=function(){this.mana+=this.manaRegen,this.mana>this.maxMana&&(this.mana=this.maxMana)},t.prototype.getVelocity=function(){return new n.Vector(this.velocity.x+this.externalVelocity.x+this.liftVelocity.x,this.velocity.y+this.externalVelocity.y+this.liftVelocity.y)},t.prototype.isMoving=function(){return 0==this.velocity.x},t.prototype.createRenderCall=function(e){return e.indecies=this.renderHelper.getIndecies(e.indecies),this.inverse?e.vertecies=this.renderHelper.getInverseVertecies(this.position.x,this.position.y,this.width,this.height,e.vertecies):e.vertecies=this.renderHelper.getVertecies(this.position.x,this.position.y,this.width,this.height,e.vertecies),this.stunned?e.textureCoords.push.apply(e.textureCoords,this.stunnedAnimation.getCurrentFrame()):(e.textureCoords.push.apply(e.textureCoords,this.upperAnimation.getCurrentFrame()),this.renderLower(e),this.spellHandler.castingShield&&(this.renderShield(e),this.spellHandler.castingShield=!1)),e},t.prototype.shieldExplosion=function(e){this.particleHandler.createShieldExplosionEffect(this.getCalculatedPos(this.position,0),this.inverse),this.hardHit(e,.7)},t.prototype.getShieldCollidables=function(){return this.spellHandler.castingShield?this.spellHandler.shieldCollidables:[]},t.prototype.renderLower=function(e){var t,i,r=new s.RenderCall,n=this.position.x;this.inverse?(i=n,t=n+this.width):(i=n+this.width,t=n);var a=this.position.y,o=this.position.y+this.height;r.vertecies=[t,a,i,o,i,a,t,a,i,o,t,o],e.textureCoords.push.apply(e.textureCoords,this.lowerAnimation.getCurrentFrame()),e.indecies=this.renderHelper.getIndecies(e.indecies),e.vertecies.push.apply(e.vertecies,r.vertecies)},t.prototype.update=function(e,t,i){var r=this.collisionDetection.collisionDetection(e,t,this,this.toMove,i);this.middlePosition.x=this.position.x+this.width/2,this.middlePosition.y=this.position.y,null==this.lift?this.fall(i):(r.groundCollision&&(this.liftVelocity=new n.Vector(0,0),this.lift=null),r.groundCollision=!0,r.normalY=-1),null!=r.lift&&r.groundCollision&&r.normalY==-1&&(this.lift=r.lift),this.deathType&&this.deathType==l.DeathType.swordDeath&&(this.dead=!0,this.projectileHandler.createPlayerSword_death(this.position,this.inverse)),r.groundCollision&&(this.velocity.y=0,r.normalY==-1?(this.inJump=!1,this.jumping&&(this.liftVelocity=new n.Vector(0,0),this.lift=null,this.idleTime=0,this.velocity.y=this.jumpSpeed,this.inJump=!0),this.onGroundTimer=50):this.onGroundTimer>=0&&(r.fallDeath=!0)),r.fallDeath&&(this.dead=!0,this.animationHandler.fallDeath(this.position)),r.wallCollision&&(this.velocity.x=0,this.externalVelocity.x=0),0!=this.velocity.x||r.wallCollision?this.idleTime=0:(this.idleTime+=i,this.lowerRunningAnimation.reset(),this.upperRunningAnimation.reset()),this.moving||(0!=this.externalVelocity.x?this.externalDrag.apply(this.externalVelocity,i):this.dragForce.apply(this.velocity,i)),this.spellHandler.update(i),this.inJump?this.lowerAnimation=this.lowerJumpAnimation:this.moving||0!=this.velocity.x?this.lowerAnimation=this.lowerRunningAnimation:this.lowerAnimation=this.lowerStillAnimation,this.stunned?(this.stunnedAnimation.next(i),this.spellHandler.castingShield=!1,0==this.stunnedAnimation.repetitions&&(this.stunned=!1)):this.spellHandler.currentCast?(this.spellHandler.currentCast instanceof n.ChannelCast&&(this.lowerAnimation=this.spellHandler.currentCast.lowerCurrentAnimation),this.upperAnimation=this.spellHandler.currentCast.currentAnimation):this.inJump?this.upperAnimation=this.upperJumpAnimation:this.idleTime>=this.idleTimeChange?(this.lowerAnimation=this.lowerIdleAnimation,this.upperAnimation=this.upperIdleAnimation):this.moving||0!=this.velocity.x?(this.upperRunningAnimation.frameIndex=this.lowerRunningAnimation.frameIndex,this.upperRunningAnimation.lastChange=this.lowerRunningAnimation.lastChange,this.upperAnimation=this.upperRunningAnimation,this.lowerAnimation=this.lowerRunningAnimation):(this.upperAnimation=this.upperStillAnimation,this.lowerAnimation=this.lowerStillAnimation),this.lowerAnimation.next(i),this.upperAnimation.next(i),this.jumping=!1,this.moving=!1;var s=this.getVelocity();this.toMove.x=s.x*i,this.toMove.y=s.y*i,this.updateDamageAnimations(),this.onGroundTimer-=i},t.prototype.moveRight=function(t){e.prototype.moveRight.call(this,t)},t.prototype.moveLeft=function(t){e.prototype.moveLeft.call(this,t)},t.prototype.getCollisionArea=function(){var e=new n.Rectangle(this.position.x+8,this.position.y+14,32,68);return e},t.prototype.getProjectileCollisionArea=function(){var e=new n.Rectangle(this.position.x+14,this.position.y+14,20,72);return e},t.prototype.getCalculatedPos=function(e,t){return new n.Vector(this.calcPos(e.x,t,25),this.calcPos(e.y,t,43))},t.prototype.calcPos=function(e,t,i){return e-(t/2-i)},t.prototype.jump=function(){this.jumping||(this.jumping=!0)},t.prototype.cast=function(e){this.spellHandler.cast(e)},t.prototype.renderShield=function(e){return e.vertecies=this.renderHelper.getVertecies(this.position.x-18,this.position.y-5,80,100,e.vertecies),e.textureCoords.push.apply(e.textureCoords,this.shieldTextureCoords),e.indecies=this.renderHelper.getIndecies(e.indecies),e},t.prototype.stun=function(){this.stunned=!0,this.stunnedAnimation.repetitions=10,this.stunnedAnimation.reset()},t.prototype.updateDamageAnimations=function(){for(var e=[],t=0,i=this.damageAnimations;t<i.length;t++){var r=i[t];r.animation.areaToRender.x=this.position.x-r.offset.x,r.animation.areaToRender.y=this.position.y-r.offset.y,r.animation.repetitions<=0&&e.push(r)}for(var n=0,s=e;n<s.length;n++){var a=s[n],o=this.damageAnimations.indexOf(a);o!=-1&&this.damageAnimations.splice(o,1)}},t}(c.Character);t.Player=p},function(e,t,i){"use strict";var r=i(347),n=function(){function e(e,t,i,r,n,s,a){this.fireLevel=n,this.frostLevel=s,this.shieldLevel=a,this.shieldCollidables=[],this.castingShield=!1,this.break=0,this.refShieldCollidables=[],this.maxMagicValue=50+20*this.fireLevel,this.minMagicValue=25+5*this.fireLevel,this.animationHandler=e,this.projectileHandler=t,this.particleHandler=i,this.player=r,this.createShieldCollidables(),this.initCasts()}return e.prototype.update=function(e){if(this.currentCast&&0==this.break?(this.currentCast.update(e),this.currentCast.done&&(this.currentCast.cancel(),this.currentCast=null)):this.castingShield||this.player.regenMana(),this.channelMagicCast.currentValue>=this.maxMagicValue&&this.particleHandler.createMagicEffect(this.player.position,this.player.inverse),this.castingShield){this.shieldCollidables=[];for(var t=0,i=this.refShieldCollidables;t<i.length;t++){var n=i[t];this.shieldCollidables.push(new r.Rectangle(n.x+this.player.position.x,n.y+this.player.position.y,n.width,n.height))}this.particleHandler.createShieldEffect(this.player.getCalculatedPos(this.player.position,0),this.player.inverse,this.shieldLevel)}this.updateBreak(e)},e.prototype.cast=function(e){switch(e){case r.SpellType.fireball:this.castFireBall();break;case r.SpellType.electricbolt:this.castElectricBall();break;case r.SpellType.fireBlast:this.castFireBlast();break;case r.SpellType.frostBlast:this.castFrostBlast();break;case r.SpellType.shield:this.castShield();break;case r.SpellType.channelmagic:this.castChannelMagic()}},e.prototype.createShieldCollidables=function(){this.refShieldCollidables=[];for(var e=17,t=40,i=0;i<20;i++){var n=void 0,s=void 0;n=Math.PI*(.1*i+.6),s=e+30*Math.cos(n);var a=t+40*Math.sin(n);this.refShieldCollidables.push(new r.Rectangle(s,a,12,12))}},e.prototype.castShield=function(){this.player.useMana(.1)?0==this.break&&(this.castingShield=!0):(this.break=500,this.player.shieldExplosion(this.player.inverse))},e.prototype.updateBreak=function(e){this.break-=e,this.break<0&&(this.break=0)},e.prototype.castFireBall=function(){(!this.currentCast||this.currentCast==this.fireBallCast&&1==this.fireBallCast.currentAnimation.repetitions)&&(this.player.useMana(20)?(this.fireBallCast.reset(),this.fireBallCast.size=this.channelMagicCast.currentValue,this.channelMagicCast.resetValue(),this.currentCast=this.fireBallCast):(this.break=500,this.castingShield&&this.player.shieldExplosion(this.player.inverse)))},e.prototype.castElectricBall=function(){},e.prototype.castChannelMagic=function(){this.currentCast&&this.currentCast!=this.channelMagicCast||!this.player.isMoving()||(this.channelMagicCast.channeling=!0,this.channelMagicCast.done=!1,this.currentCast=this.channelMagicCast)},e.prototype.castFireBlast=function(){this.currentCast&&this.currentCast!=this.fireBlastCast||(this.player.useMana(.5)?(this.fireBlastCast.reset(),this.currentCast=this.fireBlastCast):(this.break=500,this.castingShield&&this.player.shieldExplosion(this.player.inverse)))},e.prototype.castFrostBlast=function(){this.currentCast&&this.currentCast!=this.frostBlastCast||(this.player.useMana(.5)?(this.frostBlastCast.reset(),this.currentCast=this.frostBlastCast):(this.break=500,this.castingShield&&this.player.shieldExplosion(this.player.inverse)))},e.prototype.initCasts=function(){var e=this,t=new r.Animation([178]);t.repetitions=1;var i=this.getOnCastFireBlast(this.fireLevel);this.fireBlastCast=new r.InstantCast(t,i);var n=new r.Animation([178]);n.repetitions=1;var s=this.getOnCastFrostBlast(this.frostLevel);this.frostBlastCast=new r.InstantCast(n,s);var a=new r.Animation([175]),o=new r.Animation([162]),h=function(){e.particleHandler.createChannelMagic(e.player.position,e.player.inverse)},c=function(){};this.channelMagicCast=new r.ChannelCast(a,o,h,c,25+5*this.fireLevel,this.maxMagicValue,.03);var l=new r.Animation([170,176,177,176]);l.repetitions=3,l.timeToChange=170;var u=function(t,i,n){e.particleHandler.createFireBall(new r.Vector(t.x,t.y),t.width,i,n)},p=function(t,i){return e.projectileHandler.createFireBall(e.player.getCalculatedPos(e.player.position,i),e.player.inverse,.6,i,11,u),t};this.fireBallCast=new r.SpellCast(l,2,p)},e.prototype.getOnCastFireBlast=function(e){var t=this;return 0==e?function(e){return t.particleHandler.createFireBlast(t.player.position,t.player.inverse,0),e}:1==e?function(e){return t.particleHandler.createFireBlast(t.player.position,t.player.inverse,1),e}:2==e?function(e){return t.particleHandler.createFireBlast(t.player.position,t.player.inverse,2),e}:function(e){return t.particleHandler.createFireBlast(t.player.position,t.player.inverse,3),e}},e.prototype.getOnCastFrostBlast=function(e){var t=this;return 0==e?function(e){return t.particleHandler.createFrostBlast(t.player.position,t.player.inverse,0),e}:1==e?function(e){return t.particleHandler.createFrostBlast(t.player.position,t.player.inverse,1),e}:2==e?function(e){return t.particleHandler.createFrostBlast(t.player.position,t.player.inverse,2),e}:function(e){return t.particleHandler.createFrostBlast(t.player.position,t.player.inverse,3),e}},e}();t.SpellHandler=n},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(402),s=i(347),a=i(363),o=i(408),h=i(406),c=function(e){function t(t,i,r,n,h){e.call(this,t,i,r),this.textureMapper=a.TextureMapper.getInstance(),this.hitAreaOffset=50,this.searchAreaOffset=100,this.hp=300,this.trackingSpeed=.2,this.idleSpeed=0,this.minDistance=30,this.debugHandler=o.DebugHandler.getInstance(),this.projectileHandler=n,this.animationHandler=h,this.idleAnimation=new s.Animation([118]),this.idleToTrackingAnimation=new s.Animation([119,120,121,122,123,124,125,126,127,128,129,130,131,132]),this.idleToTrackingAnimation.repetitions=13,this.idleToTrackingAnimation.timeToChange=50,this.trackingToIdleTransitionAnimation=new s.Animation([132,130,127,124,119]),this.trackingToIdleTransitionAnimation.repetitions=4,this.trackingAnimation=new s.Animation([133,134,135]),this.hitAnimation=new s.Animation([136,136,137,137,138,138]),this.hitAnimation.timeToChange=150,this.currentAnimation=this.hitAnimation,this.idleAnimation.timeToChange=175}return r(t,e),t.prototype.update=function(t,i,r){e.prototype.update.call(this,t,i,r),this.currentAnimation.next(t),this.npcAction(t,r,i)},t.prototype.getCollisionArea=function(){var e;return e=this.currentState!=h.State.Tracking&&this.currentState!=h.State.InHitRange?new s.Rectangle(this.position.x+this.width/2,this.position.y-5+this.height,0,0):new s.Rectangle(this.position.x,this.position.y-5,this.width,this.height)},t.prototype.hit=function(t,i,r){if(e.prototype.hit.call(this,t,i,r),2==this.hitAnimation.frameIndex&&!this.hitting){this.hitting=!0;var n=void 0;n=this.inverse?new s.Vector(this.position.x+30,this.position.y+20):new s.Vector(this.position.x-50,this.position.y+20);this.projectileHandler.createCollisionProjectile(n,this.width,this.inverse,60,new s.Vector(1,.8))}0==this.hitAnimation.frameIndex&&(this.hitting=!1)},t.prototype.idle=function(t,i,r){e.prototype.idle.call(this,t,i,r),this.stop(),this.burnValue=0},t.prototype.idleToTrackingTransition=function(e){this.currentAnimation=this.idleToTrackingAnimation,this.stop(),0==this.idleToTrackingAnimation.repetitions&&(this.trackingTime=this.trackingMaxTime,this.currentState=h.State.Tracking,this.currentAnimation=this.trackingAnimation,this.maxSpeed=this.trackingSpeed,this.actualSpeed=this.maxSpeed,this.idleToTrackingAnimation.reset(),this.idleToTrackingAnimation.repetitions=13)},t.prototype.trackingToInRangeTransition=function(e){this.currentState=h.State.InHitRange},t.prototype.trackingToIdleTransition=function(e){this.currentAnimation=this.trackingToIdleTransitionAnimation,this.stop(),0==this.trackingToIdleTransitionAnimation.repetitions&&(this.currentState=h.State.Idle,this.currentAnimation=this.idleAnimation,this.maxSpeed=this.idleSpeed,this.actualSpeed=this.maxSpeed,this.trackingToIdleTransitionAnimation.reset(),
this.trackingToIdleTransitionAnimation.repetitions=4)},t.prototype.inRange=function(e,t,i){var r=this.getDeltaPosition(e,10,0),n=r.magnitude();return n<t&&!!this.clearShoot(r,i)},t.prototype.clearShoot=function(e,t){for(var i=!0,r=this.getPathBlocks(e),n=0,s=r;n<s.length;n++){var a=s[n];if(!this.collisionDetection.fastCheckEnviroment(a,t)){i=!1;break}}return i},t.prototype.getPathBlocks=function(e){var t=20,i=e.magnitude(),r=e.copy(e),n=new s.Vector(this.position.x,this.position.y+10);r.normalize();for(var a=[],o=0;o<Math.floor(i/t);o++){var h=i-o*t;a.push(new s.Rectangle(n.x+r.x*h,n.y+r.y*h,t,17))}return a},t}(n.Enemy);t.Shadow=c},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(402),s=i(347),a=i(363),o=i(408),h=i(406),c=function(e){function t(t,i,r,n,h,c){var l=this;e.call(this,t,i,r),this.particleHandler=c,this.hitAreaOffset=500,this.searchAreaOffset=500,this.hp=50,this.trackingSpeed=.05,this.idleSpeed=.05,this.minDistance=30,this.textureMapper=a.TextureMapper.getInstance(),this.projectileVelocity=.5,this.shoot=!1,this.onBlackFireUpdate=function(e,t,i){l.particleHandler.createNecroFireBall(new s.Vector(e.x,e.y),e.width,t,i)},this.debugHandler=o.DebugHandler.getInstance(),this.projectileHandler=n,this.animationHandler=h,this.idleAnimation=new s.Animation([139,140,141,142,143]),this.idleAnimation.timeToChange=175,this.trackingAnimation=new s.Animation([139,140,141,142,143]),this.trackingAnimation.timeToChange=175,this.hitAnimation=new s.Animation([139,140,141,142,143]),this.hitAnimation.timeToChange=250,this.currentAnimation=this.hitAnimation}return r(t,e),t.prototype.update=function(t,i,r){e.prototype.update.call(this,t,i,r),this.currentAnimation.next(t),this.npcAction(t,r,i)},t.prototype.getCollisionArea=function(){var e;return e=new s.Rectangle(this.position.x+25,this.position.y+15,this.width-50,this.height-20)},t.prototype.hit=function(t,i,r){if(e.prototype.hit.call(this,t,i,r),3==this.hitAnimation.frameIndex){if(!this.shoot){var n=this.getDeltaPosition(i,0,0);n.y=n.y+20,n.normalize(),n.multiply(this.projectileVelocity);var a=new s.Vector(this.position.x,this.position.y);this.projectileHandler.createNecroBall(a,40,this.inverse,n,100,this.onBlackFireUpdate),this.shoot=!0}}else this.shoot=!1},t.prototype.idle=function(t,i,r){e.prototype.idle.call(this,t,i,r),this.actualSpeed=this.maxSpeed,this.patrol(t)},t.prototype.idleToTrackingTransition=function(e){this.currentState=h.State.Tracking},t.prototype.trackingToInRangeTransition=function(e){this.currentState=h.State.InHitRange},t.prototype.trackingToIdleTransition=function(e){this.currentState=h.State.Idle},t.prototype.inRange=function(e,t,i){var r=this.getDeltaPosition(e,10,0),n=r.magnitude();return n<t&&!!this.clearShoot(r,i)},t.prototype.clearShoot=function(e,t){for(var i=!0,r=this.getPathBlocks(e),n=0,s=r;n<s.length;n++){var a=s[n];if(!this.collisionDetection.fastCheckEnviroment(a,t)){i=!1;break}}return i},t.prototype.getPathBlocks=function(e){var t=20,i=e.magnitude(),r=e.copy(e),n=new s.Vector(this.position.x,this.position.y+10);r.normalize();for(var a=[],o=0;o<Math.floor(i/t);o++){var h=i-o*t;a.push(new s.Rectangle(n.x+r.x*h,n.y+r.y*h,t,17))}return a},t}(n.Enemy);t.Apprentice=c},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(402),s=i(347),a=i(363),o=i(408),h=i(406),c=function(e){function t(t,i,r,n,h,c){var l=this;e.call(this,t,i,r),this.particleHandler=c,this.hitAreaOffset=500,this.searchAreaOffset=500,this.hp=200,this.hitDamage=50,this.trackingSpeed=.4,this.idleSpeed=.1,this.minDistance=30,this.textureMapper=a.TextureMapper.getInstance(),this.projectileVelocity=.5,this.onBlackFireUpdate=function(e,t,i){l.particleHandler.createNecroFireBall(new s.Vector(e.x,e.y),e.width,t,i)},this.hitTimer=0,this.chargeTimer=1e3,this.debugHandler=o.DebugHandler.getInstance(),this.projectileHandler=n,this.animationHandler=h,this.acceleration=.1,this.idleAnimation=new s.Animation([560,561,562,563,564,565,566,567]),this.idleAnimation.timeToChange=175,this.trackingAnimation=new s.Animation([568,569,570,571,572,573,574,575]),this.trackingAnimation.timeToChange=175,this.hitAnimation=new s.Animation([568,569,570,571,572,573,574,575]),this.hitAnimation.timeToChange=250,this.currentAnimation=this.hitAnimation}return r(t,e),t.prototype.update=function(t,i,r){e.prototype.update.call(this,t,i,r),this.currentAnimation.next(t),this.hitTimer>0&&(this.hitTimer-=t),this.npcAction(t,r,i)},t.prototype.getCollisionArea=function(){var e;return e=new s.Rectangle(this.position.x+15,this.position.y,this.width-30,this.height-10)},t.prototype.hit=function(t,i,r){e.prototype.hit.call(this,t,i,r),this.hitTimer<=0&&this.collisionDetection.aabbCheck(this.getCollisionArea(),i.getCollisionArea())&&(this.hitTimer=500,this.chargeTimer=1e3,this.currentState=h.State.Idle,i.takeDamage(this.hitDamage),i.position.x<this.position.x?i.hardHit(!1,.8):i.hardHit(!0,.8))},t.prototype.idle=function(t,i,r){e.prototype.idle.call(this,t,i,r),this.actualSpeed=this.maxSpeed,this.patrol(t)},t.prototype.idleToTrackingTransition=function(e){this.currentAnimation=this.trackingAnimation,this.chargeTimer>0?this.chargeTimer-=e:this.currentState=h.State.Tracking},t.prototype.trackingToInRangeTransition=function(e){this.currentState=h.State.InHitRange},t.prototype.trackingToIdleTransition=function(e){this.currentState=h.State.Idle},t.prototype.track=function(t,i,r){e.prototype.track.call(this,t,i,r,30),this.setFreezeSpeed()},t.prototype.inRange=function(e,t,i){var r=this.getDeltaPosition(e,10,0),n=r.magnitude();return n<t&&!!this.clearShoot(r,i)},t.prototype.moveToPlayer=function(e,t,i,r){var n=this.position.x+this.width/2;Math.abs(t.middlePosition.x-n)>r?t.middlePosition.x<n?this.moveLeft(e):t.middlePosition.x>n&&this.moveRight(e):(this.currentState=h.State.Idle,this.chargeTimer=1e3)},t.prototype.clearShoot=function(e,t){for(var i=!0,r=this.getPathBlocks(e),n=0,s=r;n<s.length;n++){var a=s[n];if(!this.collisionDetection.fastCheckEnviroment(a,t)){i=!1;break}}return i},t.prototype.getPathBlocks=function(e){var t=20,i=e.magnitude(),r=e.copy(e),n=new s.Vector(this.position.x,this.position.y+10);r.normalize();for(var a=[],o=0;o<Math.floor(i/t);o++){var h=i-o*t;a.push(new s.Rectangle(n.x+r.x*h,n.y+r.y*h,t,17))}return a},t}(n.Enemy);t.Screamer=c},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(402),s=i(347),a=i(363),o=i(408),h=i(406),c=function(e){function t(t,i,r,n,h,c){var l=this;e.call(this,t,i,r),this.particleHandler=c,this.hitAreaOffset=400,this.searchAreaOffset=800,this.hp=500,this.trackingSpeed=.1,this.idleSpeed=.1,this.minDistance=30,this.textureMapper=a.TextureMapper.getInstance(),this.projectileVelocity=.5,this.shoot=!1,this.onBlackFireUpdate=function(e,t,i){l.particleHandler.createNecroFireBall(new s.Vector(e.x,e.y),e.width,t,i)},this.defaultChannelTime=1500,this.shootDefaultCooldown=100,this.shootCooldown=this.shootDefaultCooldown,this.channelTimer=this.defaultChannelTime,this.shootsFired=0,this.maxShoots=10,this.debugHandler=o.DebugHandler.getInstance(),this.projectileHandler=n,this.animationHandler=h,this.idleAnimation=new s.Animation([580,581,582,583,584,585]),this.idleAnimation.timeToChange=175,this.trackingAnimation=new s.Animation([580,581,582,583,584,585]),this.trackingAnimation.timeToChange=175,this.channelHitTransitionAnimation=new s.Animation([585,597,598]),this.channelHitTransitionAnimation.timeToChange=150,this.hitAnimation=new s.Animation([598]),this.hitAnimation.timeToChange=150,this.channelAnimation=new s.Animation([585]),this.currentAnimation=this.hitAnimation}return r(t,e),t.prototype.update=function(t,i,r){e.prototype.update.call(this,t,i,r),this.currentAnimation.next(t),this.npcAction(t,r,i)},t.prototype.getCollisionArea=function(){var e;return e=new s.Rectangle(this.position.x+25,this.position.y+35,this.width-50,this.height-40)},t.prototype.track=function(t,i,r,n){e.prototype.track.call(this,t,i,r,n),this.setFreezeSpeed()},t.prototype.hit=function(e,t,i){if(this.inRange(t,this.hitAreaOffset,i)||0!=this.hitAnimation.frameIndex||(this.currentState=h.State.Tracking),this.moveToPlayer(e,t,i,10),this.actualSpeed=0,this.channel(e))this.currentAnimation=this.channelAnimation,this.particleHandler.createNecroChannelMagic(this.position,this.inverse);else if(2!=this.channelHitTransitionAnimation.frameIndex)this.currentAnimation=this.channelHitTransitionAnimation;else if(this.currentAnimation=this.hitAnimation,this.shootCooldown<=0){if(this.shootsFired<this.maxShoots){this.shootsFired++;var r=this.getDeltaPosition(t,0,this.rand(0,50));r.y=r.y+20,r.normalize(),r.multiply(this.projectileVelocity);var n=void 0;n=this.inverse?new s.Vector(this.position.x-18,this.position.y+20):new s.Vector(this.position.x+80,this.position.y+20),this.projectileHandler.createNecroBall(n,25,this.inverse,r,10,this.onBlackFireUpdate)}else this.shootsFired=0,this.channelTimer=this.defaultChannelTime,this.channelHitTransitionAnimation.reset();this.shootCooldown=this.shootDefaultCooldown}else this.shootCooldown-=e},t.prototype.idle=function(t,i,r){e.prototype.idle.call(this,t,i,r),this.actualSpeed=this.maxSpeed,this.patrol(t)},t.prototype.idleToTrackingTransition=function(e){this.currentState=h.State.Tracking},t.prototype.trackingToInRangeTransition=function(e){this.currentState=h.State.InHitRange},t.prototype.trackingToIdleTransition=function(e){this.currentState=h.State.Idle},t.prototype.inRange=function(e,t,i){var r=this.getDeltaPosition(e,10,0),n=r.magnitude();return n<t&&!!this.clearShoot(r,i)},t.prototype.channel=function(e){return this.channelTimer-=e,!(this.channelTimer<=0)},t.prototype.clearShoot=function(e,t){for(var i=!0,r=this.getPathBlocks(e),n=0,s=r;n<s.length;n++){var a=s[n];if(!this.collisionDetection.fastCheckEnviroment(a,t)){i=!1;break}}return i},t.prototype.getPathBlocks=function(e){var t=20,i=e.magnitude(),r=e.copy(e),n=new s.Vector(this.position.x,this.position.y+10);r.normalize();for(var a=[],o=0;o<Math.floor(i/t);o++){var h=i-o*t;a.push(new s.Rectangle(n.x+r.x*h,n.y+r.y*h,t,17))}return a},t}(n.Enemy);t.MasterSorcerer=c},function(e,t){"use strict"},function(e,t,i){"use strict";var r=i(357),n=i(347),s=i(404),a=function(){function e(e,t,i,s,a,o){this.position=e,this.width=t,this.height=i,this.projectileHandler=s,this.animationHandler=a,this.particleHandler=o,this.color=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],this.hp=500,this.renderHalper=r.RenderHelper.getInstance(),this.sorcererAnimation=new n.Animation([600,601,602,603,604,605,606,607]),this.currentAnimation=this.sorcererAnimation}return e.prototype.getCollisionArea=function(){throw new Error("Method not implemented.")},e.prototype.takeDamage=function(e,t){this.hp=this.hp-e,this.hp<=0&&(t==n.SpellType.frostBlast?this.deathType=s.DeathType.freezeDeath:t==n.SpellType.fireBlast?this.deathType=s.DeathType.fireDeath:this.deathType=s.DeathType.swordDeath,this.dead=!0)},e.prototype.freeze=function(){throw new Error("Method not implemented.")},e.prototype.burn=function(){throw new Error("Method not implemented.")},e.prototype.update=function(e){this.currentAnimation.next(e)},e.prototype.createRenderCall=function(e){},e}();t.ShapeShifter=a},function(e,t,i){"use strict";var r=i(418),n=i(357),s=i(409),a=i(347),o=i(367),h=i(421),c=i(422),l=i(423),u=i(424),p=i(425),d=i(428),g=i(408),f=i(429),x=i(430),y=i(431),m=i(432),v=i(434),w=i(346),R=i(438),T=i(435),A=function(){function e(e,t,i){this.asset=e,this.canvasWidth=1200,this.canvasHeight=800,this.fps=60,this.collision=o.CollisionDetection.getInstance(),this.loadHelper=w.LoadHelper.getInstance(),this.gameArea=new a.Rectangle(-50,-50,this.canvasWidth+100,this.canvasHeight+100),this.level=new a.Level,this.debugHandler=g.DebugHandler.getInstance(),this.levelCompleted=!1,this.deathTimer=0,this.renderCalls=new Map,this.context=new r.Context(e,this.canvasWidth,this.canvasHeight,t),this.renderer=new n.Renderer(this.context),this.sceneHandler=new v.SceneHandler(this.renderer,[this.canvasWidth,this.canvasHeight],t,this),this.colorRenderer=new n.ColorRenderer(this.context),this.simpleParticleRenderer=new d.SimpleParticleRenderer(this.context),this.dynamicRenderer=new y.DynamicRenderer(this.context),this.levelData=i,this.initKeyBindings(),this.reset(this.levelData),this.initLoop()}return e.prototype.reset=function(e){this.loadLevel(e)},e.prototype.initLoop=function(){this.intevalTimer=setInterval(this.run(),0)},e.prototype.run=function(){var e=this;this.lastUpdate=(new Date).getTime();var t=0,i=1e3/this.fps,r=3,n=(new Date).getTime();return function(){for(t=0;(new Date).getTime()>n&&t<r;){var s=n-e.lastUpdate;e.lastUpdate=n,e.sceneHandler.started?(e.player.dead||e.levelCompleted?e.deathTimer<3e3?(e.deathTimer+=s,e.player.position.x=-1e3,e.player.position.y=-1e3,e.enemyHandler.update(s,e.level.tiles,e.player),e.animationHandler.update(s),e.projectileHandler.update(s,e.level.tiles,e.player,e.dynamicTileHandler.dynamicTiles),e.particleHandler.update(s,e.enemyHandler.enemies)):(e.sceneHandler.started=!1,e.sceneHandler.setCurrentLevel(e.level.name),e.sceneHandler.currentScene=T.SceneIndex.RestartMenu):(e.checkGoal(),e.checkKeys(s),e.collision.checkCoutOfBounds(e.player,e.level.gameSize),e.player.update(e.level.tiles,e.dynamicTileHandler.dynamicTiles,s),e.dynamicTileHandler.update(e.player,s),e.enemyHandler.update(s,e.level.tiles,e.player),e.animationHandler.update(s),e.projectileHandler.update(s,e.level.tiles,e.player,e.dynamicTileHandler.dynamicTiles),e.UI.update(e.player.hp,e.player.mana),e.camera.update(e.player.position),e.particleHandler.update(s,e.enemyHandler.enemies)),e.render()):(e.sceneHandler.update(),e.sceneHandler.render()),n+=i}}},e.prototype.render=function(){this.context.clear([0,0,0,.95]);var e=new n.DynamicRenderCall,t=new n.RenderCall;this.renderCalls.clear();var i=new n.ColorRenderCall,r=[],s=[];if(this.enemyHandler.createRenderCall(i),this.tileMap.createGoalRenderCall(this.level.end,t),this.player.dead){this.textRenderer.createTextRenderCall(400,64,50,t,this.camera.position);for(var a=0,o=this.player.damageAnimations;a<o.length;a++){var h=o[a];this.animationHandler.remove(h.animation)}this.player.damageAnimations=[]}else this.levelCompleted?this.textRenderer.createTextRenderCall(800,96,51,t,this.camera.position):t=this.player.createRenderCall(t);this.animationHandler.createDynamicRenderCall(e,this.camera.position),this.animationHandler.createRenderCall(i),this.animationHandler.createStaticRenderCall(t),this.UI.createRenderCall(t,this.camera.position),s=this.particleHandler.createRenderCalls(s),this.debugHandler.createRenderCall(t),r.push(i),this.tileMap.createRenderCall(this.renderCalls),this.renderCalls=this.dynamicTileHandler.createRenderCall(this.renderCalls),this.renderCalls.set(-1,t),this.renderer.render(this.renderCalls,this.camera.position),this.colorRenderer.render(r,this.camera.position),this.simpleParticleRenderer.render(s,this.camera.position),this.dynamicRenderer.render([e])},e.prototype.checkGoal=function(){this.levelCompleted=this.collision.aabbCheck(this.player.getCollisionArea(),this.collisionAreaEnd),this.levelCompleted&&this.sceneHandler.levelCompleted(this.level.name)},e.prototype.checkKeys=function(e){this.player.stunned||(this.leftKeyPress?this.player.moveLeft(e):this.rightKeyPress&&this.player.moveRight(e),this.jumpKeyPress&&this.player.jump(),this.shieldPress&&this.player.cast(a.SpellType.shield),this.frostKeyPress?this.player.cast(a.SpellType.frostBlast):this.fireKeyPress?this.player.cast(a.SpellType.fireBlast):this.fireballKeyPress?this.player.cast(a.SpellType.fireball):this.channelMagicKeyPress&&this.player.cast(a.SpellType.channelmagic))},e.prototype.initKeyBindings=function(){var e=this;document.body.addEventListener("keydown",function(t){var i=t.keyCode;switch(i){case 65:e.leftKeyPress=!0;break;case 68:e.rightKeyPress=!0;break;case 87:e.jumpKeyPress=!0;break;case 97:e.fireballKeyPress=!0;break;case 49:e.fireballKeyPress=!0;break;case 98:e.channelMagicKeyPress=!0;break;case 50:e.channelMagicKeyPress=!0;break;case 99:e.frostKeyPress=!0;break;case 51:e.frostKeyPress=!0;break;case 100:e.fireKeyPress=!0;break;case 52:e.fireKeyPress=!0;break;case 101:e.shieldPress=!0;break;case 53:e.shieldPress=!0;break;case 38:e.jumpKeyPress=!0;break;case 39:e.rightKeyPress=!0;break;case 37:e.leftKeyPress=!0}}),document.body.addEventListener("keyup",function(t){var i=t.keyCode;switch(i){case 65:e.leftKeyPress=!1;break;case 68:e.rightKeyPress=!1;break;case 87:e.jumpKeyPress=!1;break;case 97:e.fireballKeyPress=!1;break;case 49:e.fireballKeyPress=!1;break;case 98:e.channelMagicKeyPress=!1;break;case 50:e.channelMagicKeyPress=!1;break;case 99:e.frostKeyPress=!1;break;case 51:e.frostKeyPress=!1;break;case 100:e.fireKeyPress=!1;break;case 52:e.fireKeyPress=!1;break;case 101:e.shieldPress=!1;break;case 53:e.shieldPress=!1;break;case 38:e.jumpKeyPress=!1;break;case 39:e.rightKeyPress=!1;break;case 37:e.leftKeyPress=!1}})},e.prototype.loadLevel=function(e){var t=R.LocalStorageHelper.getInstance().getCurrentProgress();this.particleHandler=new p.ParticleHandler,this.animationHandler=new c.AnimationHandler(this.particleHandler),this.projectileHandler=new l.ProjectileHandler(this.animationHandler,this.getSpellLevel(t.defence)),this.dynamicTileHandler=new u.DynamicTileHandler,this.level=this.loadHelper.levelDataToLevel(e,this.projectileHandler,this.animationHandler,this.particleHandler),this.collisionAreaEnd=new a.Rectangle(this.level.end.x+this.level.end.width/2,this.level.end.y+this.level.end.height/2,1,1),this.particleHandler.tiles=this.level.tiles,this.camera=new x.Camera([this.level.camera[0],this.level.camera[1]],[this.canvasWidth,this.canvasHeight],this.level.gameSize),this.levelCompleted=!1;var i=100+10*t.hp,n=200+20*t.mana;this.player=new s.Player(new a.Vector(this.level.player[0],this.level.player[1]),this.context,this.projectileHandler,this.animationHandler,this.particleHandler,48,85,i,n,t,this.getSpellLevel(t.fire),this.getSpellLevel(t.frost),this.getSpellLevel(t.defence)),this.collision.createGrid(new a.Vector(this.level.gameSize[0],this.level.gameSize[1]),this.level.tiles),this.UI=new m.UI(i,n),this.enemyHandler=new f.EnemyHandler(this.context,this.projectileHandler,this.animationHandler,this.particleHandler),this.enemyHandler.enemies=this.level.enemies,this.deathTimer=0,this.dynamicTileHandler.dynamicTiles=this.level.dynamicTiles,this.tileMap=new r.TileMap(this.level.tiles,this.level.decorativeTiles),this.textRenderer=new h.TextRenderer(this.context)},e.prototype.getSpellLevel=function(e){return 0==e?0:e<3?1:e<6?2:3},e}();t.Game=A},function(e,t,i){"use strict";var r=i(419);t.Context=r.Context;var n=i(417);t.Game=n.Game;var s=i(420);t.TileMap=s.TileMap;var a=i(358);t.Renderer=a.Renderer},function(e,t,i){"use strict";var r=i(347),n=function(){function e(e,t,i,r){this.tileTextures=new Map,this.initContext(t,i,r),this.initShaders(e)}return e.prototype.clear=function(e){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.clearColor(e[0],e[1],e[2],e[3])},e.prototype.initContext=function(e,t,i){i.width=e,i.height=t,this.gl=i.getContext("experimental-webgl"),console.log("Context initialized...")},e.prototype.initShaders=function(e){var t=this.compileShader(e.vertexShader,r.ShaderType.Vertex),i=this.compileShader(e.fragmentShader,r.ShaderType.Fragment),n=this.compileShader(e.simpleParticleVertexShader,r.ShaderType.Vertex),s=this.compileShader(e.simpleParticleFragmentShader,r.ShaderType.Fragment),a=this.compileShader(e.dynamicVertexShader,r.ShaderType.Vertex),o=this.compileShader(e.dynamicFragmentShader,r.ShaderType.Fragment),h=this.compileShader(e.colorVertexShader,r.ShaderType.Vertex),c=this.compileShader(e.colorFragmentShader,r.ShaderType.Fragment);this.colorShaderProgram=this.gl.createProgram(),this.gl.attachShader(this.colorShaderProgram,h),this.gl.attachShader(this.colorShaderProgram,c),this.gl.linkProgram(this.colorShaderProgram),this.gl.getProgramParameter(this.colorShaderProgram,this.gl.LINK_STATUS)||alert("Unable to initialize the shader program: "+this.gl.getProgramInfoLog(this.colorShaderProgram)),this.dynamicVertecyProgram=this.gl.createProgram(),this.gl.attachShader(this.dynamicVertecyProgram,a),this.gl.attachShader(this.dynamicVertecyProgram,o),this.gl.linkProgram(this.dynamicVertecyProgram),this.gl.getProgramParameter(this.dynamicVertecyProgram,this.gl.LINK_STATUS)||alert("Unable to initialize the shader program: "+this.gl.getProgramInfoLog(this.dynamicVertecyProgram)),this.simpleParticleProgram=this.gl.createProgram(),this.gl.attachShader(this.simpleParticleProgram,n),this.gl.attachShader(this.simpleParticleProgram,s),this.gl.linkProgram(this.simpleParticleProgram),this.gl.getProgramParameter(this.simpleParticleProgram,this.gl.LINK_STATUS)||alert("Unable to initialize the shader program: "+this.gl.getProgramInfoLog(this.simpleParticleProgram)),this.shaderProgram=this.gl.createProgram(),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,i),this.gl.linkProgram(this.shaderProgram),this.gl.getProgramParameter(this.shaderProgram,this.gl.LINK_STATUS)||alert("Unable to initialize the shader program: "+this.gl.getProgramInfoLog(this.shaderProgram)),this.initAssetTextures(this.gl,e)},e.prototype.initAssetTextures=function(e,t){this.initTextures(e,t.tileAssets),this.initBaseTextures(e,t)},e.prototype.initTextures=function(e,t){var i=this;t.forEach(function(t,r){var n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.image),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),i.tileTextures.set(r,n)})},e.prototype.initBaseTextures=function(e,t){this.glTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.glTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.generateMipmap(e.TEXTURE_2D),this.frostParticelTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.frostParticelTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.particleTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),this.genericParticleTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.genericParticleTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.genericParticleTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.enable(e.BLEND)},e.prototype.compileShader=function(e,t){var i;return t==r.ShaderType.Fragment?i=this.gl.createShader(this.gl.FRAGMENT_SHADER):t==r.ShaderType.Vertex&&(i=this.gl.createShader(this.gl.VERTEX_SHADER)),this.gl.shaderSource(i,e),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)?i:(console.log("An error occurred compiling the shaders: "+this.gl.getShaderInfoLog(i)),null)},e}();t.Context=n},function(e,t,i){"use strict";var r=i(359),n=i(362),s=i(391),a=function(){function e(e,t){this.tiles=e,this.decorativeTiles=t,this.renderCalls=new Map,this.decorativeRenderCalls=new Map,this.renderHelper=n.RenderHelper.getInstance(),this.constants=s.Constants.getInstance(),this.tileMap=new Map,this.decorativeTileMap=new Map,this.createStaticRenderCalls(this.tiles,this.tileMap,this.renderCalls),this.createStaticRenderCalls(this.decorativeTiles,this.decorativeTileMap,this.decorativeRenderCalls)}return e.prototype.createStaticRenderCalls=function(e,t,i){for(var n=this,s=0,a=e;s<a.length;s++){var o=a[s],h=t.get(o.key);h?h.push(o):t.set(o.key,[o])}t.forEach(function(e,t){var s=new r.RenderCall;s.key=t;for(var a=0,o=e;a<o.length;a++){var h=o[a];s.vertecies=n.renderHelper.getVertecies(h.x,h.y,h.width,h.height,s.vertecies),s.textureCoords=n.renderHelper.getTiledTextureCoordinates(h,s.textureCoords,n.constants.tileSize),s.indecies=n.renderHelper.getIndecies(s.indecies)}i.set(s.key,s)})},e.prototype.createGoalRenderCall=function(e,t){return t.vertecies=this.renderHelper.getVertecies(e.x,e.y,e.width,e.height,t.vertecies),t.textureCoords=this.renderHelper.getTextureCoordinates(t.textureCoords,550),t.indecies=this.renderHelper.getIndecies(t.indecies),t},e.prototype.createRenderCall=function(e){e=this.createDecorativeRenderCall(e),this.renderCalls.forEach(function(t,i){var n=e.get(i);n||(e.set(i,new r.RenderCall),n=e.get(i)),n.vertecies.push.apply(n.vertecies,t.vertecies),n.indecies.push.apply(n.indecies,t.indecies),n.textureCoords.push.apply(n.textureCoords,t.textureCoords)})},e.prototype.createDecorativeRenderCall=function(e){return this.decorativeRenderCalls.forEach(function(t,i){var n=e.get(i);n||(e.set(i,new r.RenderCall),n=e.get(i)),n.vertecies.push.apply(n.vertecies,t.vertecies),n.indecies.push.apply(n.indecies,t.indecies),n.textureCoords.push.apply(n.textureCoords,t.textureCoords)}),e},e}();t.TileMap=a},function(e,t,i){"use strict";var r=i(362),n=function(){function e(e){this.renderHelper=new r.RenderHelper,this.context=e}return e.prototype.createTextRenderCall=function(e,t,i,r,n){return r.vertecies=this.renderHelper.getVertecies(this.context.gl.canvas.width/2-e/2+n[0],this.context.gl.canvas.height/2-t/2+n[1],e,t,r.vertecies),r.textureCoords=this.renderHelper.getTextureCoordinates(r.textureCoords,i),r.indecies=this.renderHelper.getIndecies(r.indecies),r},e}();t.TextRenderer=n},function(e,t,i){"use strict";var r=i(347),n=i(357),s=function(){function e(e){this.animations=[],this.dynamicAnimations=[],this.staticAnimations=[],this.textureMapper=n.TextureMapper.getInstance(),this.renderHelper=n.RenderHelper.getInstance(),this.particleHandler=e}return e.prototype.bloodAnimation_A=function(e,t){var i=new r.Animation([100,101,102,103,104,105]);return i.areaToRender=new r.Rectangle(e.x,e.y,t,t),i.repetitions=6,this.animations.push(i),i},e.prototype.bloodAnimation_B_Right=function(e,t){var i=new r.Animation([106,107,108,109,110,111]);return i.areaToRender=new r.Rectangle(e.x,e.y,t,t),i.repetitions=6,this.animations.push(i),i},e.prototype.bloodAnimation_B_Left=function(e,t){var i=new r.Animation([106,107,108,109,110,111]);return i.areaToRender=new r.Rectangle(e.x,e.y,t,t),i.inverse=!0,i.repetitions=6,this.animations.push(i),i},e.prototype.voidAnimation=function(){var e=new r.Animation([]);return e.areaToRender=new r.Rectangle(0,0,0,0),e},e.prototype.bloodAnimation_C=function(e,t){var i=new r.Animation([147,148,149,150,151,152]);return i.areaToRender=new r.Rectangle(e.x,e.y,t,t),i.repetitions=6,this.animations.push(i),i},e.prototype.swordman_death=function(e,t){var i=this,n=new r.Animation([214,216,217,218]);return n.timeToChange=120,n.repetitions=4,n.areaToRender=new r.Rectangle(e.x,e.y,56,59),n.inverse=t,n.onCompletion=function(){i.swordman_corpse(e,t)},this.animations.push(n),n},e.prototype.createArcherDeath=function(e,t){this.bloodAnimation_C(new r.Vector(e.x-10,e.y-20),75),this.bloodAnimation_B_Left(new r.Vector(e.x-10,e.y-20),75),this.bloodAnimation_B_Right(new r.Vector(e.x-10,e.y-20),75),this.archer_death(e,t)},e.prototype.archer_death=function(e,t){var i=this,n=new r.Animation([290,291,292,293]);return n.timeToChange=120,n.repetitions=4,n.areaToRender=new r.Rectangle(e.x,e.y,e.width,e.height),n.inverse=t,n.onCompletion=function(){i.archer_corpse(e,t)},this.animations.push(n),n},e.prototype.archer_corpse=function(e,t){var i=new r.Animation([293]);return i.timeToChange=120,i.delay=4,i.areaToRender=new r.Rectangle(e.x,e.y,e.width,e.height),i.inverse=t,this.staticAnimations.push(i),i},e.prototype.player_sword_death_corpse=function(e,t){var i=new r.Animation([306]);return i.timeToChange=150,i.delay=6,i.areaToRender=new r.Rectangle(e.x,e.y,90,90),i.inverse=t,this.animations.push(i),i},e.prototype.player_sword_death_animation=function(e,t){var i=new r.Animation([301,302,303,304,305,306]);return i.inverse=t,i.timeToChange=150,i.repetitions=6,i.areaToRender=new r.Rectangle(e.x,e.y,90,90),this.animations.push(i),i},e.prototype.apprentice_Death=function(e,t){var i=this,n=new r.Animation([144,145,146,153,154,155]);return n.repetitions=5,n.inverse=t,n.timeToChange=150,n.areaToRender=new r.Rectangle(e.x,e.y,e.width,e.height),n.onCompletion=function(){i.apprentice_corpse(e,t)},this.animations.push(n),n},e.prototype.apprentice_corpse=function(e,t){var i=new r.Animation([155]);return i.inverse=t,i.timeToChange=150,i.areaToRender=new r.Rectangle(e.x,e.y,e.width,e.height),this.staticAnimations.push(i),i},e.prototype.masterSorcerer_death=function(e,t){var i=this,n=new r.Animation([586,587,589,590,591,592,593,594,595,596]);return n.repetitions=9,n.inverse=t,n.timeToChange=125,n.areaToRender=new r.Rectangle(e.x,e.y,e.width,e.height),n.onCompletion=function(){i.masterSorcerer_corpse(e,t)},this.animations.push(n),n},e.prototype.masterSorcerer_corpse=function(e,t){var i=new r.Animation([596]);return i.inverse=t,i.timeToChange=175,i.areaToRender=new r.Rectangle(e.x,e.y,e.width,e.height),this.staticAnimations.push(i),i},e.prototype.screamer_Death=function(e,t){var i=this,n=new r.Animation([576,577,578,579]);return n.repetitions=3,n.inverse=t,n.timeToChange=175,n.areaToRender=new r.Rectangle(e.x,e.y,e.width,e.height),n.onCompletion=function(){i.screamer_corpse(e,t)},this.animations.push(n),n},e.prototype.screamer_corpse=function(e,t){var i=new r.Animation([579]);return i.inverse=t,i.timeToChange=175,i.areaToRender=new r.Rectangle(e.x,e.y,e.width,e.height),this.staticAnimations.push(i),i},e.prototype.shadow_Death=function(e,t){var i=this,n=new r.Animation([132,130,127,124,119]);return n.repetitions=4,n.inverse=t,n.timeToChange=100,n.areaToRender=new r.Rectangle(e.x,e.y,e.width,e.height),n.onCompletion=function(){i.shadow_corpse(e,t)},this.animations.push(n),n},e.prototype.shadow_corpse=function(e,t){var i=new r.Animation([119]);return i.repetitions=4,i.inverse=t,i.timeToChange=100,i.areaToRender=new r.Rectangle(e.x,e.y,e.width,e.height),this.staticAnimations.push(i),i},e.prototype.swordman_corpse=function(e,t){var i=new r.Animation([219]);return i.timeToChange=120,i.delay=4,i.areaToRender=new r.Rectangle(e.x,e.y,56,59),i.inverse=t,this.staticAnimations.push(i),i},e.prototype.swordman_head=function(e,t){var i=new r.Animation([215,220,221,222,223,224,225,226]);return i.timeToChange=75,i.areaToRender=new r.Rectangle(e.x,e.y,56,59),i.inverse=t,this.animations.push(i),i},e.prototype.fireball_destroy=function(e,t){var i=new r.Animation([118,119,120,121,122,123,124,125,126]);return i.timeToChange=50,i.areaToRender=new r.Rectangle(e.x,e.y,t,t),i.repetitions=9,this.animations.push(i),i},e.prototype.necroball_explosion=function(e,t){this.particleHandler.createNecroballExplosion(e,t)},e.prototype.fireball_explosion=function(e,t){this.particleHandler.createFireballExplosion(e,t)},e.prototype.swordscut_a=function(e,t,i){var n=new r.Animation([55,56,57,58,59]);return n.inverse=i,n.areaToRender=new r.Rectangle(e.x,e.y,t,t),this.animations.push(n),n.repetitions=5,n},e.prototype.createDebugAnimation=function(e,t,i){var n=new r.Animation([5]);return n.areaToRender=new r.Rectangle(e.x,e.y,t,t),n.repetitions=i,this.animations.push(n),n},e.prototype.fallDeath=function(e){
this.bloodAnimation_A(new r.Vector(e.x,e.y+20),50),this.bloodAnimation_B_Right(new r.Vector(e.x+5,e.y+5),100),this.bloodAnimation_B_Left(new r.Vector(e.x-55,e.y+5),100)},e.prototype.fireDeathSwordman=function(e,t){var i=this,n=function(e){i.particleHandler.createFireDeath(e)},s=new r.FrameAnimation(0,-4,0,0,n,[250,251,252,253,254,255,256,257]);return s.inverse=t,s.timeToChange=100,s.areaToRender=new r.Rectangle(e.x,e.y,e.width,e.height),s.repetitions=8,this.animations.push(s),s},e.prototype.fireDeathArcher=function(e,t){var i=this,n=function(e){i.particleHandler.createFireDeath(e)},s=new r.FrameAnimation(0,-4,0,0,n,[282,283,284,285,286,287,288,289]);return s.inverse=t,s.timeToChange=100,s.areaToRender=new r.Rectangle(e.x,e.y,e.width,e.height),s.repetitions=8,this.animations.push(s),s},e.prototype.createArrow=function(e,t,i){var n=new r.RotationAnimation(i,[268]);return n.inverse=t,n.areaToRender=e,n.timeToChange=2e4,n.repetitions=1,this.dynamicAnimations.push(n),n},e.prototype.createDeadArrow=function(e,t,i){var n=new r.Vector(i.x,i.y),s=new r.StaticRotationAnimation(n,t,[268]);return s.inverse=t,s.areaToRender=new r.Rectangle(e.x,e.y,e.width,e.height),s.timeToChange=2e3,s.repetitions=1,this.dynamicAnimations.push(s),s},e.prototype.createArrowHit=function(e,t){var i=new r.Vector(e.velocity.x,e.velocity.y),n=new r.RotationAnimation(i,[269]);return n.inverse=e.animation.inverse,t?n.areaToRender=new r.Rectangle(e.collisionArea.x,e.collisionArea.y,e.area.width,e.area.height):n.areaToRender=new r.Rectangle(e.area.x,e.area.y,e.area.width,e.area.height),n.areaToRender.width=.67*n.areaToRender.width,n.timeToChange=2e3,n.repetitions=1,this.dynamicAnimations.push(n),n},e.prototype.frozenSwordMan=function(e,t,i,n){var s=new r.Animation([237,238,239,240,241,242]);return s.inverse=t,s.color=i,s.timeToChange=250,s.areaToRender=new r.Rectangle(e.x,e.y,e.width,e.height),s.onCompletion=n,this.animations.push(s),s.repetitions=6,s},e.prototype.frozenArcher=function(e,t,i,n){var s=new r.Animation([270,271,272,273,274,275]);return s.inverse=t,s.color=i,s.timeToChange=250,s.areaToRender=new r.Rectangle(e.x,e.y,e.width,e.height),s.onCompletion=n,this.animations.push(s),s.repetitions=6,s},e.prototype.frozenPart=function(e,t,i,n,s){var a=new r.Animation([s+n]);return a.inverse=t,a.color=i,a.timeToChange=2e3,a.areaToRender=new r.Rectangle(e.x,e.y,e.width,e.height),this.animations.push(a),a.repetitions=1,a},e.prototype.update=function(e){for(var t=[],i=this.animations.concat(this.dynamicAnimations),r=0,n=i;r<n.length;r++){var s=n[r];s.next(e),s.repetitions<=0&&(t.push(s),s.onCompletion&&s.onCompletion())}for(var a=0,o=t;a<o.length;a++){var h=o[a];this.remove(h)}},e.prototype.createDynamicRenderCall=function(e,t){for(var i=0,n=this.dynamicAnimations;i<n.length;i++){var s=n[i];if(s instanceof r.RotationAnimation||s instanceof r.StaticRotationAnimation){var a=s.areaToRender.x-t[0],o=s.areaToRender.y-t[1],h=s.areaToRender.width,c=s.areaToRender.height;s.inverse?e.vertecies=this.renderHelper.getInverseVertecies(a,o,h,c,e.vertecies):e.vertecies=this.renderHelper.getVertecies(a,o,h,c,e.vertecies),e.textureCoords.push.apply(e.textureCoords,s.getCurrentFrame()),e.matrices=this.renderHelper.getMatrices(a,o,h,c,s.angle,e.matrices),e.indecies=this.renderHelper.getIndecies(e.indecies)}}},e.prototype.createRenderCall=function(e){for(var t=0,i=this.animations;t<i.length;t++){var r=i[t];if(r.delay<=0){var n=r.areaToRender.x,s=r.areaToRender.y,a=r.areaToRender.width,o=r.areaToRender.height;r.inverse?e.vertecies=this.renderHelper.getInverseVertecies(n,s,a,o,e.vertecies):e.vertecies=this.renderHelper.getVertecies(n,s,a,o,e.vertecies),e.textureCoords.push.apply(e.textureCoords,r.getCurrentFrame()),e.indecies=this.renderHelper.getIndecies(e.indecies),r.color?e.color=this.renderHelper.getColor(e.color,r.color):e.color=this.renderHelper.getColor(e.color,null)}}return e},e.prototype.createStaticRenderCall=function(e){for(var t=0,i=this.staticAnimations;t<i.length;t++){var r=i[t];r.inverse?e.vertecies=this.renderHelper.getInverseVertecies(r.areaToRender.x,r.areaToRender.y,r.areaToRender.width,r.areaToRender.height,e.vertecies):e.vertecies=this.renderHelper.getVertecies(r.areaToRender.x,r.areaToRender.y,r.areaToRender.width,r.areaToRender.height,e.vertecies),e.textureCoords.push.apply(e.textureCoords,r.getCurrentFrame()),e.indecies=this.renderHelper.getIndecies(e.indecies)}return e},e.prototype.remove=function(e){var t=this.animations.indexOf(e);t!=-1?this.animations.splice(t,1):(t=this.dynamicAnimations.indexOf(e),t!=-1&&this.dynamicAnimations.splice(t,1))},e.prototype.enemy=function(e,t){var i=new r.Animation([209,211,210]);return i.timeToChange=120,i.areaToRender=new r.Rectangle(e.x,e.y,56,58),i.inverse=t,this.animations.push(i),i},e}();t.AnimationHandler=s},function(e,t,i){"use strict";var r=i(347),n=i(408),s=i(375),a=i(376),o=i(367),h=function(){function e(e,t){this.shieldLevel=t,this.projectiles=[],this.enemyProjectiles=[],this.collisionDetection=o.CollisionDetection.getInstance(),this.debuggHandler=n.DebugHandler.getInstance(),this.animationHandler=e}return e.prototype.clear=function(){this.projectiles=[],this.enemyProjectiles=[]},e.prototype.createArrow=function(e,t,i){var n,o,h=new r.Rectangle(e.x,e.y,40,10);o=t?new r.Rectangle(e.x+10,e.y+5,1,1):new r.Rectangle(e.x+20,e.y+5,1,1);var c=this.animationHandler.createArrow(h,t,i);return n=new r.PhysicalProjectile(i,h,c,1,o,!0),n.gravity=new s.Gravity(3e-4),n.drag=new a.Drag(0),n.projectileType=r.ProjectileType.Arrow,n.damage=20,this.enemyProjectiles.push(n),n},e.prototype.createNecroBall=function(e,t,i,n,s,a){var o;if(i){var h=new r.Rectangle(e.x+5,e.y,t,t);o=new r.ParticleProjectile(n,h,this.animationHandler.voidAnimation(),.2,10*t,i,0,a)}else{var h=new r.Rectangle(e.x+40,e.y,t,t);o=new r.ParticleProjectile(n,h,this.animationHandler.voidAnimation(),.2,10*t,i,0,a)}o.projectileType=r.ProjectileType.NecroBall,o.damage=s,o.distance=1e3,this.enemyProjectiles.push(o)},e.prototype.createDeadArrow=function(e,t,i,n){var o,h,c=new r.Rectangle(e.x,e.y,40,10);h=t?new r.Rectangle(e.x+10,e.y+5,1,1):new r.Rectangle(e.x+20,e.y+5,1,1);var l=this.animationHandler.createDeadArrow(c,t,i);return i.x=-i.x/2,n&&(i.x+=n.x,i.y+=n.y),o=new r.PhysicalProjectile(i,c,l,1,h),o.gravity=new s.Gravity(6e-4),o.drag=new a.Drag(2e-4),o.projectileType=r.ProjectileType.None,this.projectiles.push(o),o},e.prototype.createFireBall=function(e,t,i,n,s,a){var o;o=t?new r.ParticleProjectile(new r.Vector(-i,0),new r.Rectangle(e.x,e.y,n,n),this.animationHandler.voidAnimation(),.2,10*n,t,s,a):new r.ParticleProjectile(new r.Vector(i,0),new r.Rectangle(e.x,e.y,n,n),this.animationHandler.voidAnimation(),.2,10*n,t,s,a),this.projectiles.push(o)},e.prototype.createFireballRank1=function(e,t,i,n,s,a){var o;n/=3,o=t?new r.ParticleProjectile(new r.Vector(-i,0),new r.Rectangle(e.x,e.y,n,n),this.animationHandler.voidAnimation(),.2,10*n,t,s,a):new r.ParticleProjectile(new r.Vector(i,0),new r.Rectangle(e.x,e.y,n,n),this.animationHandler.voidAnimation(),.2,10*n,t,s,a),this.projectiles.push(o)},e.prototype.createCollisionProjectile=function(e,t,i,n,s){var a;i?(a=new r.Rectangle(e.x,e.y-10,10,10),s.x=-s.x):a=new r.Rectangle(e.x+t,e.y-10,10,10);var o=new r.CollisionProjectile(s,a,40,this.animationHandler.voidAnimation(),n);return o.projectileType=r.ProjectileType.Sword,this.enemyProjectiles.push(o),o},e.prototype.createSwordman_death=function(e,t,i){var n;n=new r.PhysicalProjectile(i,new r.Rectangle(e.x,e.y,28,29),this.animationHandler.swordman_head(e,t),.3),n.extendedOnGroundCollision=function(){var e=n.animation.getCurrentFrame();n.animation.textureCoords=[e],n.animation.frameIndex=0},this.animationHandler.bloodAnimation_C(new r.Vector(e.x-10,e.y-20),75),this.animationHandler.bloodAnimation_B_Left(new r.Vector(e.x-10,e.y-20),75),this.animationHandler.bloodAnimation_B_Right(new r.Vector(e.x-10,e.y-20),75),this.animationHandler.swordman_death(e,t),this.projectiles.push(n)},e.prototype.createPlayerSword_death=function(e,t){var i,n,s=new r.Vector(0,0),a=e.x;t&&(a-=45),i=new r.PhysicalProjectile(s,new r.Rectangle(a,e.y-6,45,85),this.animationHandler.player_sword_death_animation(e,t),1),n=new r.PhysicalProjectile(s,new r.Rectangle(a,e.y-6,45,85),this.animationHandler.player_sword_death_corpse(e,t),1),t?this.animationHandler.bloodAnimation_B_Left(new r.Vector(e.x-10,e.y-20),75):this.animationHandler.bloodAnimation_B_Right(new r.Vector(e.x-10,e.y-20),75),this.projectiles.push(i),this.projectiles.push(n)},e.prototype.createShadow_death=function(e,t){var i,n=new r.Vector(0,0),s=e.x;i=new r.PhysicalProjectile(n,new r.Rectangle(s,e.y-10,e.width,e.height),this.animationHandler.shadow_Death(e,t),.8),this.projectiles.push(i)},e.prototype.createMasterSorcerer_death=function(e,t){var i,n=new r.Vector(0,0),s=e.x;i=new r.PhysicalProjectile(n,new r.Rectangle(s,e.y-10,e.width,e.height),this.animationHandler.masterSorcerer_death(e,t),.8),this.projectiles.push(i)},e.prototype.createScreamer_death=function(e,t){var i,n=new r.Vector(0,0),s=e.x;i=new r.PhysicalProjectile(n,new r.Rectangle(s,e.y-10,e.width,e.height),this.animationHandler.screamer_Death(e,t),.8),this.projectiles.push(i)},e.prototype.createApprentice_death=function(e,t){var i,n=new r.Vector(0,0),s=e.x;i=new r.PhysicalProjectile(n,new r.Rectangle(s,e.y-10,e.width,e.height),this.animationHandler.apprentice_Death(e,t),.8),this.projectiles.push(i)},e.prototype.createFrozenSwordManDeath=function(e,t,i){var n=this,s=function(){for(var s=[new r.Vector(.15*Math.random(),.3*-Math.random()),new r.Vector(.15*Math.random(),.3*-Math.random()),new r.Vector(.15*Math.random(),.3*-Math.random()),new r.Vector(.15*-Math.random(),.3*-Math.random()),new r.Vector(.15*-Math.random(),.3*-Math.random()),new r.Vector(.15*-Math.random(),.3*-Math.random())],a=[new r.Rectangle(e.x+7,e.y+22,11,8),new r.Rectangle(e.x+12,e.y+5,12,12),new r.Rectangle(e.x+15,e.y+24,14,6),new r.Rectangle(e.x+13,e.y+38,6,8),new r.Rectangle(e.x+6,e.y+38,8,10),new r.Rectangle(e.x+4,e.y+11,13,16)],o=0;o<6;o++)n.createFrozenPart(s[o],e,t,i,o,243,a[o])};this.animationHandler.frozenSwordMan(e,t,i,s)},e.prototype.createFrozenArcherDeath=function(e,t,i){var n=this,s=function(){for(var s=[new r.Vector(.15*Math.random(),.3*-Math.random()),new r.Vector(.15*Math.random(),.3*-Math.random()),new r.Vector(.15*Math.random(),.3*-Math.random()),new r.Vector(.15*-Math.random(),.3*-Math.random()),new r.Vector(.15*-Math.random(),.3*-Math.random()),new r.Vector(.15*-Math.random(),.3*-Math.random())],a=[new r.Rectangle(e.x+8,e.y+2,11,6),new r.Rectangle(e.x+4,e.y+4,9,14),new r.Rectangle(e.x+17,e.y+3,11,11),new r.Rectangle(e.x+13,e.y+7,15,15),new r.Rectangle(e.x+5,e.y+15,13,17),new r.Rectangle(e.x+14,e.y+19,13,13)],o=0;o<6;o++)n.createFrozenPart(s[o],e,t,i,o,276,a[o])};this.animationHandler.frozenArcher(e,t,i,s)},e.prototype.update=function(e,t,i,r){var n=[],s=[];n=this.updateFriendslyProjectiles(e,t,r),s=this.updateEnemyProjectiles(e,i,t,r);for(var a=0,o=n;a<o.length;a++){var h=o[a];this.destroyProjectile(h,this.projectiles)}for(var c=0,l=s;c<l.length;c++){var h=l[c];this.destroyProjectile(h,this.enemyProjectiles)}},e.prototype.destroyProjectile=function(e,t){this.destroyAnimation(e),this.animationHandler.remove(e.animation);var i=t.indexOf(e);i!=-1&&t.splice(i,1)},e.prototype.calculateDirection=function(e,t){var i=new r.Vector(t.position.x+t.width/2-(e.x+e.width/2),t.position.y-(e.y+e.height/2));return i.normalize(),i.multiply(e.width/90),i},e.prototype.updateEnemyProjectiles=function(e,t,i,n){var s=[],a=[],o=t.getProjectileCollisionArea();a.push.apply(a,t.getShieldCollidables());for(var h=0,c=this.enemyProjectiles;h<c.length;h++){var l=c[h],u=new r.Vector(l.velocity.x*e,l.velocity.y*e);s=this.updateAndCollCheckEnemyProjectile(l,u,e,t,n,o,a,s),s=this.checkStaticObjectCollisions(l,u,i,s)}return s},e.prototype.updateAndCollCheckEnemyProjectile=function(e,t,i,n,s,a,o,h){var c,l,u;e.updateForces(i);var p=n.getVelocity(),d=new r.Vector(t.x-p.x*i,t.y-p.y*i);return c=this.collisionDetection.checkProjectileCollisionY([a],e,d,!1),l=this.collisionDetection.checkProjectileCollisionY(o,e,d,!1),e.update(0,c.collisionTimeY*t.y,i),u=l.groundCollision,l.groundCollision?(this.setShieldDamage(n,e),h.push(e)):c.groundCollision&&(o.length>0?this.setShieldDamage(n,e):this.setDamageAnimation(n,e),h.push(e)),e.projectileType==r.ProjectileType.Arrow?(c=this.collisionDetection.checkProjectileCollisionX([a],e,d,!1,!1),l=this.collisionDetection.checkProjectileCollisionX(o,e,d,!1,!1)):(c=this.collisionDetection.checkProjectileCollisionX([a],e,d,!1,!0),l=this.collisionDetection.checkProjectileCollisionX(o,e,d,!1,!0)),e.update(c.collisionTimeX*t.x,0,i),u||(l.wallCollision?(this.setShieldDamage(n,e),h.push(e)):c.wallCollision&&(o.length>0?this.setShieldDamage(n,e):this.setDamageAnimation(n,e),h.push(e))),(e instanceof r.CollisionProjectile||e instanceof r.ParticleProjectile)&&e.distance<=0&&h.push(e),this.collisionDetection.aabbCheckS(e.collisionArea,s.map(function(e){return e.tile}))&&h.push(e),h},e.prototype.setDamageAnimation=function(e,t){this.animationHandler.bloodAnimation_A(new r.Vector(t.collisionArea.x,t.collisionArea.y),20),t.projectileType==r.ProjectileType.Arrow?(this.createStickyArrowAnimation(e,t),e.takeDamage(t.damage)):t.projectileType==r.ProjectileType.Sword&&t instanceof r.CollisionProjectile?e.takeDamage(t.damage):(t.projectileType=r.ProjectileType.NecroBall)&&e.takeDamage(t.damage)},e.prototype.checkStaticObjectCollisions=function(e,t,i,r){var n;return n=this.collisionDetection.checkProjectileCollisionY(i,e,t,!0),n.groundCollision?(this.setStaticObjectAnimation(e),r.push(e)):(n=this.collisionDetection.checkProjectileCollisionX(i,e,t,!0,!1),n.wallCollision&&(this.setStaticObjectAnimation(e),r.push(e))),r},e.prototype.createStickyArrowAnimation=function(e,t){if(t.projectileType==r.ProjectileType.Arrow){var i=void 0;i=new r.Vector(e.position.x-t.area.x,e.position.y-t.area.y),e.damageAnimations.push(new r.StickyAnimation(this.animationHandler.createArrowHit(t,!0),i))}},e.prototype.setStaticObjectAnimation=function(e){e.projectileType==r.ProjectileType.Arrow&&this.animationHandler.createArrowHit(e,!1)},e.prototype.updateAndCollCheck=function(e,t,i,n,s){var a;e.updateForces(t);var o=new r.Vector(e.velocity.x*t,e.velocity.y*t);return a=this.collisionDetection.checkProjectileCollisionY(i,e,o,!0),e.update(0,a.collisionTimeY*o.y,t),e instanceof r.PhysicalProjectile&&a.groundCollision&&e.onGroundCollision(),a.groundCollision&&(e.velocity.y=0),a=this.collisionDetection.checkProjectileCollisionX(i,e,o,!0,!1),e.update(a.collisionTimeX*o.x,0,t),(e instanceof r.Spell||e instanceof r.ParticleProjectile)&&(e.distance<=0||a.wallCollision)&&n.push(e),a.wallCollision&&(e.velocity.x=0),this.collisionDetection.aabbCheckS(e.collisionArea,s.map(function(e){return e.tile}))&&n.push(e),n},e.prototype.updateFriendslyProjectiles=function(e,t,i){for(var r=[],n=0,s=this.projectiles;n<s.length;n++){var a=s[n];this.updateAndCollCheck(a,e,t,r,i)}return r},e.prototype.setShieldDamage=function(e,t){t.projectileType==r.ProjectileType.Arrow?(this.createDeadArrow(new r.Vector(t.area.x,t.area.y),t.animation.inverse,t.velocity),this.drainShield(e,t,t.damage)):t.projectileType==r.ProjectileType.Sword&&t instanceof r.CollisionProjectile?this.drainShield(e,t,t.damage):(t.projectileType=r.ProjectileType.NecroBall)&&this.drainShield(e,t,2*t.damage)},e.prototype.drainShield=function(e,t,i){if(e.mana>0){var r=void 0;r=0!=this.shieldLevel?i/this.shieldLevel:2*i,e.useMana(i+r)||(e.mana=0,t.area.x>e.position.x?e.shieldExplosion(!1):e.shieldExplosion(!0))}},e.prototype.destroyAnimation=function(e){e instanceof r.ParticleProjectile&&(e.projectileType==r.ProjectileType.NecroBall?this.animationHandler.necroball_explosion(new r.Vector(e.area.x,e.area.y),e.area.width):this.animationHandler.fireball_explosion(new r.Vector(e.area.x,e.area.y),e.area.width))},e.prototype.createFrozenPart=function(e,t,i,n,s,a,o){var h;h=new r.PhysicalProjectile(e,new r.Rectangle(t.x,t.y,t.width,t.width),this.animationHandler.frozenPart(t,i,n,s,a),1,o),this.projectiles.push(h)},e}();t.ProjectileHandler=h},function(e,t,i){"use strict";var r=i(347),n=i(367),s=i(357),a=i(391),o=function(){function e(){this.renderHelper=s.RenderHelper.getInstance(),this.collisionDetection=n.CollisionDetection.getInstance(),this.constants=a.Constants.getInstance()}return e.prototype.update=function(e,t){for(var i=0,n=this.dynamicTiles;i<n.length;i++){var s=n[i],a=void 0;a=s.verticalAxis?s.velocity.y*t:s.velocity.x*t,s.update(t,a),e.lift==s&&(s.velocity.y<0?e.position.y=s.tile.y-e.height:e.position.y=s.tile.y-e.height,e.liftVelocity=s.velocity,(e.position.x>s.tile.x+s.tile.width||e.position.x+e.width<s.tile.x)&&(e.lift=null,e.liftVelocity=new r.Vector(0,0)))}},e.prototype.createRenderCall=function(e){for(var t=0,i=this.dynamicTiles;t<i.length;t++){var r=i[t],n=e.get(r.tile.key);n||(e.set(r.tile.key,new s.RenderCall),n=e.get(r.tile.key)),n.vertecies=this.renderHelper.getVertecies(r.tile.x,r.tile.y,r.tile.width,r.tile.height,n.vertecies),n.textureCoords=this.renderHelper.getTiledTextureCoordinates(r.tile,n.textureCoords,this.constants.tileSize),n.indecies=this.renderHelper.getIndecies(n.indecies)}return e},e}();t.DynamicTileHandler=o},function(e,t,i){"use strict";var r=i(426),n=i(347),s=i(362),a=i(427),o=i(367),h=i(375),c=function(){function e(){this.frostParticles=[],this.frostEffectParticles=[],this.fireParticles=[],this.fireEffectParticles=[],this.necroEffectParticles=[],this.shieldEffectParticles=[],this.renderHelper=s.RenderHelper.getInstance(),this.collisionDetection=o.CollisionDetection.getInstance(),this.gravity=new h.Gravity(1e-4),this.noGravity=new h.Gravity(0),this.fireColor=[1,.5,.2,.8],this.frostColor=[.4,.9,.9,.9],this.frostEffectColor=[.7,.9,.9,.9],this.shieldColor=[.5,.4,.7,.7],this.necroColor=[0,.5,0,.8],this.flameParticleSettings=[2,5,500,700,.4,.5,-.05,-.03,.1],this.largeFlameParticleSettings=[4,6,500,700,.4,.5,-.05,-.03,.1],this.flameEffectSettings=[1,3,100,400,.3,.4,-.2,.05,0],this.channelMagicEffectSettings=[8,4,500,500,-10,10,.1,.1,-.2,0,2*Math.PI],this.fireExplosionSettings=[4,8,500,500,-20,20,.05,.2,-.2,0,2*Math.PI],this.magicEffectSettings=[1,3,300,300,-.01,.01,-.2,0,.1],this.frostParticleSettings=[3,5,600,800,.4,.5,-.02,.02,.2],this.largefrostParticleSettings=[5,7,600,800,.5,.6,-.02,.02,.2],this.frostEffectParticleSettings=[2,4,200,800,.4,.5,-.08,.05,0],this.burnEffectSettings=[10,15,100,400,.05,-.05,-.1,-.1,0],this.shieldEffectSettings=[2,4,200,200,10,10,.1,.1,.2,0,2*Math.PI],this.invertedShieldEffectSettings=[2,4,100,100,10,10,.1,.1,.2,.52*-Math.PI,1.3*-Math.PI],this.shieldExplosionEffectSettings=[4,8,1e3,1500,-20,20,-.2,.2,-.1,.52*-Math.PI,.3*Math.PI],this.invertedShieldExplosionEffectSettings=[4,8,1e3,1500,-20,20,-.2,.2,-.1,.52*-Math.PI,1.3*-Math.PI]}return e.prototype.createShieldExplosionEffect=function(e,t){e.y=e.y-5;var i=[];i=t?this.invertedShieldExplosionEffectSettings:this.shieldExplosionEffectSettings;var r=this.createCircleParticles(e,40,40,!1,i,100);(n=this.shieldEffectParticles).push.apply(n,r);var n},e.prototype.createShieldEffect=function(e,t,i){e.y=e.y+5;var r=this.createCenterCircleParticles(e,10,20,this.shieldEffectSettings,!1,0,0,100,0,1+i);(n=this.shieldEffectParticles).push.apply(n,r);var n},e.prototype.createFireBall=function(e,t,i,r){var n=this.fireBall(e,t,i,r);(s=this.fireEffectParticles).push.apply(s,n);var s},e.prototype.createNecroFireBall=function(e,t,i,r){var n=this.fireBall(e,t,i,r);(s=this.necroEffectParticles).push.apply(s,n);var s},e.prototype.createNecroballExplosion=function(e,t){var i=this.fireballExplosion(e,t);(r=this.necroEffectParticles).push.apply(r,i);var r},e.prototype.createFireballExplosion=function(e,t){var i=this.fireballExplosion(e,t);(r=this.fireEffectParticles).push.apply(r,i);var r},e.prototype.fireballExplosion=function(e,t){var i=t/2,r=2+t/20;e.x=e.x+i,e.y=e.y+i;var n=[r,2*r,500,500,-20,20,.05,.2,-.2,0,2*Math.PI],s=this.createCircleParticles(e,0,0,!1,n,50);return s},e.prototype.createChannelMagic=function(e,t){var i=new n.Vector(e.x+25,e.y+45),r=this.createCenterCircleParticles(i,30,40,this.channelMagicEffectSettings,!0,3,10,100,0,2);(s=this.fireEffectParticles).push.apply(s,r);var s},e.prototype.createNecroChannelMagic=function(e,t){var i;i=t?new n.Vector(e.x+27,e.y+10):new n.Vector(e.x+101,e.y+10);var r=this.createCenterCircleParticles(i,30,40,this.channelMagicEffectSettings,!0,3,10,100,0,2);(s=this.necroEffectParticles).push.apply(s,r);var s},e.prototype.createMagicEffect=function(e,t){var i=this.rand(-10,10)+22,r=this.rand(-5,10)+45,s=new n.Vector(e.x+i,e.y+r),a=this.createParticles(s,t,this.magicEffectSettings,1);(o=this.fireEffectParticles).push.apply(o,a);var o},e.prototype.createFrostBlast=function(e,t,i){var r=new n.Vector(e.x,e.y);r.y+=45,t?r.x+=10:r.x+=40;var s;s=3==i?this.largefrostParticleSettings:this.frostParticleSettings;var a=this.createParticles(r,t,s,3+3*i),o=this.createParticles(r,t,this.frostEffectParticleSettings,2+1*i);(h=this.frostEffectParticles).push.apply(h,o),(c=this.frostParticles).push.apply(c,a);var h,c},e.prototype.createFireBlast=function(e,t,i){var r=new n.Vector(e.x,e.y);r.y+=45,t?r.x+=10:r.x+=40;var s;s=3==i?this.largeFlameParticleSettings:this.flameParticleSettings;var a=this.createParticles(r,t,s,3+3*i),o=this.createParticles(r,t,this.flameEffectSettings,2+1*i);(h=this.fireParticles).push.apply(h,a),(c=this.fireEffectParticles).push.apply(c,o);var h,c},e.prototype.createBurn=function(e){var t=new n.Vector(e.x,e.y);t.x+=this.rand(-10,15)+25,t.y+=this.rand(-10,10)+25;var i=this.createParticles(t,!1,this.burnEffectSettings,1);(r=this.fireEffectParticles).push.apply(r,i);var r},e.prototype.createFireDeath=function(e){e.x+=this.rand(-15,15),e.x+=25,e.y+=25;var t=this.createParticles(e,!1,this.burnEffectSettings,5);(i=this.fireEffectParticles).push.apply(i,t);var i},e.prototype.update=function(e,t){this.updateEffectParticles(this.necroEffectParticles,e),this.updateEffectParticles(this.fireEffectParticles,e),this.updateEffectParticles(this.frostEffectParticles,e),this.updateEffectParticles(this.shieldEffectParticles,e),this.updateParticles(this.frostParticles,this.noGravity,e,t,n.SpellType.frostBlast),this.updateParticles(this.fireParticles,this.gravity,e,t,n.SpellType.fireBlast)},e.prototype.createRenderCalls=function(e){var t=new a.SimpleParticleRenderCall,i=this.fireParticles.concat(this.fireEffectParticles),r=new a.SimpleParticleRenderCall,s=new a.SimpleParticleRenderCall;s.textureType=n.TextureType.frostTexture;var o=new a.SimpleParticleRenderCall;o.textureType=n.TextureType.particleTexture;var h=new a.SimpleParticleRenderCall;return h.textureType=n.TextureType.particleTexture,e.push(this.addParticles(t,i,this.fireColor)),e.push(this.addParticles(s,this.frostEffectParticles,this.frostEffectColor)),e.push(this.addParticles(r,this.frostParticles,this.frostColor)),e.push(this.addParticles(o,this.shieldEffectParticles,this.shieldColor)),e.push(this.addParticles(h,this.necroEffectParticles,this.necroColor)),e},e.prototype.fireBall=function(e,t,i,r){var s=new n.Vector(e.x,e.y),a=t/2,o=a/2,h=a/10,c=t/100;i?s.x+=a-r:s.x+=a+r,s.y+=a;var l=[4+4*c,2+2*c,500,500,-10,10,0,0,-.2],u=this.createCenterCircleParticles(s,o,o,l,!1,h,a,200,-h,2);return u},e.prototype.addParticles=function(e,t,i){for(var r=0,n=t;r<n.length;r++){var s=n[r];(a=e.vertecies).push.apply(a,[s.area.x,s.area.y]),e.pointSize.push(s.area.width),e.color=i,e.itemCount=t.length}return e;var a},e.prototype.updateEffectParticles=function(e,t){for(var i=[],r=0,s=e;r<s.length;r++){var a=s[r];this.updateParticle(a,t);var o=a.area.width/2;new n.Rectangle(a.area.x,a.area.y,o,o);(a.lifeTime<=0||a.area.width<0||a.dead)&&i.push(a)}this.removeParticles(i,e)},e.prototype.updateParticles=function(e,t,i,r,s){for(var a=[],o=0,h=e;o<h.length;o++){var c=h[o];t.apply(c.velocity,i),this.updateParticle(c,i);var l=c.area.width/2,u=new n.Rectangle(c.area.x,c.area.y,l,l);if(!c.dead)for(var p=0,d=r;p<d.length;p++){var g=d[p];this.collisionDetection.aabbCheck(u,g.getCollisionArea())&&(s==n.SpellType.frostBlast?g.freeze():g.burn(),c.dead=!0,c.lifeTime=c.lifeTime>10?this.rand(10,20):c.lifeTime)}(c.lifeTime<=0||c.area.width<0)&&a.push(c)}this.removeParticles(a,e)},e.prototype.removeParticles=function(e,t){for(var i=0,r=e;i<r.length;i++){var n=r[i],s=t.indexOf(n);s!=-1&&t.splice(s,1)}},e.prototype.updateParticle=function(e,t){e.area.x+=e.velocity.x*t,e.area.y+=e.velocity.y*t,e.lifeTime-=t,e.area.width+=e.growth,e.area.height+=e.growth},e.prototype.createParticles=function(e,t,i,s){for(var a=[],o=0;o<s;o++){var h=this.rand(i[0],i[1]),c=void 0,l=void 0,u=void 0;t?(c=new n.Vector(-this.rand(i[4],i[5]),this.rand(i[6],i[7])),l=new n.Rectangle(e.x,e.y,h,h),u=this.collisionDetection.getClosestX(new n.Rectangle(l.x-i[3],l.y-8,i[3],1),this.tiles,t)-l.x):(c=new n.Vector(this.rand(i[4],i[5]),this.rand(i[6],i[7])),l=new n.Rectangle(e.x,e.y,h,h),u=this.collisionDetection.getClosestX(new n.Rectangle(l.x,l.y-8,i[3],1),this.tiles,t)-l.x);var p=void 0,d=Math.abs(u/c.x);p=d<i[3]?d<i[2]?this.rand(d,d+10):this.rand(i[2],d+10):this.rand(i[2],i[3]);var g=i[8],f=new r.Particle(l,p,c,g);a.push(f)}return a},e.prototype.createCenterCircleParticles=function(e,t,i,s,a,o,h,c,l,u){var p=[],d=this.rand(-o,o),g=this.rand(-o,o),f=new r.Particle(new n.Rectangle(e.x+d,e.y+g,h,h),c,new n.Vector(0,0),l);return p.push(f),p.push.apply(p,this.createCircleParticles(e,t,i,a,s,u)),p},e.prototype.createCircleParticles=function(e,t,i,s,a,o){for(var h=[],c=0;c<o;c++){var l=this.rand(a[0],a[1]),u=this.rand(a[2],a[3]),p=this.rand(a[4],a[5]),d=void 0,g=void 0,f=void 0,x=this.rand(a[9],a[10]);d=e.x+(t+p)*Math.cos(x),g=e.y+(i+p)*Math.sin(x),f=s?new n.Vector(-(d-e.x),-(g-e.y)):new n.Vector(d-e.x,g-e.y),f.normalize(),f.multiply(this.rand(a[6],a[7]));var y=new r.Particle(new n.Rectangle(d,g,l,l),u,f,a[8]);h.push(y)}return h},e.prototype.rand=function(e,t){return e+Math.random()*(t-e)},e}();t.ParticleHandler=c},function(e,t){"use strict";var i=function(){function e(e,t,i,r){this.area=e,this.lifeTime=t,this.velocity=i,this.growth=r}return e}();t.Particle=i},function(e,t,i){"use strict";var r=i(347),n=function(){function e(){this.vertecies=[],this.pointSize=[],this.color=[],this.itemCount=0,this.textureType=r.TextureType.particleTexture}return e}();t.SimpleParticleRenderCall=n},function(e,t,i){"use strict";var r=i(347),n=function(){function e(e){this.context=e,this.gl=this.context.gl,this.shaderProgram=this.context.simpleParticleProgram,this.gl.useProgram(this.shaderProgram),this.gl.bindAttribLocation(this.shaderProgram,0,"a_position"),this.gl.bindAttribLocation(this.shaderProgram,1,"a_pointSize"),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"a_position"),this.sizeAttributeLocation=this.gl.getAttribLocation(this.shaderProgram,"a_pointSize"),this.resolutionLocation=this.gl.getUniformLocation(this.shaderProgram,"u_resolution"),this.cameraLocation=this.gl.getUniformLocation(this.shaderProgram,"u_camera"),this.colorUniformLocation=this.gl.getUniformLocation(this.shaderProgram,"u_color"),this.vertexBuffer=this.gl.createBuffer(),this.pointSizeBuffer=this.gl.createBuffer()}return e.prototype.render=function(e,t){this.gl.useProgram(this.shaderProgram);for(var i=0,n=e;i<n.length;i++){var s=n[i];s.itemCount>1&&(this.gl.enableVertexAttribArray(this.positionLocation),this.gl.enableVertexAttribArray(this.sizeAttributeLocation),this.gl.uniform2f(this.resolutionLocation,this.context.gl.canvas.width,this.context.gl.canvas.height),this.gl.uniform2f(this.cameraLocation,t[0],t[1]),this.gl.uniform4f(this.colorUniformLocation,s.color[0],s.color[1],s.color[2],s.color[3]),s.textureType==r.TextureType.particleTexture?this.gl.bindTexture(this.gl.TEXTURE_2D,this.context.genericParticleTexture):s.textureType==r.TextureType.frostTexture&&this.gl.bindTexture(this.gl.TEXTURE_2D,this.context.frostParticelTexture),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(s.vertecies),this.gl.STATIC_DRAW),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.pointSizeBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(s.pointSize),this.gl.STATIC_DRAW),this.gl.enableVertexAttribArray(this.sizeAttributeLocation),this.gl.vertexAttribPointer(this.sizeAttributeLocation,1,this.gl.FLOAT,!1,0,0),this.gl.drawArrays(this.gl.POINTS,0,s.itemCount),this.gl.disableVertexAttribArray(this.positionLocation),this.gl.disableVertexAttribArray(this.sizeAttributeLocation))}},e}();t.SimpleParticleRenderer=n},function(e,t,i){"use strict";var r=i(347),n=i(405),s=i(401),a=i(357),o=i(367),h=i(404),c=function(){function e(e,t,i,r){this.enemies=[],this.renderHelper=a.RenderHelper.getInstance(),this.collisionDetection=o.CollisionDetection.getInstance(),this.context=e,this.projectileHandler=t,this.animationHandler=i,this.particleHandler=r}return e.prototype.update=function(e,t,i){for(var r=0,n=this.enemies;r<n.length;r++){var s=n[r];s.update(e,t,i),this.enemyCollisionCheck(e),this.checkBurn(s),this.checkEnemyDeath(s)}},e.prototype.createRenderCall=function(e){for(var t=0,i=this.enemies;t<i.length;t++){var r=i[t];r.inverse?e.vertecies=this.renderHelper.getInverseVertecies(r.position.x,r.position.y,r.width,r.height,e.vertecies):e.vertecies=this.renderHelper.getVertecies(r.position.x,r.position.y,r.width,r.height,e.vertecies),e.textureCoords.push.apply(e.textureCoords,r.currentAnimation.getCurrentFrame()),e.indecies=this.renderHelper.getIndecies(e.indecies),e.color=this.renderHelper.getColor(e.color,r.color)}return e},e.prototype.remove=function(e){var t=this.enemies.indexOf(e);t>=0&&this.enemies.splice(t,1)},e.prototype.checkBurn=function(e){if(e.burnValue>0){var t=e.getCollisionArea(),i=new r.Vector(t.x,t.y);this.particleHandler.createBurn(i)}},e.prototype.checkEnemyDeath=function(e){e.dead&&(e.deathType==h.DeathType.freezeDeath?(e instanceof n.Swordman?this.projectileHandler.createFrozenSwordManDeath(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse,e.color):e instanceof s.Archer?this.projectileHandler.createFrozenArcherDeath(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse,e.color):e instanceof s.Shadow?this.projectileHandler.createShadow_death(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse):e instanceof s.Apprentice?this.projectileHandler.createApprentice_death(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse):e instanceof s.Screamer?this.projectileHandler.createScreamer_death(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse):e instanceof s.MasterSorcerer&&this.projectileHandler.createMasterSorcerer_death(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse),this.remove(e)):e.deathType==h.DeathType.fireDeath?(e instanceof n.Swordman?this.animationHandler.fireDeathSwordman(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse):e instanceof s.Archer?this.animationHandler.fireDeathArcher(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse):e instanceof s.Shadow?this.projectileHandler.createShadow_death(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse):e instanceof s.Apprentice?this.projectileHandler.createApprentice_death(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse):e instanceof s.Screamer?this.projectileHandler.createScreamer_death(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse):e instanceof s.MasterSorcerer&&this.projectileHandler.createMasterSorcerer_death(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse),this.remove(e)):e.deathType==h.DeathType.swordDeath&&(e instanceof s.Archer?this.animationHandler.createArcherDeath(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse):e instanceof s.Shadow?this.projectileHandler.createShadow_death(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse):e instanceof s.Apprentice?this.projectileHandler.createApprentice_death(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse):e instanceof s.Screamer?this.projectileHandler.createScreamer_death(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse):e instanceof s.MasterSorcerer&&this.projectileHandler.createMasterSorcerer_death(new r.Rectangle(e.position.x,e.position.y,e.width,e.height),e.inverse),
this.remove(e)))},e.prototype.enemyCollisionCheck=function(e){for(var t=0,i=this.projectileHandler.projectiles;t<i.length;t++){var s=i[t];if(s instanceof r.ParticleProjectile){for(var a=[],o=0,h=this.enemies;o<h.length;o++){var c=h[o],l=new r.Vector(s.velocity.x*e-c.toMove.x,s.velocity.y*e-c.toMove.y),u=this.collisionDetection.checkProjectileCollisionX([c.getCollisionArea()],s,l,!1,!0);u.wallCollision&&(c.takeDamage(s.area.width,r.SpellType.fireball),c.inverse?this.animationHandler.bloodAnimation_B_Right(new r.Vector(s.area.x,s.area.y-20),75):this.animationHandler.bloodAnimation_B_Left(new r.Vector(s.area.x-s.area.width,s.area.y-20),75),this.projectileHandler.destroyProjectile(s,this.projectileHandler.projectiles),c.dead&&c instanceof n.Swordman&&(this.projectileHandler.createSwordman_death(c.position,c.inverse,this.projectileHandler.calculateDirection(s.area,c)),a.push(c)))}for(var p=0,d=a;p<d.length;p++){var c=d[p];this.remove(c)}}}},e}();t.EnemyHandler=c},function(e,t){"use strict";var i=function(){function e(e,t,i){this.position=e,this.sceneSize=t,this.gameSize=i,this.cameraOffset=[800,500],this.position=e,this.sceneSize=t,this.maxX=100+(this.sceneSize[0]-this.cameraOffset[0]),this.maxXCameraPosition=this.gameSize[0]-(this.maxX+this.cameraOffset[0]-100),this.maxY=this.sceneSize[1]-this.cameraOffset[1],this.maxYCameraPosition=this.gameSize[1]-(this.maxY+this.cameraOffset[1])}return e.prototype.update=function(e){e.x-this.position[0]>this.cameraOffset[0]-100?(this.position[0]=e.x-this.cameraOffset[0]+100,e.x+this.maxX>this.gameSize[0]&&(this.position[0]=this.maxXCameraPosition)):e.x-this.position[0]<this.sceneSize[0]-this.cameraOffset[0]&&(this.position[0]=e.x-(this.sceneSize[0]-this.cameraOffset[0]),this.position[0]<0&&(this.position[0]=0)),e.y-this.position[1]>this.cameraOffset[1]?(this.position[1]=e.y-this.cameraOffset[1],e.y+this.maxY>this.gameSize[1]&&(this.position[1]=this.maxYCameraPosition)):e.y-this.position[1]<this.sceneSize[1]-this.cameraOffset[1]&&(this.position[1]=e.y-(this.sceneSize[1]-this.cameraOffset[1]),this.position[1]<0&&(this.position[1]=0))},e}();t.Camera=i},function(e,t){"use strict";var i=function(){function e(e){this.context=e,this.gl=this.context.gl,this.shaderProgram=this.context.dynamicVertecyProgram,this.gl.useProgram(this.shaderProgram),this.gl.bindAttribLocation(this.shaderProgram,0,"a_position"),this.gl.bindAttribLocation(this.shaderProgram,1,"a_texture_coord"),this.gl.bindAttribLocation(this.shaderProgram,2,"a_matrix"),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"a_position"),this.textureCoordAttribute=this.gl.getAttribLocation(this.shaderProgram,"a_texture_coord"),this.matrixAttributeLocation=this.gl.getAttribLocation(this.shaderProgram,"a_matrix"),this.vertexBuffer=this.gl.createBuffer(),this.textureCoordBuffer=this.gl.createBuffer(),this.indeciesBuffer=this.gl.createBuffer(),this.matricesBuffer=this.gl.createBuffer()}return e.prototype.render=function(e){this.gl.useProgram(this.shaderProgram);for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r.vertecies.length>0){this.gl.enableVertexAttribArray(this.positionLocation),this.gl.enableVertexAttribArray(this.textureCoordAttribute),this.gl.enableVertexAttribArray(this.matrixAttributeLocation),this.gl.enableVertexAttribArray(this.matrixAttributeLocation+1),this.gl.enableVertexAttribArray(this.matrixAttributeLocation+2),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(r.vertecies),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.textureCoordBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(r.textureCoords),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.matricesBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(r.matrices),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indeciesBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(r.indecies),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.textureCoordBuffer),this.gl.vertexAttribPointer(this.textureCoordAttribute,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.matricesBuffer);for(var n=0;n<3;n++)this.gl.vertexAttribPointer(this.matrixAttributeLocation+n,3,this.gl.FLOAT,!1,36,12*n);this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.context.glTexture),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indeciesBuffer),this.gl.drawElements(this.gl.TRIANGLES,r.indecies.length,this.gl.UNSIGNED_SHORT,0),this.gl.disableVertexAttribArray(this.positionLocation),this.gl.disableVertexAttribArray(this.textureCoordAttribute),this.gl.disableVertexAttribArray(this.matrixAttributeLocation),this.gl.disableVertexAttribArray(this.matrixAttributeLocation+1),this.gl.disableVertexAttribArray(this.matrixAttributeLocation+2)}}},e}();t.DynamicRenderer=i},function(e,t,i){"use strict";var r=i(347),n=i(357),s=i(433),a=function(){function e(e,t){this.renderHelper=n.RenderHelper.getInstance(),this.bars=[],this.hpBar=new s.ProgressBar,this.manaBar=new s.ProgressBar,this.hudTextureCoords=this.renderHelper.getTextureCoordinates([],198),this.hpBar.bar=new s.Bar(new r.Rectangle(100,8,298,16),298,new r.Rectangle(1632,96,200,12),200),this.hpBar.maxValue=e,this.manaBar.bar=new s.Bar(new r.Rectangle(100,34,298,16),298,new r.Rectangle(1632,128,200,12),200),this.manaBar.maxValue=t,this.bars.push(this.hpBar.bar),this.bars.push(this.manaBar.bar)}return e.prototype.update=function(e,t){var i=e/this.hpBar.maxValue;this.hpBar.bar.area.width=i*this.hpBar.bar.maxWidth,this.hpBar.bar.textureArea.width=i*this.hpBar.bar.maxTextureWidth;var r=t/this.manaBar.maxValue;this.manaBar.bar.area.width=r*this.manaBar.bar.maxWidth,this.manaBar.bar.textureArea.width=r*this.manaBar.bar.maxTextureWidth},e.prototype.createRenderCall=function(e,t){e.vertecies=this.renderHelper.getVertecies(0+t[0],0+t[1],405,96,e.vertecies),e.textureCoords.push.apply(e.textureCoords,this.hudTextureCoords),e.indecies=this.renderHelper.getIndecies(e.indecies);for(var i=0,r=this.bars;i<r.length;i++){var n=r[i];e.vertecies=this.renderHelper.getVertecies(n.area.x+t[0],n.area.y+t[1],n.area.width,n.area.height,e.vertecies),e.textureCoords.push.apply(e.textureCoords,this.renderHelper.getMainTextureCoords(n.textureArea)),e.indecies=this.renderHelper.getIndecies(e.indecies)}return e},e}();t.UI=a},function(e,t){"use strict";var i=function(){function e(e,t,i,r){this.area=e,this.maxWidth=t,this.textureArea=i,this.maxTextureWidth=r}return e}();t.Bar=i;var r=function(){function e(){}return e}();t.ProgressBar=r},function(e,t,i){"use strict";var r=i(357),n=i(435),s=i(436),a=i(439),o=i(440),h=i(441),c=i(347),l=i(346),u=i(438),p=i(2),d=i(442),g=i(444),f=i(445),x=function(){function e(e,t,i,a){this.renderer=e,this.canvasSize=t,this.canvas=i,this.game=a,this.started=!1,this.currentScene=n.SceneIndex.StartMenu,this.lastCurrentScene=n.SceneIndex.StartMenu,this.scenes=new Map,this.mousePosition=[-100,0],this.renderHelper=r.RenderHelper.getInstance(),this.click=!1,this.clicked=!1,this.importClicked=!1,this.playerlist=document.getElementById("playerlist"),this.textInput=document.getElementById("textinput"),this.textArea=document.getElementById("textarea"),this.fileUploadButton=document.getElementById("fileupload"),this.fileUploadButtonHighlight=document.getElementById("fileuploadHighlight"),this.uploadInput=document.getElementById("importLink"),this.modal=document.getElementById("modal"),this.loadHelper=l.LoadHelper.getInstance(),this.localStorageHelper=u.LocalStorageHelper.getInstance(),this.assetLoader=new p.AssetsLoader;var o=new s.Menu([this.createNewGameButton(),this.createContinueButton(),this.createLoadButton()],[],this,this.textArea,e,t,100,[512,512],!0);o.load(),this.scenes.set(n.SceneIndex.StartMenu,o);var h=new s.Menu([this.createToStartMenuBack(new c.Rectangle(this.canvasSize[0]/2-150,235,300,50))],[],this,this.textArea,e,t,100,[512,512],!0);this.scenes.set(n.SceneIndex.LoadMenu,h),this.loadLevelSelectionScreen(),this.loadLevelFinishedScreen(),this.loadNewGameMenu(),this.loadRestartMenu(),this.createEventListerners()}return e.prototype.update=function(){var e=this.scenes.get(this.currentScene);this.currentScene!=this.lastCurrentScene&&(this.textArea.style.visibility="hidden",e.load()),this.lastCurrentScene=this.currentScene,this.click&&!this.clicked&&(this.clicked=!0,e.click(this.mousePosition)),e.mouseOver(this.mousePosition)},e.prototype.render=function(){this.scenes.get(this.currentScene).render(),this.renderer.render(this.createMouseRenderCall(),[0,0])},e.prototype.setCurrentLevel=function(e){var t=this.scenes.get(n.SceneIndex.RestartMenu);isNaN(+e)||(t.currentLevel=+e)},e.prototype.createMouseRenderCall=function(){var e=new Map,t=new r.RenderCall;return t.vertecies=this.renderHelper.getVertecies(this.mousePosition[0],this.mousePosition[1],32,32,t.vertecies),t.indecies=this.renderHelper.getIndecies(t.indecies),t.textureCoords=this.renderHelper.getTextureCoordinates(t.textureCoords,180),e.set(-1,t),e},e.prototype.loadLevelFinishedScreen=function(){var e=new d.PowerSelectionMenu(this,this.textArea,this.renderer,this.canvasSize,100,[512,512],!1,[this.createNextLevelButton(!1),this.createToStartMenuBack(new c.Rectangle(this.canvasSize[0]/2-450,650,250,42))],[],[this.newPowerSelector(150,100,150,[105,102,106,103,107,104]),this.newPowerSelector(350,100,150,[111,108,112,109,113,110]),this.newPowerSelector(550,100,150,[117,114,118,115,119,116])]);this.scenes.set(n.SceneIndex.LevelFinished,e)},e.prototype.loadRestartMenu=function(){var e=new f.RestartMenu([this.createToStartMenuBack(new c.Rectangle(this.canvasSize[0]/2-450,650,250,42))],[],this,this.textArea,this.renderer,this.canvasSize,100,[512,512],!1,this.game);this.scenes.set(n.SceneIndex.RestartMenu,e)},e.prototype.loadNewGameMenu=function(){var e=new g.NewGameMenu([this.createToStartMenuBack(new c.Rectangle(this.canvasSize[0]/2-450,650,250,42)),this.createToPowerSelectorMenuButton(!0)],[],this,this.textArea,this.renderer,this.canvasSize,100,[512,512],!1,this.textInput,this.playerlist);this.scenes.set(n.SceneIndex.NewGameMenu,e)},e.prototype.newPowerSelector=function(e,t,i,r){var n=new h.Active(0,1,!1,new c.Rectangle(e,t,100,100),r[0],r[1],[100,100]),s=new h.Active(0,2,!1,new c.Rectangle(e,t+i,100,100),r[2],r[3],[100,100]),a=new h.Active(0,3,!1,new c.Rectangle(e,t+2*i,100,100),r[4],r[5],[100,100]);return new o.PowerSelector([n,s,a])},e.prototype.loadLevelSelectionScreen=function(){var e=new s.Menu(this.createLevelMenuButtons().concat([this.createToStartMenuBackFromLevelMenu()]),[],this,this.textArea,this.renderer,this.canvasSize,100,[512,512],!1);return this.scenes.set(n.SceneIndex.LevelSelection,e),e},e.prototype.createEventListerners=function(){var e=this;window.addEventListener("mousemove",function(t){var i=e.canvas.getBoundingClientRect(),r=t.clientX-i.left,n=t.clientY-i.top;e.mousePosition=[r,n]}),window.addEventListener("mousedown",function(t){e.click=!0}),window.addEventListener("mouseup",function(t){e.clicked=!1,e.click=!1}),this.uploadInput.addEventListener("change",function(){var t=new FileReader;t.onload=function(t){e.uploadInput.value="";var i=t.target;try{var r=JSON.parse(i.result);if(e.loadHelper.validateLevelData(r)){e.game.loadLevel(r);var s=e.scenes.get(n.SceneIndex.RestartMenu);s.tempLevel=r,e.started=!0,e.fileUploadButton.style.visibility="hidden",e.fileUploadButtonHighlight.style.visibility="hidden"}else e.modal.style.display="block",e.modal.innerHTML+="Invalid level data!"}catch(t){e.modal.style.display="block",e.modal.innerHTML+="Error loading level!"}},t.readAsText(e.uploadInput.files[0],"UTF-8")})},e.prototype.levelCompleted=function(e){this.started=!1,this.localStorageHelper.setCurrentProgress(+e+1),this.currentScene=n.SceneIndex.LevelFinished,this.scenes.get(this.currentScene).load()},e.prototype.createLoadButton=function(){var e=this,t=function(){e.currentScene=n.SceneIndex.LoadMenu,e.fileUploadButton.style.visibility="visible"};return new a.Clickable(new c.Rectangle(this.canvasSize[0]/2-150,295,300,50),179,181,183,t)},e.prototype.createNextLevelButton=function(e){var t,i=this,r=function(){i.textInput.style.visibility="hidden",i.textArea.style.visibility="hidden",i.playerlist.style.visibility="hidden";var e=i.localStorageHelper.getCurrentProgress();i.assetLoader.getLevel(e.completedLevels.toString()).subscribe(function(e){i.game.loadLevel(e),i.started=!0})};return t=e?new a.Clickable(new c.Rectangle(this.canvasSize[0]/2+200,650,250,42),179,181,553,r,554):new a.Clickable(new c.Rectangle(this.canvasSize[0]/2+200,650,250,42),179,181,553,r)},e.prototype.createToPowerSelectorMenuButton=function(e){var t,i=this,r=function(){i.textInput.style.visibility="hidden",i.textArea.style.visibility="hidden",i.playerlist.style.visibility="hidden",i.currentScene=n.SceneIndex.LevelFinished};return t=e?new a.Clickable(new c.Rectangle(this.canvasSize[0]/2+200,650,250,42),179,181,553,r,554):new a.Clickable(new c.Rectangle(this.canvasSize[0]/2+200,650,250,42),179,181,553,r)},e.prototype.createNewGameButton=function(){var e=this,t=function(){e.currentScene=n.SceneIndex.NewGameMenu};return new a.Clickable(new c.Rectangle(this.canvasSize[0]/2-150,175,300,50),179,181,182,t)},e.prototype.createContinueButton=function(){var e=this,t=function(){e.currentScene=n.SceneIndex.LevelSelection};return new a.Clickable(new c.Rectangle(this.canvasSize[0]/2-150,235,300,50),179,181,184,t,554)},e.prototype.createToStartMenuBack=function(e){var t=this,i=function(){t.currentScene=n.SceneIndex.StartMenu,t.fileUploadButton.style.visibility="hidden",t.fileUploadButtonHighlight.style.visibility="hidden",t.textArea.style.visibility="hidden",t.textInput.style.visibility="hidden",t.playerlist.style.visibility="hidden"};return new a.Clickable(e,179,181,186,i)},e.prototype.createToStartMenuBackFromLevelMenu=function(){var e=this,t=function(){e.currentScene=n.SceneIndex.StartMenu};return new a.Clickable(new c.Rectangle(this.canvasSize[0]/2-150,700,300,50),179,181,186,t)},e.prototype.createLevelMenuButtons=function(){for(var e=this.localStorageHelper.getCurrentProgress(),t=[],i=5,r=0;r<10;r++){var n=Math.floor(r/i),s=r%i,a=!(e.completedLevels>=r);t.push(this.createLevelButton(s,n,r,a))}return t},e.prototype.createLevelButton=function(e,t,i,r){var n,s=this;n=r?function(){}:function(){s.assetLoader.getLevel(i.toString()).subscribe(function(e){s.game.loadLevel(e),s.started=!0})};var o;return o=r?187:550,new a.Clickable(new c.Rectangle(100+200*e,100+200*t,200,100),o,o,188+i,n)},e}();t.SceneHandler=x},function(e,t){"use strict";!function(e){e[e.StartMenu=1]="StartMenu",e[e.LoadMenu=2]="LoadMenu",e[e.LevelFinished=3]="LevelFinished",e[e.NewGameMenu=4]="NewGameMenu",e[e.LevelSelection=5]="LevelSelection",e[e.RestartMenu=6]="RestartMenu"}(t.SceneIndex||(t.SceneIndex={}));t.SceneIndex},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(357),s=i(437),a=i(435),o=i(438),h=function(e){function t(t,i,r,n,s,a,o,h,c){e.call(this,r,s,a,o,h,c),this.clickables=t,this.text=i,this.sceneHandler=r,this.textArea=n,this.renderer=s,this.canvasSize=a,this.background=o,this.tileSize=h,this.menu=c,this.createRenderCalls()}return r(t,e),t.prototype.update=function(){},t.prototype.load=function(){this.sceneHandler.currentScene==a.SceneIndex.StartMenu&&(o.LocalStorageHelper.getInstance().getProgression().length>0?this.clickables[1].disabled=!1:this.clickables[1].disabled=!0)},t.prototype.render=function(){for(var t=new n.RenderCall,i=0,r=this.clickables;i<r.length;i++){var s=r[i];t=s.createRenderCall(t)}for(var a=0,o=this.text;a<o.length;a++){var h=o[a];t.vertecies=this.renderHelper.getVertecies(h.x,h.y,h.width,h.height,t.vertecies),t.indecies=this.renderHelper.getIndecies(t.indecies),t.textureCoords=this.renderHelper.getTextureCoordinates(t.textureCoords,h.key)}this.renderCalls.set(-1,t),this.renderer.render(this.renderCalls,[0,0]),e.prototype.render.call(this)},t.prototype.click=function(e){for(var t=0,i=this.clickables;t<i.length;t++){var r=i[t];r.click(e)}},t.prototype.mouseOver=function(e){for(var t=0,i=this.clickables;t<i.length;t++){var r=i[t];r.mouseOver(e)}},t.prototype.createRenderCalls=function(){e.prototype.createRenderCalls.call(this)},t}(s.Scene);t.Menu=h},function(e,t,i){"use strict";var r=i(357),n=i(347),s=i(362),a=function(){function e(e,t,i,r,n,a){this.sceneHandler=e,this.renderer=t,this.canvasSize=i,this.background=r,this.tileSize=n,this.menu=a,this.renderCalls=new Map,this.renderHelper=s.RenderHelper.getInstance()}return e.prototype.update=function(){},e.prototype.render=function(){this.renderCalls=new Map,this.createRenderCalls()},e.prototype.load=function(){},e.prototype.click=function(e){},e.prototype.mouseOver=function(e){},e.prototype.createRenderCalls=function(){this.renderCalls=this.createBackGround(this.renderCalls),this.menu&&(this.renderCalls=this.createMenu(this.renderCalls))},e.prototype.createMenu=function(e){var t=new r.RenderCall;return t.vertecies=this.renderHelper.getVertecies(this.canvasSize[0]/2-256,50,512,700,t.vertecies),t.indecies=this.renderHelper.getIndecies(t.indecies),t.textureCoords=this.renderHelper.getTiledTextureCoordinates(new n.Rectangle(0,0,288,295),t.textureCoords,[512,512]),t.key=101,e.set(t.key,t),e},e.prototype.createBackGround=function(e){var t=new r.RenderCall;return t.vertecies=this.renderHelper.getVertecies(0,0,this.canvasSize[0],this.canvasSize[1],t.vertecies),t.indecies=this.renderHelper.getIndecies(t.indecies),t.textureCoords=this.renderHelper.getTiledTextureCoordinates(new n.Rectangle(0,0,this.canvasSize[0],this.canvasSize[0]),t.textureCoords,this.tileSize),t.key=this.background,e.set(t.key,t),e},e}();t.Scene=a},function(e,t,i){"use strict";var r=i(347),n=function(){function e(){this.progressionKey="progression"}return e.prototype.constrcuctor=function(){if(e.instance)throw new Error("Static class cant be instanced!");e.instance=this},e.getInstance=function(){return e.instance},e.prototype.newPlayer=function(e){for(var t=this.getProgression(),i=0,n=t;i<n.length;i++){var s=n[i];s.active=!1,this.saveProgress(s)}var a=new r.Progress;a.playerName=e,a.active=!0,a.completedLevels=0,a.level=1,a.fire=0,a.frost=0,a.defence=0,a.hp=0,a.mana=0,this.saveProgress(a)},e.prototype.setPowers=function(e,t,i){var r=this.getCurrentProgress();r.fire=e,r.frost=t,r.defence=i,this.saveProgress(r)},e.prototype.setCurrentProgress=function(e){var t=this.getCurrentProgress();t.level++,t.completedLevels<e&&(t.completedLevels=e),this.saveProgress(t)},e.prototype.getProgression=function(){var e=this.getItem(this.progressionKey);return null==e&&(e=[]),e},e.prototype.getCurrentProgress=function(){var e=this.getItem(this.progressionKey);return e||(e=[this.defaultProgress()]),e.find(function(e){return 1==e.active})},e.prototype.saveProgress=function(e){var t=this.getItem(this.progressionKey);t||(t=[]);var i=t.find(function(t){return t.playerName==e.playerName});if(i){var r=t.indexOf(i);r!=-1&&t.splice(r,1),t.push(e)}else t.push(e);this.setItem(this.progressionKey,t)},e.prototype.setActive=function(e){for(var t=this.getProgression(),i=0,r=t;i<r.length;i++){var n=r[i];n.playerName==e?n.active=!0:n.active=!1,this.saveProgress(n)}},e.prototype.defaultProgress=function(){var e=new r.Progress;return e.playerName="nouser",e.active=!0,e.completedLevels=0,e.level=1,e.fire=0,e.frost=0,e.defence=0,e.hp=0,e.mana=0,e},e.prototype.getItem=function(e){return JSON.parse(localStorage.getItem(e))},e.prototype.setItem=function(e,t){localStorage.setItem(e,JSON.stringify(t))},e.instance=new e,e}();t.LocalStorageHelper=n},function(e,t,i){"use strict";var r=i(357),n=i(367),s=i(347),a=function(){function e(e,t,i,s,a,o){this.area=e,this.buttonTexture=t,this.hoverTexture=i,this.textTexture=s,this.onClick=a,this.disabledTexture=o,this.disabled=!1,this.renderHelper=r.RenderHelper.getInstance(),this.collisionDetection=n.CollisionDetection.getInstance(),this.hover=!1,this.baseTextureCoords=this.renderHelper.getTextureCoordinates([],t),this.hoverTextureCoords=this.renderHelper.getTextureCoordinates([],i),this.textTextureCoords=this.renderHelper.getTextureCoordinates([],s),null!=o&&(this.disabledTextureCoords=this.renderHelper.getTextureCoordinates([],o))}return e.prototype.click=function(e){this.isWithinArea(e)&&(this.disabled||this.onClick())},e.prototype.mouseOver=function(e){this.isWithinArea(e)?this.hover=!0:this.hover=!1},e.prototype.createRenderCall=function(e){return e.vertecies=this.renderHelper.getVertecies(this.area.x,this.area.y,this.area.width,this.area.height,e.vertecies),e.indecies=this.renderHelper.getIndecies(e.indecies),e.textureCoords.push.apply(e.textureCoords,this.getTexture()),e.vertecies=this.renderHelper.getVertecies(this.area.x,this.area.y,this.area.width,this.area.height,e.vertecies),e.indecies=this.renderHelper.getIndecies(e.indecies),e.textureCoords.push.apply(e.textureCoords,this.textTextureCoords),e},e.prototype.isWithinArea=function(e){return this.collisionDetection.aabbCheck(new s.Rectangle(e[0],e[1],1,1),this.area)},e.prototype.getTexture=function(){return this.disabled&&null!=this.disabledTexture?this.disabledTextureCoords:this.hover?this.hoverTextureCoords:this.baseTextureCoords},e}();t.Clickable=a},function(e,t,i){"use strict";var r=i(357),n=function(){function e(e){this.actives=e,this.renderHelper=r.RenderHelper.getInstance()}return e.prototype.render=function(e){for(var t=0,i=this.actives;t<i.length;t++){var r=i[t];r.createRenderCall(e)}return e},e.prototype.click=function(e){for(var t=0,i=this.actives;t<i.length;t++){i[t];if(!this.actives[0].active){this.actives[0].click(e);break}if(!this.actives[1].active){this.actives[1].click(e);break}if(!this.actives[2].active){this.actives[2].click(e);break}}},e.prototype.getPoints=function(){return this.actives[0].value+this.actives[1].value+this.actives[2].value},e.prototype.fill=function(e){var t=this.actives[0],i=this.actives[1],r=this.actives[2];t.reset(),i.reset(),r.reset();for(var n=0;n<e;n++)t.active?i.active?r.active||r.addPoint():i.addPoint():t.addPoint()},e}();t.PowerSelector=n},function(e,t,i){"use strict";var r=i(357),n=i(367),s=i(347),a=function(){function e(e,t,i,s,a,o,h){this.value=e,this.maxValue=t,this.active=i,this.area=s,this.asset=a,this.activeAsset=o,this.size=h,this.renderHelper=r.RenderHelper.getInstance(),this.collisionDetection=n.CollisionDetection.getInstance()}return e.prototype.createRenderCall=function(e){return e=this.addRenderCall(e,this.asset,!1),e=this.addRenderCall(e,this.activeAsset,!0)},e.prototype.click=function(e){this.isWithinArea(e)&&this.addPoint()},e.prototype.addPoint=function(){this.value++,this.value==this.maxValue&&(this.active=!0)},e.prototype.reset=function(){this.value=0,this.active=!1},e.prototype.addRenderCall=function(e,t,i){var n;if(n=e.has(t)?e.get(t):new r.RenderCall,i){var a=new s.Rectangle(this.area.x,this.area.y,this.area.width,this.area.height*(this.value/this.maxValue));n.textureCoords=this.renderHelper.getTiledTextureCoordinates(a,n.textureCoords,this.size),n.vertecies=this.renderHelper.getVertecies(a.x,a.y,a.width,a.height,n.vertecies)}else n.textureCoords=this.renderHelper.getTiledTextureCoordinates(this.area,n.textureCoords,this.size),n.vertecies=this.renderHelper.getVertecies(this.area.x,this.area.y,this.area.width,this.area.height,n.vertecies);return n.indecies=this.renderHelper.getIndecies(n.indecies),e.set(t,n),e},e.prototype.isWithinArea=function(e){return this.collisionDetection.aabbCheck(new s.Rectangle(e[0],e[1],1,1),this.area)},e}();t.Active=a},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(436),s=i(438),a=i(347),o=i(443),h=function(e){function t(t,i,r,n,a,o,h,c,l,u){e.call(this,c,l,t,i,r,n,a,o,h),this.sceneHandler=t,this.textArea=i,this.renderer=r,this.canvasSize=n,this.background=a,this.tileSize=o,this.menu=h,this.clickables=c,this.text=l,this.powerSelectors=u,this.localStorageHelper=s.LocalStorageHelper.getInstance(),this.load(),this.textArea.style.visibility="hidden"}return r(t,e),t.prototype.render=function(){for(var t=0,i=this.powerSelectors;t<i.length;t++){var r=i[t];this.renderCalls=r.render(this.renderCalls)}for(var n=0,s=this.simpleClickables;n<s.length;n++){var a=s[n];this.renderCalls=a.createRenderCall(this.renderCalls)}e.prototype.render.call(this)},t.prototype.click=function(t){e.prototype.click.call(this,t);for(var i=0,r=this.powerSelectors;i<r.length;i++){var n=r[i];this.getAvailablePoints()>0&&n.click(t)}for(var s=0,a=this.simpleClickables;s<a.length;s++){var o=a[s];this.getAvailablePoints()>0&&o.click(t)}this.progress.fire=this.powerSelectors[0].getPoints(),this.progress.frost=this.powerSelectors[1].getPoints(),this.progress.defence=this.powerSelectors[2].getPoints(),this.textArea.innerHTML="Skillpoints:"+this.getAvailablePoints(),this.localStorageHelper.saveProgress(this.progress)},t.prototype.load=function(){var e=this;this.progress=this.localStorageHelper.getCurrentProgress();var t=function(){e.progress.hp++},i=new o.SimpleClickable(new a.Rectangle(750,100,100,100),120,[100,100],t),r=function(){e.progress.mana++},n=new o.SimpleClickable(new a.Rectangle(950,100,100,100),121,[256,256],r);this.simpleClickables=[i,n],this.powerSelectors[0].fill(this.progress.fire),this.powerSelectors[1].fill(this.progress.frost),this.powerSelectors[2].fill(this.progress.defence),this.textArea.style.visibility="visible",this.textArea.innerHTML="Skillpoints:"+this.getAvailablePoints()},t.prototype.getAvailablePoints=function(){return this.progress.level-(this.progress.fire+this.progress.frost+this.progress.defence+this.progress.hp+this.progress.mana)},t}(n.Menu);t.PowerSelectionMenu=h},function(e,t,i){"use strict";var r=i(347),n=i(357),s=i(367),a=function(){function e(e,t,i,r){this.area=e,this.textureKey=t,this.size=i,this.onClick=r,this.renderHelper=n.RenderHelper.getInstance(),this.collisionDetection=s.CollisionDetection.getInstance()}return e.prototype.click=function(e){this.isWithinArea(e)&&this.onClick()},e.prototype.createRenderCall=function(e){var t;return t=e.has(this.textureKey)?e.get(this.textureKey):new n.RenderCall,t.textureCoords=this.renderHelper.getTiledTextureCoordinates(this.area,t.textureCoords,this.size),t.vertecies=this.renderHelper.getVertecies(this.area.x,this.area.y,this.area.width,this.area.height,t.vertecies),t.indecies=this.renderHelper.getIndecies(t.indecies),e.set(this.textureKey,t),e},e.prototype.isWithinArea=function(e){return this.collisionDetection.aabbCheck(new r.Rectangle(e[0],e[1],1,1),this.area)},e}();t.SimpleClickable=a},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(347),s=i(436),a=i(439),o=i(438),h=function(e){function t(t,i,r,s,h,c,l,u,p,d,g){var f=this;e.call(this,t,i,r,s,h,c,l,u,p),this.clickables=t,this.text=i,this.sceneHandler=r,this.textArea=s,this.renderer=h,this.canvasSize=c,this.background=l,this.tileSize=u,this.menu=p,this.textInput=d,this.playerlist=g,this.text.push(new n.Tile(75,70,200,33,557));var x=function(){var e=f.textInput.value;e.length>0&&(o.LocalStorageHelper.getInstance().newPlayer(e),f.checkProgressionExists(),f.reDrawPlayerList())};t.push(new a.Clickable(new n.Rectangle(150,150,200,33),179,181,555,x))}return r(t,e),t.prototype.load=function(){this.textInput.style.visibility="visible",this.playerlist.style.visibility="visible",this.reDrawPlayerList(),this.checkProgressionExists()},t.prototype.reDrawPlayerList=function(){for(var e=this;this.playerlist.firstChild;)this.playerlist.removeChild(this.playerlist.firstChild);this.playerlist.children;for(var t=o.LocalStorageHelper.getInstance().getProgression(),i=function(t){var i=document.createElement("div");i.style.setProperty("color","#ac9478","important"),i.style.textShadow="-2px 0 #5d392c, 0 2px #5d392c, 2px 0 #5d392c, 0 -2px #5d392c",i.style.padding="5px",i.innerHTML=t.playerName,t.active&&(i.innerHTML=" "+i.innerHTML),i.onclick=function(){o.LocalStorageHelper.getInstance().setActive(t.playerName),e.reDrawPlayerList()},r.playerlist.appendChild(i)},r=this,n=0,s=t;n<s.length;n++){var a=s[n];i(a)}},t.prototype.checkProgressionExists=function(){o.LocalStorageHelper.getInstance().getProgression().length>0?this.clickables[1].disabled=!1:this.clickables[1].disabled=!0},t}(s.Menu);t.NewGameMenu=h},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(347),s=i(436),a=i(439),o=i(2),h=function(e){function t(t,i,r,n,s,a,h,c,l,u){e.call(this,t,i,r,n,s,a,h,c,l),this.clickables=t,this.text=i,this.sceneHandler=r,this.textArea=n,this.renderer=s,this.canvasSize=a,this.background=h,this.tileSize=c,this.menu=l,this.game=u,this.currentLevel=0,this.assetLoader=new o.AssetsLoader,this.load()}return r(t,e),t.prototype.load=function(){this.clickables[1]=new a.Clickable(new n.Rectangle(this.canvasSize[0]/2+200,650,250,42),179,181,558,this.getClickCall())},t.prototype.getClickCall=function(){var e=this;return function(){null!=e.tempLevel?(e.game.loadLevel(e.tempLevel),e.sceneHandler.started=!0):e.assetLoader.getLevel(e.currentLevel.toString()).subscribe(function(t){e.game.loadLevel(t),e.sceneHandler.started=!0})}},t}(s.Menu);t.RestartMenu=h}]);
//# sourceMappingURL=app.15ad03206fd586b79ae8.js.map